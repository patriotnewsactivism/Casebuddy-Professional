{"file_contents":{"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1877,"size_tokens":null},"server/services/briefGenerator.ts":{"content":"import { GoogleGenAI } from \"@google/genai\";\nimport { storage } from \"../storage\";\nimport type { LegalBrief, DiscoveryFile, TimelineEvent } from \"@shared/schema\";\n\nconst ai = new GoogleGenAI({\n  apiKey: process.env.AI_INTEGRATIONS_GEMINI_API_KEY!,\n  httpOptions: {\n    apiVersion: \"\",\n    baseUrl: process.env.AI_INTEGRATIONS_GEMINI_BASE_URL!,\n  },\n});\n\ninterface BriefGenerationRequest {\n  caseId: number;\n  briefType: string;\n  title: string;\n  additionalInstructions?: string;\n}\n\ninterface GeneratedBrief {\n  content: string;\n  summary: string;\n  precedents: Array<{\n    caseName: string;\n    citation: string;\n    relevance: string;\n  }>;\n  keyArguments: string[];\n}\n\nconst BRIEF_TYPES: Record<string, string> = {\n  \"motion_dismiss\": \"Motion to Dismiss\",\n  \"motion_summary\": \"Motion for Summary Judgment\",\n  \"motion_suppress\": \"Motion to Suppress Evidence\",\n  \"response_motion\": \"Response to Motion\",\n  \"trial_brief\": \"Trial Brief\",\n  \"appellate_brief\": \"Appellate Brief\",\n  \"memorandum_law\": \"Memorandum of Law\",\n  \"complaint\": \"Complaint\",\n  \"answer\": \"Answer to Complaint\",\n};\n\nasync function getCaseFacts(caseId: number): Promise<{\n  discoveryFiles: DiscoveryFile[];\n  timelineEvents: TimelineEvent[];\n  caseInfo: any;\n}> {\n  const [discoveryFiles, timelineEvents, caseInfo] = await Promise.all([\n    storage.getDiscoveryFilesByCase(caseId),\n    storage.getTimelineEventsByCase(caseId),\n    storage.getCase(caseId),\n  ]);\n\n  return { discoveryFiles, timelineEvents, caseInfo };\n}\n\nfunction buildContextFromFacts(facts: {\n  discoveryFiles: DiscoveryFile[];\n  timelineEvents: TimelineEvent[];\n  caseInfo: any;\n}): string {\n  const { discoveryFiles, timelineEvents, caseInfo } = facts;\n\n  let context = `CASE INFORMATION:\\n`;\n  if (caseInfo) {\n    context += `Case Title: ${caseInfo.title}\\n`;\n    context += `Case Number: ${caseInfo.caseNumber}\\n`;\n    context += `Client: ${caseInfo.client}\\n`;\n    context += `Description: ${caseInfo.description || \"N/A\"}\\n\\n`;\n  }\n\n  if (timelineEvents.length > 0) {\n    context += `KEY TIMELINE EVENTS:\\n`;\n    timelineEvents.forEach((event) => {\n      context += `- ${new Date(event.eventDate).toLocaleDateString()}: ${event.title}\\n`;\n      if (event.description) context += `  ${event.description}\\n`;\n    });\n    context += \"\\n\";\n  }\n\n  if (discoveryFiles.length > 0) {\n    context += `DISCOVERY DOCUMENTS (${discoveryFiles.length} files):\\n`;\n    discoveryFiles.slice(0, 20).forEach((file) => {\n      context += `- [${file.batesStart}] ${file.fileName}`;\n      if (file.summary) context += `: ${file.summary.substring(0, 200)}...`;\n      context += \"\\n\";\n    });\n    context += \"\\n\";\n  }\n\n  return context;\n}\n\nexport async function generateLegalBrief(\n  request: BriefGenerationRequest\n): Promise<LegalBrief> {\n  const { caseId, briefType, title, additionalInstructions } = request;\n\n  const facts = await getCaseFacts(caseId);\n  const factContext = buildContextFromFacts(facts);\n  const briefTypeName = BRIEF_TYPES[briefType] || briefType;\n\n  const prompt = `You are an expert legal brief writer with extensive experience in litigation. Generate a comprehensive ${briefTypeName} based on the following case information.\n\n${factContext}\n\nBRIEF REQUIREMENTS:\n- Title: ${title}\n- Type: ${briefTypeName}\n${additionalInstructions ? `- Additional Instructions: ${additionalInstructions}` : \"\"}\n\nINSTRUCTIONS:\n1. Generate a professional legal brief that follows standard legal writing conventions\n2. Include proper legal citations and references to relevant case law\n3. Structure the brief with clear sections (Introduction, Statement of Facts, Legal Argument, Conclusion)\n4. Reference specific evidence from the discovery documents using Bates numbers where applicable\n5. Identify and cite relevant legal precedents that support the arguments\n6. Provide compelling legal reasoning\n\nRESPONSE FORMAT:\nProvide your response in the following JSON structure:\n{\n  \"content\": \"The full text of the legal brief with proper formatting and sections\",\n  \"summary\": \"A 2-3 sentence executive summary of the brief's main arguments\",\n  \"precedents\": [\n    {\n      \"caseName\": \"Case name\",\n      \"citation\": \"Citation format\",\n      \"relevance\": \"Brief explanation of relevance\"\n    }\n  ],\n  \"keyArguments\": [\"Main argument 1\", \"Main argument 2\", \"Main argument 3\"]\n}\n\nGenerate the ${briefTypeName} now:`;\n\n  try {\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      contents: [{ role: \"user\", parts: [{ text: prompt }] }],\n    });\n\n    let generatedBrief: GeneratedBrief;\n    \n    try {\n      const responseText = response.text || \"\";\n      const jsonMatch = responseText.match(/\\{[\\s\\S]*\\}/);\n      if (jsonMatch) {\n        generatedBrief = JSON.parse(jsonMatch[0]);\n      } else {\n        throw new Error(\"No JSON found in response\");\n      }\n    } catch (parseError) {\n      generatedBrief = {\n        content: response.text || \"Unable to generate brief content.\",\n        summary: \"Brief generated based on case facts and legal precedents.\",\n        precedents: [],\n        keyArguments: [],\n      };\n    }\n\n    const savedBrief = await storage.createLegalBrief({\n      caseId,\n      title,\n      briefType,\n      content: generatedBrief.content,\n      summary: generatedBrief.summary,\n      precedents: generatedBrief.precedents,\n      keyArguments: generatedBrief.keyArguments,\n      status: \"draft\",\n    });\n\n    return savedBrief;\n  } catch (error) {\n    console.error(\"[BriefGenerator] Error generating brief:\", error);\n    throw new Error(\"Failed to generate legal brief\");\n  }\n}\n\nexport function getBriefTypes(): Record<string, string> {\n  return BRIEF_TYPES;\n}\n","path":null,"size_bytes":5645,"size_tokens":null},"server/services/collaboration.ts":{"content":"import { WebSocketServer, WebSocket } from \"ws\";\nimport type { Server } from \"http\";\nimport { log } from \"../index\";\n\ninterface UserPresence {\n  odId: string;\n  odName: string;\n  odColor: string;\n  caseId: number;\n  joinedAt: Date;\n  lastActivity: Date;\n}\n\ninterface CollaborationMessage {\n  type: \"join\" | \"leave\" | \"presence\" | \"update\" | \"cursor\" | \"ping\" | \"pong\" | \"chat\";\n  caseId?: number;\n  userId?: string;\n  userName?: string;\n  userColor?: string;\n  content?: string;\n  data?: any;\n}\n\nconst COLORS = [\n  \"#ef4444\", \"#f97316\", \"#eab308\", \"#22c55e\", \"#14b8a6\", \n  \"#3b82f6\", \"#8b5cf6\", \"#ec4899\", \"#06b6d4\", \"#84cc16\"\n];\n\nclass CollaborationService {\n  private wss: WebSocketServer | null = null;\n  private clients: Map<WebSocket, UserPresence> = new Map();\n  private casePresence: Map<number, Set<string>> = new Map();\n\n  initialize(server: Server) {\n    this.wss = new WebSocketServer({ \n      server, \n      path: \"/ws/collaboration\" \n    });\n\n    this.wss.on(\"connection\", (ws) => {\n      log(\"WebSocket client connected\", \"collab\");\n\n      ws.on(\"message\", (data) => {\n        try {\n          const message: CollaborationMessage = JSON.parse(data.toString());\n          this.handleMessage(ws, message);\n        } catch (err) {\n          log(`Invalid WebSocket message: ${err}`, \"collab\");\n        }\n      });\n\n      ws.on(\"close\", () => {\n        this.handleDisconnect(ws);\n      });\n\n      ws.on(\"error\", (err) => {\n        log(`WebSocket error: ${err}`, \"collab\");\n        this.handleDisconnect(ws);\n      });\n    });\n\n    log(\"Collaboration WebSocket server initialized\", \"collab\");\n  }\n\n  private handleMessage(ws: WebSocket, message: CollaborationMessage) {\n    switch (message.type) {\n      case \"join\":\n        this.handleJoin(ws, message);\n        break;\n      case \"leave\":\n        this.handleLeave(ws);\n        break;\n      case \"update\":\n        this.broadcastUpdate(ws, message);\n        break;\n      case \"cursor\":\n        this.broadcastCursor(ws, message);\n        break;\n      case \"chat\":\n        this.broadcastChat(ws, message);\n        break;\n      case \"ping\":\n        ws.send(JSON.stringify({ type: \"pong\" }));\n        this.updateActivity(ws);\n        break;\n    }\n  }\n\n  private handleJoin(ws: WebSocket, message: CollaborationMessage) {\n    if (!message.caseId || !message.userId) return;\n\n    const userColor = COLORS[Math.floor(Math.random() * COLORS.length)];\n    const presence: UserPresence = {\n      odId: message.userId,\n      odName: message.userName || `User ${message.userId.slice(0, 4)}`,\n      odColor: message.userColor || userColor,\n      caseId: message.caseId,\n      joinedAt: new Date(),\n      lastActivity: new Date(),\n    };\n\n    this.clients.set(ws, presence);\n\n    if (!this.casePresence.has(message.caseId)) {\n      this.casePresence.set(message.caseId, new Set());\n    }\n    this.casePresence.get(message.caseId)!.add(message.userId);\n\n    log(`User ${presence.odName} joined case ${message.caseId}`, \"collab\");\n\n    this.broadcastPresence(message.caseId);\n  }\n\n  private handleLeave(ws: WebSocket) {\n    this.handleDisconnect(ws);\n  }\n\n  private handleDisconnect(ws: WebSocket) {\n    const presence = this.clients.get(ws);\n    if (presence) {\n      log(`User ${presence.odName} left case ${presence.caseId}`, \"collab\");\n      \n      const caseUsers = this.casePresence.get(presence.caseId);\n      if (caseUsers) {\n        caseUsers.delete(presence.odId);\n        if (caseUsers.size === 0) {\n          this.casePresence.delete(presence.caseId);\n        }\n      }\n\n      this.clients.delete(ws);\n      this.broadcastPresence(presence.caseId);\n    }\n  }\n\n  private updateActivity(ws: WebSocket) {\n    const presence = this.clients.get(ws);\n    if (presence) {\n      presence.lastActivity = new Date();\n    }\n  }\n\n  private broadcastPresence(caseId: number) {\n    const usersInCase: Array<{ id: string; name: string; color: string }> = [];\n    \n    this.clients.forEach((presence) => {\n      if (presence.caseId === caseId) {\n        usersInCase.push({\n          id: presence.odId,\n          name: presence.odName,\n          color: presence.odColor,\n        });\n      }\n    });\n\n    const message = JSON.stringify({\n      type: \"presence\",\n      caseId,\n      users: usersInCase,\n    });\n\n    this.clients.forEach((presence, client) => {\n      if (presence.caseId === caseId && client.readyState === WebSocket.OPEN) {\n        client.send(message);\n      }\n    });\n  }\n\n  private broadcastUpdate(senderWs: WebSocket, message: CollaborationMessage) {\n    const senderPresence = this.clients.get(senderWs);\n    if (!senderPresence) return;\n\n    const updateMessage = JSON.stringify({\n      type: \"update\",\n      caseId: senderPresence.caseId,\n      userId: senderPresence.odId,\n      userName: senderPresence.odName,\n      data: message.data,\n    });\n\n    this.clients.forEach((presence, client) => {\n      if (\n        presence.caseId === senderPresence.caseId && \n        client !== senderWs && \n        client.readyState === WebSocket.OPEN\n      ) {\n        client.send(updateMessage);\n      }\n    });\n  }\n\n  private broadcastCursor(senderWs: WebSocket, message: CollaborationMessage) {\n    const senderPresence = this.clients.get(senderWs);\n    if (!senderPresence) return;\n\n    const cursorMessage = JSON.stringify({\n      type: \"cursor\",\n      userId: senderPresence.odId,\n      userName: senderPresence.odName,\n      userColor: senderPresence.odColor,\n      data: message.data,\n    });\n\n    this.clients.forEach((presence, client) => {\n      if (\n        presence.caseId === senderPresence.caseId && \n        client !== senderWs && \n        client.readyState === WebSocket.OPEN\n      ) {\n        client.send(cursorMessage);\n      }\n    });\n  }\n\n  private broadcastChat(senderWs: WebSocket, message: CollaborationMessage) {\n    const senderPresence = this.clients.get(senderWs);\n    if (!senderPresence || !message.content) return;\n\n    const chatMessage = JSON.stringify({\n      type: \"chat\",\n      caseId: senderPresence.caseId,\n      userId: senderPresence.odId,\n      userName: senderPresence.odName,\n      userColor: senderPresence.odColor,\n      content: message.content,\n    });\n\n    this.clients.forEach((presence, client) => {\n      if (\n        presence.caseId === senderPresence.caseId && \n        client !== senderWs && \n        client.readyState === WebSocket.OPEN\n      ) {\n        client.send(chatMessage);\n      }\n    });\n  }\n\n  getCasePresence(caseId: number): Array<{ id: string; name: string; color: string }> {\n    const users: Array<{ id: string; name: string; color: string }> = [];\n    this.clients.forEach((presence) => {\n      if (presence.caseId === caseId) {\n        users.push({\n          id: presence.odId,\n          name: presence.odName,\n          color: presence.odColor,\n        });\n      }\n    });\n    return users;\n  }\n\n  notifyCaseUpdate(caseId: number, updateType: string, data: any) {\n    const message = JSON.stringify({\n      type: \"update\",\n      caseId,\n      data: { updateType, ...data },\n    });\n\n    this.clients.forEach((presence, client) => {\n      if (presence.caseId === caseId && client.readyState === WebSocket.OPEN) {\n        client.send(message);\n      }\n    });\n  }\n}\n\nexport const collaborationService = new CollaborationService();\n","path":null,"size_bytes":7247,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4419,"size_tokens":null},"client/src/index.css":{"content":"@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@plugin \"tailwindcss-animate\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --font-sans: \"Inter\", sans-serif;\n  --font-serif: \"Merriweather\", serif;\n\n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n  --radius-xl: calc(var(--radius) + 4px);\n  \n  --color-background: hsl(var(--background));\n  --color-foreground: hsl(var(--foreground));\n  \n  --color-card: hsl(var(--card));\n  --color-card-foreground: hsl(var(--card-foreground));\n  \n  --color-popover: hsl(var(--popover));\n  --color-popover-foreground: hsl(var(--popover-foreground));\n  \n  --color-primary: hsl(var(--primary));\n  --color-primary-foreground: hsl(var(--primary-foreground));\n  \n  --color-secondary: hsl(var(--secondary));\n  --color-secondary-foreground: hsl(var(--secondary-foreground));\n  \n  --color-muted: hsl(var(--muted));\n  --color-muted-foreground: hsl(var(--muted-foreground));\n  \n  --color-accent: hsl(var(--accent));\n  --color-accent-foreground: hsl(var(--accent-foreground));\n  \n  --color-destructive: hsl(var(--destructive));\n  --color-destructive-foreground: hsl(var(--destructive-foreground));\n  \n  --color-border: hsl(var(--border));\n  --color-input: hsl(var(--input));\n  --color-ring: hsl(var(--ring));\n  \n  --color-chart-1: hsl(var(--chart-1));\n  --color-chart-2: hsl(var(--chart-2));\n  --color-chart-3: hsl(var(--chart-3));\n  --color-chart-4: hsl(var(--chart-4));\n  --color-chart-5: hsl(var(--chart-5));\n  \n  --color-sidebar: hsl(var(--sidebar));\n  --color-sidebar-foreground: hsl(var(--sidebar-foreground));\n  --color-sidebar-primary: hsl(var(--sidebar-primary));\n  --color-sidebar-primary-foreground: hsl(var(--sidebar-primary-foreground));\n  --color-sidebar-accent: hsl(var(--sidebar-accent));\n  --color-sidebar-accent-foreground: hsl(var(--sidebar-accent-foreground));\n  --color-sidebar-border: hsl(var(--sidebar-border));\n  --color-sidebar-ring: hsl(var(--sidebar-ring));\n  \n  --radius: 0.5rem;\n}\n\n/* Legal Professional Theme - Navy, Gold, Slate */\n:root {\n  /* White background, very dark text */\n  --background: 210 20% 98%;\n  --foreground: 222 47% 11%;\n\n  /* Clean white cards with subtle borders */\n  --card: 0 0% 100%;\n  --card-foreground: 222 47% 11%;\n\n  --popover: 0 0% 100%;\n  --popover-foreground: 222 47% 11%;\n\n  /* Navy Blue Primary */\n  --primary: 222 47% 11%;\n  --primary-foreground: 210 40% 98%;\n\n  /* Slate/Cool Grey Secondary */\n  --secondary: 210 40% 96.1%;\n  --secondary-foreground: 222 47% 11%;\n\n  --muted: 210 40% 96.1%;\n  --muted-foreground: 215.4 16.3% 46.9%;\n\n  /* Gold/Amber Accent for highlights */\n  --accent: 38 92% 50%;\n  --accent-foreground: 222 47% 11%;\n\n  --destructive: 0 84.2% 60.2%;\n  --destructive-foreground: 210 40% 98%;\n\n  --border: 214.3 31.8% 91.4%;\n  --input: 214.3 31.8% 91.4%;\n  --ring: 222 47% 11%;\n\n  --radius: 0.3rem;\n\n  --sidebar: 222 47% 10%; /* Dark Sidebar */\n  --sidebar-foreground: 210 40% 98%;\n  --sidebar-primary: 38 92% 50%; /* Gold active state */\n  --sidebar-primary-foreground: 222 47% 11%;\n  --sidebar-accent: 217 33% 17%;\n  --sidebar-accent-foreground: 210 40% 98%;\n  --sidebar-border: 217 33% 17%;\n  --sidebar-ring: 222 47% 11%;\n\n  /* Chart Colors */\n  --chart-1: 222 47% 11%; /* Navy */\n  --chart-2: 38 92% 50%;  /* Gold */\n  --chart-3: 215 25% 27%; /* Slate Dark */\n  --chart-4: 214 32% 91%; /* Slate Light */\n  --chart-5: 0 84% 60%;   /* Red (Alerts) */\n}\n\n.dark {\n  --background: 222 47% 11%;\n  --foreground: 210 40% 98%;\n\n  --card: 217 33% 17%;\n  --card-foreground: 210 40% 98%;\n\n  --popover: 222 47% 11%;\n  --popover-foreground: 210 40% 98%;\n\n  --primary: 210 40% 98%;\n  --primary-foreground: 222 47.4% 11.2%;\n\n  --secondary: 217.2 32.6% 17.5%;\n  --secondary-foreground: 210 40% 98%;\n\n  --muted: 217.2 32.6% 17.5%;\n  --muted-foreground: 215 20.2% 65.1%;\n\n  --accent: 38 92% 50%;\n  --accent-foreground: 222 47% 11%;\n\n  --destructive: 0 62.8% 30.6%;\n  --destructive-foreground: 210 40% 98%;\n\n  --border: 217.2 32.6% 17.5%;\n  --input: 217.2 32.6% 17.5%;\n  --ring: 212.7 26.8% 83.9%;\n  \n  --sidebar: 222 47% 8%; \n  --sidebar-foreground: 210 40% 98%;\n  --sidebar-primary: 38 92% 50%; \n  --sidebar-primary-foreground: 222 47% 11%;\n  --sidebar-accent: 217 33% 15%;\n  --sidebar-accent-foreground: 210 40% 98%;\n  --sidebar-border: 217 33% 15%;\n  --sidebar-ring: 222 47% 11%;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-serif font-bold tracking-tight text-primary;\n  }\n}\n","path":null,"size_bytes":4571,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":768,"size_tokens":null},"server/replit_integrations/batch/utils.ts":{"content":"import pLimit from \"p-limit\";\nimport pRetry from \"p-retry\";\n\n/**\n * Batch Processing Utilities for Gemini\n *\n * Supported models: gemini-2.5-flash (fast), gemini-2.5-pro (advanced reasoning), gemini-2.5-flash-image (image generation)\n *\n * USAGE:\n * ```typescript\n * import { batchProcess } from \"./replit_integrations/batch\";\n * import { GoogleGenAI } from \"@google/genai\";\n *\n * const ai = new GoogleGenAI({\n *   apiKey: process.env.AI_INTEGRATIONS_GEMINI_API_KEY,\n *   httpOptions: {\n *     apiVersion: \"\",\n *     baseUrl: process.env.AI_INTEGRATIONS_GEMINI_BASE_URL,\n *   },\n * });\n *\n * const results = await batchProcess(\n *   items,\n *   async (item) => {\n *     const response = await ai.models.generateContent({\n *       model: \"gemini-2.5-flash\",\n *       contents: `Process: ${item.name}`,\n *     });\n *     return response.text || \"\";\n *   }\n * );\n * ```\n */\n\nexport interface BatchOptions {\n  /** Max concurrent requests (default: 2) */\n  concurrency?: number;\n  /** Max retry attempts for rate limit errors (default: 7) */\n  retries?: number;\n  /** Initial retry delay in ms (default: 2000) */\n  minTimeout?: number;\n  /** Max retry delay in ms (default: 128000) */\n  maxTimeout?: number;\n  /** Callback for progress updates */\n  onProgress?: (completed: number, total: number, item: unknown) => void;\n}\n\n/**\n * Check if an error is a rate limit or quota violation.\n */\nexport function isRateLimitError(error: unknown): boolean {\n  const errorMsg = error instanceof Error ? error.message : String(error);\n  return (\n    errorMsg.includes(\"429\") ||\n    errorMsg.includes(\"RATELIMIT_EXCEEDED\") ||\n    errorMsg.toLowerCase().includes(\"quota\") ||\n    errorMsg.toLowerCase().includes(\"rate limit\")\n  );\n}\n\n/**\n * Process items in batches with rate limiting and automatic retries.\n *\n * @param items - Array of items to process\n * @param processor - Async function to process each item (write your LLM logic here)\n * @param options - Concurrency and retry settings\n * @returns Promise resolving to array of results in the same order as input\n */\nexport async function batchProcess<T, R>(\n  items: T[],\n  processor: (item: T, index: number) => Promise<R>,\n  options: BatchOptions = {}\n): Promise<R[]> {\n  const {\n    concurrency = 2,\n    retries = 7,\n    minTimeout = 2000,\n    maxTimeout = 128000,\n    onProgress,\n  } = options;\n\n  const limit = pLimit(concurrency);\n  let completed = 0;\n\n  const promises = items.map((item, index) =>\n    limit(() =>\n      pRetry(\n        async () => {\n          try {\n            const result = await processor(item, index);\n            completed++;\n            onProgress?.(completed, items.length, item);\n            return result;\n          } catch (error: unknown) {\n            if (isRateLimitError(error)) {\n              throw error;\n            }\n            const err = error instanceof Error ? error : new Error(String(error));\n            err.name = 'AbortError';\n            throw err;\n          }\n        },\n        { retries, minTimeout, maxTimeout, factor: 2 }\n      )\n    )\n  );\n\n  return Promise.all(promises);\n}\n\n/**\n * Process items sequentially with SSE progress streaming.\n */\nexport async function batchProcessWithSSE<T, R>(\n  items: T[],\n  processor: (item: T, index: number) => Promise<R>,\n  sendEvent: (event: { type: string; [key: string]: unknown }) => void,\n  options: Omit<BatchOptions, \"concurrency\" | \"onProgress\"> = {}\n): Promise<R[]> {\n  const { retries = 5, minTimeout = 1000, maxTimeout = 15000 } = options;\n\n  sendEvent({ type: \"started\", total: items.length });\n\n  const results: R[] = [];\n  let errors = 0;\n\n  for (let index = 0; index < items.length; index++) {\n    const item = items[index];\n    sendEvent({ type: \"processing\", index, item });\n\n    try {\n      const result = await pRetry(() => processor(item, index), {\n        retries,\n        minTimeout,\n        maxTimeout,\n        factor: 2,\n        onFailedAttempt: (error) => {\n          if (!isRateLimitError(error)) {\n            const err = error instanceof Error ? error : new Error(String(error));\n            err.name = 'AbortError';\n            throw err;\n          }\n        },\n      });\n      results.push(result);\n      sendEvent({ type: \"progress\", index, result });\n    } catch (error) {\n      errors++;\n      results.push(undefined as R);\n      sendEvent({\n        type: \"progress\",\n        index,\n        error: error instanceof Error ? error.message : \"Processing failed\",\n      });\n    }\n  }\n\n  sendEvent({ type: \"complete\", processed: items.length, errors });\n  return results;\n}\n","path":null,"size_bytes":4537,"size_tokens":null},"server/replit_integrations/image/client.ts":{"content":"import { GoogleGenAI, Modality } from \"@google/genai\";\n\n// This is using Replit's AI Integrations service, which provides Gemini-compatible API access without requiring your own Gemini API key.\nexport const ai = new GoogleGenAI({\n  apiKey: process.env.AI_INTEGRATIONS_GEMINI_API_KEY,\n  httpOptions: {\n    apiVersion: \"\",\n    baseUrl: process.env.AI_INTEGRATIONS_GEMINI_BASE_URL,\n  },\n});\n\n/**\n * Generate an image and return as base64 data URL.\n * Uses gemini-2.5-flash-image model via Replit AI Integrations.\n */\nexport async function generateImage(prompt: string): Promise<string> {\n  const response = await ai.models.generateContent({\n    model: \"gemini-2.5-flash-image\",\n    contents: [{ role: \"user\", parts: [{ text: prompt }] }],\n    config: {\n      responseModalities: [Modality.TEXT, Modality.IMAGE],\n    },\n  });\n\n  const candidate = response.candidates?.[0];\n  const imagePart = candidate?.content?.parts?.find(\n    (part: { inlineData?: { data?: string; mimeType?: string } }) => part.inlineData\n  );\n\n  if (!imagePart?.inlineData?.data) {\n    throw new Error(\"No image data in response\");\n  }\n\n  const mimeType = imagePart.inlineData.mimeType || \"image/png\";\n  return `data:${mimeType};base64,${imagePart.inlineData.data}`;\n}\n\n","path":null,"size_bytes":1239,"size_tokens":null},"client/src/components/ui/sonner.tsx":{"content":"\"use client\"\n\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n","path":null,"size_bytes":894,"size_tokens":null},"client/src/pages/case-view.tsx":{"content":"import { Layout } from \"@/components/layout\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { getCase, getDiscoveryFiles, getTimeline, uploadDiscoveryFile, generateDepositionQuestions, getDriveFolders, getCloudFolders, linkCloudFolder, syncCloudFolder, getLegalBriefs, getBriefTypes, generateLegalBrief, deleteLegalBrief, exportCaseData, deleteCase, type DriveFolder, type LegalBrief } from \"@/lib/api\";\nimport type { DiscoveryFile, CloudFolder } from \"@shared/schema\";\nimport { \n  Search, \n  Filter, \n  Plus, \n  FileText, \n  Video, \n  Mic, \n  Image as ImageIcon, \n  MoreVertical, \n  Download,\n  Eye,\n  Gavel,\n  BrainCircuit,\n  CalendarCheck,\n  ChevronRight,\n  UploadCloud,\n  Loader2,\n  Cloud,\n  FolderOpen,\n  RefreshCw,\n  ExternalLink,\n  FileEdit,\n  Trash2,\n  BookOpen,\n  Phone,\n  MessageCircle\n} from \"lucide-react\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { useState, useEffect } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useSaveStatus } from \"@/hooks/use-save-status\";\nimport { FeaturedNews } from \"@/components/featured-news\";\nimport { useCollaboration } from \"@/hooks/use-collaboration\";\nimport { PresenceIndicator } from \"@/components/presence-indicator\";\nimport { VideoCallPanel } from \"@/components/video-call-panel\";\nimport { CollaborationChat } from \"@/components/collaboration-chat\";\nimport { AIChat } from \"@/components/ai-chat\";\n\nexport default function CaseView() {\n  const [match, params] = useRoute(\"/case/:id\");\n  const caseId = params?.id;\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  const { data: currentCase, isLoading: caseLoading } = useQuery({\n    queryKey: [\"case\", caseId],\n    queryFn: () => getCase(caseId!),\n    enabled: !!caseId,\n  });\n\n  const { collaborators, isConnected, userId, userName } = useCollaboration(caseId ? parseInt(caseId) : null);\n  const [showVideoCall, setShowVideoCall] = useState(false);\n  const [showChat, setShowChat] = useState(false);\n  const [isExporting, setIsExporting] = useState(false);\n\n  const handleExport = async () => {\n    if (!caseId) return;\n    setIsExporting(true);\n    try {\n      const blob = await exportCaseData(caseId);\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `${currentCase?.caseNumber || \"case\"}-export.json`;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n      toast({ title: \"Case exported successfully\" });\n    } catch (error) {\n      toast({ title: \"Failed to export case\", variant: \"destructive\" });\n    } finally {\n      setIsExporting(false);\n    }\n  };\n\n  const deleteMutation = useMutation({\n    mutationFn: () => deleteCase(caseId!),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"cases\"] });\n      toast({ title: \"Case deleted successfully\" });\n      navigate(\"/\");\n    },\n    onError: () => {\n      toast({ title: \"Failed to delete case\", variant: \"destructive\" });\n    },\n  });\n\n  if (caseLoading) {\n    return (\n      <Layout>\n        <div className=\"flex items-center justify-center h-full\">\n          <div className=\"text-center\">\n            <p className=\"text-muted-foreground\">Loading case...</p>\n          </div>\n        </div>\n      </Layout>\n    );\n  }\n\n  if (!currentCase) {\n    return (\n      <Layout>\n        <div className=\"flex items-center justify-center h-full\">\n          <div className=\"text-center\">\n            <h1 className=\"text-2xl font-bold text-primary\">Case Not Found</h1>\n            <p className=\"text-muted-foreground\">The case ID {caseId} does not exist.</p>\n          </div>\n        </div>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      <div className=\"min-h-[calc(100vh-8rem)] md:h-[calc(100vh-8rem)] flex flex-col\">\n        {/* Case Header */}\n        <div className=\"flex flex-col sm:flex-row justify-between items-start gap-4 mb-4 md:mb-6\">\n          <div className=\"w-full sm:flex-1\">\n            <div className=\"flex flex-wrap items-center gap-2 mb-2\">\n              <Badge variant=\"outline\" className=\"font-mono text-xs border-primary/20 text-primary bg-primary/5\">{currentCase.caseNumber}</Badge>\n              <Badge className={currentCase.status === 'active' ? \"bg-green-600\" : \"bg-slate-500\"}>{currentCase.status}</Badge>\n              <div className=\"hidden sm:block ml-2\">\n                <PresenceIndicator collaborators={collaborators} isConnected={isConnected} />\n              </div>\n            </div>\n            <h1 className=\"text-xl sm:text-2xl md:text-3xl font-serif font-bold text-primary\">{currentCase.title}</h1>\n            <p className=\"text-sm md:text-base text-muted-foreground max-w-2xl mt-1 line-clamp-2 sm:line-clamp-none\">{currentCase.description || \"No description available\"}</p>\n          </div>\n          <div className=\"flex flex-col sm:flex-row items-end sm:items-center gap-2 w-full sm:w-auto\">\n            <div className=\"sm:hidden\">\n              <PresenceIndicator collaborators={collaborators} isConnected={isConnected} />\n            </div>\n            <div className=\"flex gap-2 w-full sm:w-auto\">\n              <Button \n                variant={showChat ? \"default\" : \"outline\"} \n                size=\"sm\" \n                className=\"flex-1 sm:flex-initial\"\n                onClick={() => setShowChat(!showChat)}\n                data-testid=\"button-chat\"\n              >\n                <MessageCircle className=\"w-4 h-4 sm:mr-2\" /> \n                <span className=\"hidden sm:inline\">Chat</span>\n              </Button>\n              <Button \n                variant={showVideoCall ? \"default\" : \"outline\"} \n                size=\"sm\" \n                className=\"flex-1 sm:flex-initial\"\n                onClick={() => setShowVideoCall(!showVideoCall)}\n                data-testid=\"button-video-call\"\n              >\n                <Phone className=\"w-4 h-4 sm:mr-2\" /> \n                <span className=\"hidden sm:inline\">Video Call</span>\n              </Button>\n              <IngestModal />\n              <Button \n                variant=\"outline\" \n                size=\"sm\" \n                className=\"flex-1 sm:flex-initial\"\n                onClick={handleExport}\n                disabled={isExporting}\n                data-testid=\"button-export-case\"\n              >\n                {isExporting ? (\n                  <Loader2 className=\"w-4 h-4 animate-spin sm:mr-2\" />\n                ) : (\n                  <Download className=\"w-4 h-4 sm:mr-2\" />\n                )}\n                <span className=\"hidden sm:inline\">Export</span>\n              </Button>\n              <AlertDialog>\n                <AlertDialogTrigger asChild>\n                  <Button variant=\"outline\" size=\"sm\" className=\"text-destructive hover:text-destructive\" data-testid=\"button-delete-case\">\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </AlertDialogTrigger>\n                <AlertDialogContent>\n                  <AlertDialogHeader>\n                    <AlertDialogTitle>Delete Case</AlertDialogTitle>\n                    <AlertDialogDescription>\n                      Are you sure you want to delete \"{currentCase.title}\"? This action cannot be undone and will permanently delete all case data, documents, and notes.\n                    </AlertDialogDescription>\n                  </AlertDialogHeader>\n                  <AlertDialogFooter>\n                    <AlertDialogCancel>Cancel</AlertDialogCancel>\n                    <AlertDialogAction\n                      onClick={() => deleteMutation.mutate()}\n                      className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                    >\n                      {deleteMutation.isPending ? (\n                        <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />\n                      ) : null}\n                      Delete Case\n                    </AlertDialogAction>\n                  </AlertDialogFooter>\n                </AlertDialogContent>\n              </AlertDialog>\n            </div>\n          </div>\n        </div>\n\n        {/* Main Content Tabs */}\n        <Tabs defaultValue=\"discovery\" className=\"flex-1 flex flex-col min-h-0\">\n          <div className=\"overflow-x-auto -mx-4 px-4 md:mx-0 md:px-0\">\n            <TabsList className=\"w-max md:w-full justify-start border-b rounded-none h-11 md:h-12 bg-transparent p-0 space-x-1 md:space-x-4\">\n              <TabsTrigger value=\"discovery\" className=\"rounded-none border-b-2 border-transparent data-[state=active]:border-accent data-[state=active]:text-primary data-[state=active]:bg-transparent px-2 md:px-4 py-2 md:py-3 font-medium text-xs md:text-sm whitespace-nowrap\">\n                <Search className=\"w-4 h-4 md:mr-2\" /> <span className=\"hidden md:inline\">Discovery</span>\n              </TabsTrigger>\n              <TabsTrigger value=\"timeline\" className=\"rounded-none border-b-2 border-transparent data-[state=active]:border-accent data-[state=active]:text-primary data-[state=active]:bg-transparent px-2 md:px-4 py-2 md:py-3 font-medium text-xs md:text-sm whitespace-nowrap\">\n                <CalendarCheck className=\"w-4 h-4 md:mr-2\" /> <span className=\"hidden md:inline\">Timeline</span>\n              </TabsTrigger>\n              <TabsTrigger value=\"prep\" className=\"rounded-none border-b-2 border-transparent data-[state=active]:border-accent data-[state=active]:text-primary data-[state=active]:bg-transparent px-2 md:px-4 py-2 md:py-3 font-medium text-xs md:text-sm whitespace-nowrap\">\n                <Gavel className=\"w-4 h-4 md:mr-2\" /> <span className=\"hidden md:inline\">Trial Prep</span>\n              </TabsTrigger>\n              <TabsTrigger value=\"briefs\" className=\"rounded-none border-b-2 border-transparent data-[state=active]:border-accent data-[state=active]:text-primary data-[state=active]:bg-transparent px-2 md:px-4 py-2 md:py-3 font-medium text-xs md:text-sm whitespace-nowrap\">\n                <FileEdit className=\"w-4 h-4 md:mr-2\" /> <span className=\"hidden md:inline\">Briefs</span>\n              </TabsTrigger>\n              <TabsTrigger value=\"ai\" className=\"rounded-none border-b-2 border-transparent data-[state=active]:border-accent data-[state=active]:text-primary data-[state=active]:bg-transparent px-2 md:px-4 py-2 md:py-3 font-medium text-xs md:text-sm whitespace-nowrap bg-gradient-to-r from-accent/10 to-transparent\">\n                <BrainCircuit className=\"w-4 h-4 md:mr-2 text-accent\" /> <span className=\"hidden md:inline\">AI</span>\n              </TabsTrigger>\n            </TabsList>\n          </div>\n\n          <div className=\"flex-1 bg-card border rounded-b-lg shadow-sm mt-2 md:mt-4 overflow-hidden\">\n            <TabsContent value=\"discovery\" className=\"h-full m-0 p-0 flex flex-col\">\n              <DiscoveryView />\n            </TabsContent>\n            <TabsContent value=\"timeline\" className=\"h-full m-0 p-3 md:p-6 overflow-auto\">\n              <TimelineView />\n            </TabsContent>\n            <TabsContent value=\"prep\" className=\"h-full m-0 p-0\">\n              <TrialPrepView />\n            </TabsContent>\n            <TabsContent value=\"briefs\" className=\"h-full m-0 p-3 md:p-6 overflow-auto\">\n              <LegalBriefsView caseId={caseId!} />\n            </TabsContent>\n            <TabsContent value=\"ai\" className=\"h-full m-0 p-0\">\n              <div className=\"h-full min-h-[400px]\">\n                <AIChat caseId={parseInt(caseId!)} caseName={currentCase.title} />\n              </div>\n            </TabsContent>\n          </div>\n        </Tabs>\n      </div>\n\n      {showVideoCall && (\n        <VideoCallPanel\n          caseId={parseInt(caseId!)}\n          caseName={currentCase.title}\n          userId={userId}\n          userName={userName}\n          onClose={() => setShowVideoCall(false)}\n        />\n      )}\n\n      {showChat && (\n        <CollaborationChat\n          caseId={parseInt(caseId!)}\n          userId={userId}\n          userName={userName}\n          onClose={() => setShowChat(false)}\n        />\n      )}\n    </Layout>\n  );\n}\n\n// --- Sub-Components ---\n\nfunction IngestModal() {\n  const [ingesting, setIngesting] = useState(false);\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [mode, setMode] = useState<\"upload\" | \"cloud\">(\"upload\");\n  const { toast } = useToast();\n  const { setSaving, setSaved, setError } = useSaveStatus();\n  const queryClient = useQueryClient();\n  const [match, params] = useRoute(\"/case/:id\");\n  const caseId = params?.id;\n\n  const uploadMutation = useMutation({\n    mutationFn: (file: File) => uploadDiscoveryFile(caseId!, file),\n    onMutate: () => {\n      setSaving();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"discoveryFiles\", caseId] });\n      setSaved();\n      toast({\n        title: \"Document Saved\",\n        description: \"File processed and saved to your case.\",\n      });\n      setIngesting(false);\n      setSelectedFile(null);\n    },\n    onError: () => {\n      setError();\n      toast({\n        title: \"Upload Failed\",\n        description: \"There was an error processing the file.\",\n        variant: \"destructive\",\n      });\n      setIngesting(false);\n    },\n  });\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      setSelectedFile(file);\n    }\n  };\n\n  const handleIngest = () => {\n    if (selectedFile) {\n      setIngesting(true);\n      uploadMutation.mutate(selectedFile);\n    }\n  };\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>\n        <Button size=\"sm\" className=\"bg-accent text-accent-foreground hover:bg-accent/90 flex-1 sm:flex-initial\">\n          <Plus className=\"w-4 h-4 sm:mr-2\" /> <span className=\"hidden sm:inline\">Add Evidence</span>\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-[95vw] sm:max-w-[700px] max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"font-serif text-xl sm:text-2xl\">Add Discovery Material</DialogTitle>\n          <DialogDescription className=\"text-sm\">\n            Upload files directly or connect a cloud folder for automatic syncing.\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"flex gap-2 sm:gap-4 mb-4\">\n          <Button\n            variant={mode === \"upload\" ? \"default\" : \"outline\"}\n            onClick={() => setMode(\"upload\")}\n            className=\"flex-1 text-sm\"\n            size=\"sm\"\n            data-testid=\"button-upload-mode\"\n          >\n            <UploadCloud className=\"w-4 h-4 mr-1 sm:mr-2\" /> <span className=\"hidden sm:inline\">Upload</span> Files\n          </Button>\n          <Button\n            variant={mode === \"cloud\" ? \"default\" : \"outline\"}\n            onClick={() => setMode(\"cloud\")}\n            className=\"flex-1 text-sm\"\n            size=\"sm\"\n            data-testid=\"button-cloud-mode\"\n          >\n            <Cloud className=\"w-4 h-4 mr-1 sm:mr-2\" /> <span className=\"hidden sm:inline\">Google</span> Drive\n          </Button>\n        </div>\n\n        {mode === \"upload\" ? (\n          <div className=\"border-2 border-dashed border-muted-foreground/25 rounded-xl h-48 sm:h-64 flex flex-col items-center justify-center bg-secondary/20 hover:bg-secondary/40 transition-colors p-4\">\n            <input\n              type=\"file\"\n              id=\"file-upload\"\n              className=\"hidden\"\n              onChange={handleFileSelect}\n              accept=\".pdf,.mp4,.mp3,.jpg,.jpeg,.png,.xml,.eml,.msg\"\n              data-testid=\"input-file-upload\"\n            />\n            {ingesting ? (\n              <div className=\"text-center space-y-4\">\n                <Loader2 className=\"w-8 sm:w-10 h-8 sm:h-10 animate-spin text-accent mx-auto\" />\n                <div>\n                  <p className=\"font-medium text-sm sm:text-base text-primary\">Processing with Gemini AI...</p>\n                  <p className=\"text-xs text-muted-foreground\">Analyzing  Extracting text  Transcribing</p>\n                </div>\n              </div>\n            ) : (\n              <>\n                <label htmlFor=\"file-upload\" className=\"cursor-pointer flex flex-col items-center text-center\">\n                  <div className=\"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-primary/5 flex items-center justify-center mb-3 sm:mb-4\">\n                    <UploadCloud className=\"w-6 h-6 sm:w-8 sm:h-8 text-primary\" />\n                  </div>\n                  <p className=\"font-medium text-base sm:text-lg truncate max-w-full px-2\">{selectedFile ? selectedFile.name : \"Tap to select file\"}</p>\n                  <p className=\"text-xs sm:text-sm text-muted-foreground mt-2\">Supports .mp4, .mp3, .pdf, .jpg, .xml</p>\n                </label>\n                {selectedFile && (\n                  <button\n                    onClick={handleIngest}\n                    className=\"mt-3 sm:mt-4 px-4 sm:px-6 py-2 bg-accent text-accent-foreground rounded-lg font-medium hover:bg-accent/90 text-sm\"\n                    data-testid=\"button-upload-process\"\n                  >\n                    Upload & Process\n                  </button>\n                )}\n              </>\n            )}\n          </div>\n        ) : (\n          <CloudFolderBrowser caseId={caseId!} />\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction CloudFolderBrowser({ caseId }: { caseId: string }) {\n  const [folderPath, setFolderPath] = useState<{ id: string; name: string }[]>([]);\n  const [selectedFolder, setSelectedFolder] = useState<DriveFolder | null>(null);\n  const [batesPrefix, setBatesPrefix] = useState(\"\");\n  const { toast } = useToast();\n  const { setSaving, setSaved, setError } = useSaveStatus();\n  const queryClient = useQueryClient();\n\n  const currentFolderId = folderPath.length > 0 ? folderPath[folderPath.length - 1].id : undefined;\n\n  const { data: folders = [], isLoading, error } = useQuery({\n    queryKey: [\"driveFolders\", currentFolderId],\n    queryFn: () => getDriveFolders(currentFolderId),\n  });\n\n  const { data: linkedFolders = [] } = useQuery({\n    queryKey: [\"cloudFolders\", caseId],\n    queryFn: () => getCloudFolders(caseId),\n    enabled: !!caseId,\n  });\n\n  const linkMutation = useMutation({\n    mutationFn: ({ folderId, folderName, batesPrefix }: { folderId: string; folderName: string; batesPrefix: string }) => \n      linkCloudFolder(caseId, folderId, folderName, batesPrefix),\n    onMutate: () => {\n      setSaving();\n    },\n    onSuccess: (folder) => {\n      queryClient.invalidateQueries({ queryKey: [\"cloudFolders\", caseId] });\n      toast({\n        title: \"Folder Linked\",\n        description: `Now syncing ${folder.folderName}...`,\n      });\n      syncMutation.mutate(folder.id);\n    },\n    onError: () => {\n      setError();\n      toast({\n        title: \"Failed to Link Folder\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const syncMutation = useMutation({\n    mutationFn: (folderId: number) => syncCloudFolder(folderId),\n    onMutate: () => {\n      setSaving();\n    },\n    onSuccess: (result) => {\n      queryClient.invalidateQueries({ queryKey: [\"discoveryFiles\", caseId] });\n      setSaved();\n      toast({\n        title: \"Documents Saved\",\n        description: `${result.files.length} files synced and saved to your case.`,\n      });\n      setSelectedFolder(null);\n      setBatesPrefix(\"\");\n    },\n    onError: () => {\n      setError();\n      toast({\n        title: \"Sync Failed\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const navigateToFolder = (folder: DriveFolder) => {\n    setFolderPath([...folderPath, { id: folder.id, name: folder.name }]);\n    setSelectedFolder(null);\n  };\n\n  const navigateBack = (index: number) => {\n    setFolderPath(folderPath.slice(0, index));\n    setSelectedFolder(null);\n  };\n\n  const handleLink = () => {\n    if (selectedFolder && batesPrefix) {\n      linkMutation.mutate({\n        folderId: selectedFolder.id,\n        folderName: selectedFolder.name,\n        batesPrefix: batesPrefix.toUpperCase(),\n      });\n    }\n  };\n\n  if (error) {\n    return (\n      <div className=\"border rounded-lg p-8 text-center bg-muted/20\">\n        <Cloud className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n        <p className=\"text-muted-foreground mb-2\">Google Drive not connected</p>\n        <p className=\"text-sm text-muted-foreground\">Please connect your Google Drive account to browse folders.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center gap-2 text-sm\">\n        <button\n          onClick={() => setFolderPath([])}\n          className=\"text-primary hover:underline\"\n          data-testid=\"button-drive-root\"\n        >\n          My Drive\n        </button>\n        {folderPath.map((folder, i) => (\n          <span key={folder.id} className=\"flex items-center gap-2\">\n            <ChevronRight className=\"w-4 h-4 text-muted-foreground\" />\n            <button\n              onClick={() => navigateBack(i + 1)}\n              className=\"text-primary hover:underline\"\n            >\n              {folder.name}\n            </button>\n          </span>\n        ))}\n      </div>\n\n      <div className=\"border rounded-lg h-48 overflow-auto bg-background\">\n        {isLoading ? (\n          <div className=\"flex items-center justify-center h-full\">\n            <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n          </div>\n        ) : folders.length === 0 ? (\n          <div className=\"flex items-center justify-center h-full text-muted-foreground\">\n            No folders found\n          </div>\n        ) : (\n          <div className=\"divide-y\">\n            {folders.map((folder) => (\n              <div\n                key={folder.id}\n                className={`flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-muted/50 transition-colors ${\n                  selectedFolder?.id === folder.id ? \"bg-accent/10 border-l-2 border-accent\" : \"\"\n                }`}\n                onClick={() => setSelectedFolder(folder)}\n                onDoubleClick={() => navigateToFolder(folder)}\n                data-testid={`folder-item-${folder.id}`}\n              >\n                <FolderOpen className=\"w-5 h-5 text-yellow-500\" />\n                <span className=\"flex-1 font-medium\">{folder.name}</span>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    navigateToFolder(folder);\n                  }}\n                >\n                  <ChevronRight className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {selectedFolder && (\n        <div className=\"space-y-3 p-4 bg-accent/5 rounded-lg border border-accent/20\">\n          <p className=\"font-medium\">\n            Selected: <span className=\"text-accent\">{selectedFolder.name}</span>\n          </p>\n          <div>\n            <label className=\"text-sm font-medium block mb-1\">Bates Prefix</label>\n            <Input\n              placeholder=\"e.g., DEF or SMITH\"\n              value={batesPrefix}\n              onChange={(e) => setBatesPrefix(e.target.value)}\n              className=\"max-w-xs\"\n              data-testid=\"input-bates-prefix\"\n            />\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Files will be numbered as {batesPrefix || \"XXX\"}-00001, {batesPrefix || \"XXX\"}-00002, etc.\n            </p>\n          </div>\n          <Button\n            onClick={handleLink}\n            disabled={!batesPrefix || linkMutation.isPending || syncMutation.isPending}\n            className=\"bg-accent\"\n            data-testid=\"button-link-folder\"\n          >\n            {linkMutation.isPending || syncMutation.isPending ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Syncing...\n              </>\n            ) : (\n              <>\n                <Cloud className=\"w-4 h-4 mr-2\" />\n                Link & Sync Folder\n              </>\n            )}\n          </Button>\n        </div>\n      )}\n\n      {linkedFolders.length > 0 && (\n        <div className=\"space-y-2\">\n          <p className=\"text-sm font-medium text-muted-foreground\">Linked Folders</p>\n          {linkedFolders.map((folder) => (\n            <div\n              key={folder.id}\n              className=\"flex items-center justify-between px-3 py-2 bg-muted/50 rounded-lg\"\n              data-testid={`linked-folder-${folder.id}`}\n            >\n              <div className=\"flex items-center gap-2\">\n                <Cloud className=\"w-4 h-4 text-blue-500\" />\n                <span className=\"font-medium\">{folder.folderName}</span>\n                <Badge variant=\"outline\" className=\"text-xs\">{folder.batesPrefix}</Badge>\n              </div>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => syncMutation.mutate(folder.id)}\n                disabled={syncMutation.isPending}\n                data-testid={`button-sync-${folder.id}`}\n              >\n                <RefreshCw className={`w-4 h-4 ${syncMutation.isPending ? \"animate-spin\" : \"\"}`} />\n              </Button>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction DiscoveryView() {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [match, params] = useRoute(\"/case/:id\");\n  const caseId = params?.id;\n  \n  const { data: files = [], isLoading } = useQuery({\n    queryKey: [\"discoveryFiles\", caseId],\n    queryFn: () => getDiscoveryFiles(caseId!),\n    enabled: !!caseId,\n  });\n  \n  const getIcon = (fileType: string) => {\n    if (fileType === 'application/pdf' || fileType === 'pdf') return <FileText className=\"w-5 h-5 text-red-500\" />;\n    if (fileType.startsWith('video/') || fileType === 'video') return <Video className=\"w-5 h-5 text-blue-500\" />;\n    if (fileType.startsWith('audio/') || fileType === 'audio') return <Mic className=\"w-5 h-5 text-purple-500\" />;\n    if (fileType.startsWith('image/') || fileType === 'image') return <ImageIcon className=\"w-5 h-5 text-green-500\" />;\n    if (fileType.includes('xml') || fileType === 'xml') return <FileText className=\"w-5 h-5 text-orange-500\" />;\n    return <FileText className=\"w-5 h-5 text-gray-500\" />;\n  };\n\n  const filteredFiles = files.filter(file => \n    searchTerm === \"\" ||\n    file.batesStart.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    file.fileName.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    file.summary?.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      {/* Toolbar */}\n      <div className=\"p-3 md:p-4 border-b flex gap-2 md:gap-4 bg-muted/30\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n          <Input \n            placeholder=\"Search Bates, files...\" \n            className=\"pl-10 bg-background text-sm\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            data-testid=\"input-search-discovery\"\n          />\n        </div>\n        <Button variant=\"outline\" size=\"sm\" className=\"gap-1 md:gap-2\" data-testid=\"button-filters\">\n          <Filter className=\"w-4 h-4\" /> <span className=\"hidden sm:inline\">Filters</span>\n        </Button>\n      </div>\n\n      {/* Desktop Table Header */}\n      <div className=\"hidden md:grid grid-cols-12 gap-4 px-6 py-3 border-b bg-muted/50 text-xs font-semibold text-muted-foreground uppercase tracking-wider\">\n        <div className=\"col-span-1\">Type</div>\n        <div className=\"col-span-2\">Bates Number</div>\n        <div className=\"col-span-4\">File Name / Summary</div>\n        <div className=\"col-span-2\">Source</div>\n        <div className=\"col-span-2\">Tags</div>\n        <div className=\"col-span-1 text-right\">Actions</div>\n      </div>\n\n      {/* List */}\n      <ScrollArea className=\"flex-1\">\n        {isLoading && <div className=\"p-6 text-center text-muted-foreground\">Loading discovery files...</div>}\n        {!isLoading && filteredFiles.length === 0 && (\n          <div className=\"p-6 text-center text-muted-foreground\">\n            {searchTerm ? \"No files match your search\" : \"No discovery files yet. Add evidence to get started.\"}\n          </div>\n        )}\n        \n        {/* Mobile Card View */}\n        <div className=\"md:hidden divide-y\">\n          {filteredFiles.map((file) => (\n            <div \n              key={file.id} \n              className=\"p-3 hover:bg-muted/30 transition-colors\"\n              data-testid={`discovery-file-${file.id}`}\n            >\n              <div className=\"flex items-start gap-3\">\n                <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-background border shadow-sm shrink-0\">\n                  {getIcon(file.fileType)}\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center gap-2 mb-1\">\n                    {file.driveUrl ? (\n                      <a \n                        href={file.driveUrl} \n                        target=\"_blank\" \n                        rel=\"noopener noreferrer\"\n                        className=\"font-mono text-xs text-accent font-medium hover:underline flex items-center gap-1\"\n                        data-testid={`bates-link-${file.id}`}\n                      >\n                        {file.batesStart}\n                        <ExternalLink className=\"w-3 h-3\" />\n                      </a>\n                    ) : (\n                      <span className=\"font-mono text-xs text-primary font-medium\">{file.batesStart}</span>\n                    )}\n                    {file.sourceType === \"cloud\" && (\n                      <Cloud className=\"w-3 h-3 text-blue-500\" />\n                    )}\n                  </div>\n                  <div className=\"font-medium text-sm text-foreground truncate\">{file.fileName}</div>\n                  <div className=\"text-xs text-muted-foreground line-clamp-2 mt-1\">{file.summary || \"Processing...\"}</div>\n                  {(file.tags || []).length > 0 && (\n                    <div className=\"flex flex-wrap gap-1 mt-2\">\n                      {(file.tags || []).slice(0, 3).map(t => (\n                        <Badge key={t} variant=\"secondary\" className=\"text-[10px] px-1 py-0 h-5 border-border/50 font-normal\">{t}</Badge>\n                      ))}\n                      {(file.tags || []).length > 3 && (\n                        <Badge variant=\"secondary\" className=\"text-[10px] px-1 py-0 h-5 border-border/50 font-normal\">+{(file.tags || []).length - 3}</Badge>\n                      )}\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {/* Desktop Table View */}\n        <div className=\"hidden md:block divide-y\">\n          {filteredFiles.map((file) => (\n            <div \n              key={file.id} \n              className=\"grid grid-cols-12 gap-4 px-6 py-4 items-center hover:bg-muted/30 transition-colors group\"\n              data-testid={`discovery-file-desktop-${file.id}`}\n            >\n              <div className=\"col-span-1 flex items-center justify-center w-10 h-10 rounded-lg bg-background border shadow-sm\">\n                {getIcon(file.fileType)}\n              </div>\n              <div className=\"col-span-2\">\n                {file.driveUrl ? (\n                  <a \n                    href={file.driveUrl} \n                    target=\"_blank\" \n                    rel=\"noopener noreferrer\"\n                    className=\"font-mono text-sm text-accent font-medium hover:underline flex items-center gap-1\"\n                    data-testid={`bates-link-desktop-${file.id}`}\n                  >\n                    {file.batesStart}\n                    <ExternalLink className=\"w-3 h-3\" />\n                  </a>\n                ) : (\n                  <span className=\"font-mono text-sm text-primary font-medium\">{file.batesStart}</span>\n                )}\n                {file.batesStart !== file.batesEnd && (\n                  <span className=\"text-muted-foreground text-xs block\">to {file.batesEnd}</span>\n                )}\n              </div>\n              <div className=\"col-span-4 pr-4\">\n                <div className=\"font-medium text-foreground\">{file.fileName}</div>\n                <div className=\"text-xs text-muted-foreground line-clamp-1\">{file.summary || \"Processing...\"}</div>\n              </div>\n              <div className=\"col-span-2 text-sm\">\n                {file.sourceType === \"cloud\" ? (\n                  <Badge variant=\"outline\" className=\"text-xs gap-1 bg-blue-50 border-blue-200 text-blue-700\">\n                    <Cloud className=\"w-3 h-3\" />\n                    Google Drive\n                  </Badge>\n                ) : (\n                  <Badge variant=\"outline\" className=\"text-xs gap-1 bg-gray-50 border-gray-200 text-gray-700\">\n                    <UploadCloud className=\"w-3 h-3\" />\n                    Uploaded\n                  </Badge>\n                )}\n              </div>\n              <div className=\"col-span-2 flex flex-wrap gap-1\">\n                {(file.tags || []).map(t => (\n                  <Badge key={t} variant=\"secondary\" className=\"text-[10px] px-1 py-0 h-5 border-border/50 font-normal\">{t}</Badge>\n                ))}\n              </div>\n              <div className=\"col-span-1 flex justify-end opacity-0 group-hover:opacity-100 transition-opacity\">\n                {file.driveUrl && (\n                  <a \n                    href={file.driveUrl} \n                    target=\"_blank\" \n                    rel=\"noopener noreferrer\"\n                    className=\"inline-flex items-center justify-center h-8 w-8 rounded-md hover:bg-accent/10\"\n                    data-testid={`button-view-desktop-${file.id}`}\n                  >\n                    <ExternalLink className=\"w-4 h-4 text-accent\" />\n                  </a>\n                )}\n                <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" data-testid={`button-more-${file.id}`}>\n                  <MoreVertical className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </ScrollArea>\n    </div>\n  );\n}\n\nfunction TimelineView() {\n  const [match, params] = useRoute(\"/case/:id\");\n  const caseId = params?.id;\n  \n  const { data: timeline = [], isLoading } = useQuery({\n    queryKey: [\"timeline\", caseId],\n    queryFn: () => getTimeline(caseId!),\n    enabled: !!caseId,\n  });\n  \n  return (\n    <div className=\"max-w-4xl mx-auto py-4 md:py-8 relative\">\n      {isLoading && <div className=\"text-center text-muted-foreground\">Loading timeline...</div>}\n      \n      {/* Mobile Timeline - left-aligned */}\n      <div className=\"md:hidden space-y-4\">\n        <div className=\"absolute left-4 top-0 bottom-0 w-px bg-border\" />\n        {timeline.map((event) => (\n          <div key={event.id} className=\"flex gap-4 pl-2\">\n            <div className=\"relative z-10 w-4 h-4 rounded-full bg-accent border-4 border-background shadow-sm shrink-0 mt-1\" />\n            <div className=\"flex-1 pb-4\">\n              <div className=\"text-xs font-bold text-accent mb-1\">{new Date(event.eventDate).toLocaleDateString()}</div>\n              <h3 className=\"text-base font-serif font-bold text-primary mb-1\">{event.title}</h3>\n              <p className=\"text-muted-foreground text-sm leading-relaxed\">{event.description}</p>\n              {(event.linkedBates || []).length > 0 && (\n                <div className=\"inline-flex items-center gap-2 px-2 py-1 rounded-full bg-secondary text-xs font-mono border mt-2\">\n                  <FileText className=\"w-3 h-3 text-primary\" />\n                  <span>{(event.linkedBates || [])[0]}</span>\n                </div>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Desktop Timeline - alternating */}\n      <div className=\"hidden md:block\">\n        <div className=\"absolute left-1/2 top-0 bottom-0 w-px bg-border -translate-x-1/2\" />\n        {timeline.map((event, i) => (\n          <div key={event.id} className={`flex items-center gap-8 mb-12 ${i % 2 === 0 ? 'flex-row' : 'flex-row-reverse'}`}>\n            <div className={`flex-1 ${i % 2 === 0 ? 'text-right' : 'text-left'}`}>\n              <div className=\"text-sm font-bold text-accent mb-1\">{new Date(event.eventDate).toLocaleDateString()}</div>\n              <h3 className=\"text-xl font-serif font-bold text-primary mb-2\">{event.title}</h3>\n              <p className=\"text-muted-foreground text-sm leading-relaxed\">{event.description}</p>\n            </div>\n            \n            <div className=\"relative z-10 w-4 h-4 rounded-full bg-accent border-4 border-background shadow-sm shrink-0\" />\n            \n            <div className={`flex-1 ${i % 2 === 0 ? 'text-left' : 'text-right'}`}>\n              {(event.linkedBates || []).length > 0 && (\n                <div className={`inline-flex items-center gap-2 px-3 py-1 rounded-full bg-secondary text-xs font-mono border ${i % 2 === 0 ? '' : 'flex-row-reverse'}`}>\n                  <FileText className=\"w-3 h-3 text-primary\" />\n                  <span>{(event.linkedBates || [])[0]}</span>\n                </div>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nfunction TrialPrepView() {\n  const [isRecording, setIsRecording] = useState(false);\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 h-full md:divide-x overflow-auto\">\n      <div className=\"p-4 md:p-6 flex flex-col\">\n        <h3 className=\"font-serif font-bold text-base md:text-lg mb-3 md:mb-4 flex items-center gap-2\">\n          <BrainCircuit className=\"w-5 h-5 text-accent\" />\n          Examination Strategy\n        </h3>\n        <div className=\"flex-1 space-y-3 md:space-y-4\">\n          <div className=\"p-3 md:p-4 rounded-lg bg-secondary/30 border border-secondary\">\n            <h4 className=\"font-semibold text-sm mb-2 text-primary\">Line of Questioning: Inconsistencies</h4>\n            <ul className=\"space-y-1.5 md:space-y-2 text-xs md:text-sm text-muted-foreground list-disc list-inside\">\n              <li>Ask about the timestamp on the surveillance video (10:45 PM).</li>\n              <li>Contrast with email timestamp (10:50 PM sent from home IP).</li>\n              <li>Press on the lack of badge swipe out record.</li>\n            </ul>\n          </div>\n          <div className=\"p-3 md:p-4 rounded-lg bg-accent/10 border border-accent/20\">\n            <h4 className=\"font-semibold text-sm mb-2 text-accent-foreground\">Key Evidence to Present</h4>\n            <div className=\"flex flex-wrap gap-2\">\n              <Badge variant=\"outline\" className=\"bg-background text-xs\">AND-001256</Badge>\n              <Badge variant=\"outline\" className=\"bg-background text-xs\">AND-001257</Badge>\n            </div>\n          </div>\n        </div>\n        <div className=\"mt-4 pt-4 border-t\">\n          <Button \n            className={`w-full ${isRecording ? 'bg-destructive animate-pulse' : 'bg-primary'}`}\n            onClick={() => setIsRecording(!isRecording)}\n          >\n            <Mic className=\"w-4 h-4 mr-2\" />\n            {isRecording ? \"Recording... (Tap to Stop)\" : \"Start Voice Simulation\"}\n          </Button>\n          <p className=\"text-xs text-center mt-2 text-muted-foreground\">CaseBuddy listens and suggests real-time objections/follow-ups.</p>\n        </div>\n      </div>\n\n      <div className=\"p-4 md:p-6 bg-muted/10 flex flex-col border-t md:border-t-0\">\n        <h3 className=\"font-serif font-bold text-base md:text-lg mb-3 md:mb-4\">Live Transcript / Notes</h3>\n        <div className=\"flex-1 min-h-[150px] md:min-h-0 rounded-lg border bg-background p-3 md:p-4 shadow-inner font-mono text-xs md:text-sm leading-relaxed text-muted-foreground\">\n          <p className=\"text-primary/50 italic\">[System Ready. Waiting for audio input...]</p>\n          {isRecording && (\n             <div className=\"mt-4 space-y-2\">\n                <p><span className=\"text-blue-600 font-bold\">Attorney:</span> Can you explain where you were on the night of October 12th?</p>\n                <p><span className=\"text-green-600 font-bold\">Witness:</span> I was at home.</p>\n                <p className=\"animate-pulse\"><span className=\"text-blue-600 font-bold\">Attorney:</span> ...</p>\n             </div>\n          )}\n        </div>\n        <FeaturedNews variant=\"inline\" limit={1} />\n      </div>\n    </div>\n  );\n}\n\nfunction LegalBriefsView({ caseId }: { caseId: string }) {\n  const [showGenerator, setShowGenerator] = useState(false);\n  const [selectedBrief, setSelectedBrief] = useState<LegalBrief | null>(null);\n  const [briefTitle, setBriefTitle] = useState(\"\");\n  const [briefType, setBriefType] = useState(\"\");\n  const [additionalInstructions, setAdditionalInstructions] = useState(\"\");\n  const { toast } = useToast();\n  const { setSaving, setSaved, setError } = useSaveStatus();\n  const queryClient = useQueryClient();\n\n  const { data: briefs = [], isLoading } = useQuery({\n    queryKey: [\"legalBriefs\", caseId],\n    queryFn: () => getLegalBriefs(caseId),\n  });\n\n  const { data: briefTypes = {} } = useQuery({\n    queryKey: [\"briefTypes\"],\n    queryFn: getBriefTypes,\n  });\n\n  const generateMutation = useMutation({\n    mutationFn: () => generateLegalBrief(caseId, briefType, briefTitle, additionalInstructions),\n    onMutate: () => {\n      setSaving();\n    },\n    onSuccess: (newBrief) => {\n      queryClient.invalidateQueries({ queryKey: [\"legalBriefs\", caseId] });\n      setSaved();\n      toast({\n        title: \"Brief Generated\",\n        description: \"Your legal brief has been created and saved.\",\n      });\n      setShowGenerator(false);\n      setSelectedBrief(newBrief);\n      setBriefTitle(\"\");\n      setBriefType(\"\");\n      setAdditionalInstructions(\"\");\n    },\n    onError: () => {\n      setError();\n      toast({\n        title: \"Generation Failed\",\n        description: \"Unable to generate the legal brief. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (briefId: number) => deleteLegalBrief(briefId),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"legalBriefs\", caseId] });\n      setSaved();\n      toast({ title: \"Brief Deleted\" });\n      setSelectedBrief(null);\n    },\n  });\n\n  if (selectedBrief) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2\">\n          <Button variant=\"ghost\" size=\"sm\" onClick={() => setSelectedBrief(null)} data-testid=\"button-back-briefs\">\n            <ChevronRight className=\"w-4 h-4 mr-1 sm:mr-2 rotate-180\" /> Back\n          </Button>\n          <div className=\"flex gap-2\">\n            <Badge variant={selectedBrief.status === \"draft\" ? \"outline\" : \"default\"} className=\"text-xs\">\n              {selectedBrief.status}\n            </Badge>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => deleteMutation.mutate(selectedBrief.id)}\n              data-testid=\"button-delete-brief\"\n            >\n              <Trash2 className=\"w-4 h-4 sm:mr-1\" /> <span className=\"hidden sm:inline\">Delete</span>\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"bg-muted/30 rounded-lg p-4 md:p-6\">\n          <h2 className=\"text-xl md:text-2xl font-serif font-bold mb-2\">{selectedBrief.title}</h2>\n          <p className=\"text-xs md:text-sm text-muted-foreground mb-4\">\n            {briefTypes[selectedBrief.briefType] || selectedBrief.briefType}  Created {new Date(selectedBrief.createdAt).toLocaleDateString()}\n          </p>\n\n          {selectedBrief.summary && (\n            <div className=\"mb-6 p-4 bg-primary/5 rounded-lg border border-primary/10\">\n              <h4 className=\"text-sm font-semibold text-primary mb-2\">Summary</h4>\n              <p className=\"text-sm\">{selectedBrief.summary}</p>\n            </div>\n          )}\n\n          {selectedBrief.keyArguments && (selectedBrief.keyArguments as string[]).length > 0 && (\n            <div className=\"mb-6\">\n              <h4 className=\"text-sm font-semibold mb-2\">Key Arguments</h4>\n              <ul className=\"list-disc list-inside space-y-1 text-sm text-muted-foreground\">\n                {(selectedBrief.keyArguments as string[]).map((arg, i) => (\n                  <li key={i}>{arg}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n\n          {selectedBrief.precedents && (selectedBrief.precedents as any[]).length > 0 && (\n            <div className=\"mb-6\">\n              <h4 className=\"text-sm font-semibold mb-2\">Legal Precedents</h4>\n              <div className=\"space-y-2\">\n                {(selectedBrief.precedents as any[]).map((p, i) => (\n                  <div key={i} className=\"p-3 bg-background rounded border text-sm\">\n                    <span className=\"font-medium\">{p.caseName}</span>\n                    <span className=\"text-muted-foreground ml-2\">{p.citation}</span>\n                    <p className=\"text-xs text-muted-foreground mt-1\">{p.relevance}</p>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          <div className=\"prose prose-sm max-w-none\">\n            <h4 className=\"text-sm font-semibold mb-2\">Full Brief</h4>\n            <div className=\"p-4 bg-background rounded-lg border font-serif whitespace-pre-wrap text-sm leading-relaxed\">\n              {selectedBrief.content}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4 md:space-y-6\">\n      <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3\">\n        <div>\n          <h2 className=\"text-lg md:text-xl font-serif font-bold flex items-center gap-2\">\n            <BookOpen className=\"w-5 h-5 text-primary\" />\n            Legal Briefs\n          </h2>\n          <p className=\"text-xs md:text-sm text-muted-foreground\">\n            AI-generated legal documents based on your case\n          </p>\n        </div>\n        <Button size=\"sm\" onClick={() => setShowGenerator(true)} data-testid=\"button-generate-brief\">\n          <Plus className=\"w-4 h-4 mr-1 sm:mr-2\" /> <span className=\"hidden sm:inline\">Generate</span> Brief\n        </Button>\n      </div>\n\n      {showGenerator && (\n        <div className=\"bg-muted/30 rounded-lg p-4 md:p-6 border\">\n          <h3 className=\"font-semibold mb-3 md:mb-4 text-sm md:text-base\">Generate New Legal Brief</h3>\n          <div className=\"space-y-3 md:space-y-4\">\n            <div>\n              <label className=\"text-xs md:text-sm font-medium mb-1 block\">Brief Title</label>\n              <Input\n                placeholder=\"e.g., Motion to Dismiss\"\n                value={briefTitle}\n                onChange={(e) => setBriefTitle(e.target.value)}\n                className=\"text-sm\"\n                data-testid=\"input-brief-title\"\n              />\n            </div>\n            <div>\n              <label className=\"text-xs md:text-sm font-medium mb-1 block\">Brief Type</label>\n              <select\n                className=\"w-full p-2 border rounded-md bg-background text-sm\"\n                value={briefType}\n                onChange={(e) => setBriefType(e.target.value)}\n                data-testid=\"select-brief-type\"\n              >\n                <option value=\"\">Select a type...</option>\n                {Object.entries(briefTypes).map(([key, label]) => (\n                  <option key={key} value={key}>{label}</option>\n                ))}\n              </select>\n            </div>\n            <div>\n              <label className=\"text-xs md:text-sm font-medium mb-1 block\">Additional Instructions (Optional)</label>\n              <textarea\n                className=\"w-full p-2 border rounded-md bg-background min-h-[60px] md:min-h-[80px] text-sm\"\n                placeholder=\"Any specific focus areas...\"\n                value={additionalInstructions}\n                onChange={(e) => setAdditionalInstructions(e.target.value)}\n                data-testid=\"input-brief-instructions\"\n              />\n            </div>\n            <div className=\"flex flex-col sm:flex-row gap-2\">\n              <Button\n                onClick={() => generateMutation.mutate()}\n                disabled={!briefTitle || !briefType || generateMutation.isPending}\n                size=\"sm\"\n                className=\"flex-1 sm:flex-initial\"\n                data-testid=\"button-submit-brief\"\n              >\n                {generateMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> Generating...\n                  </>\n                ) : (\n                  <>\n                    <BrainCircuit className=\"w-4 h-4 mr-2\" /> Generate with AI\n                  </>\n                )}\n              </Button>\n              <Button variant=\"outline\" size=\"sm\" onClick={() => setShowGenerator(false)}>\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {isLoading && (\n        <div className=\"text-center py-12 text-muted-foreground\">\n          <Loader2 className=\"w-8 h-8 animate-spin mx-auto mb-2\" />\n          Loading briefs...\n        </div>\n      )}\n\n      {!isLoading && briefs.length === 0 && !showGenerator && (\n        <div className=\"text-center py-12 border-2 border-dashed rounded-lg\">\n          <FileEdit className=\"w-12 h-12 mx-auto text-muted-foreground/50 mb-4\" />\n          <h3 className=\"text-lg font-medium mb-2\">No Legal Briefs Yet</h3>\n          <p className=\"text-sm text-muted-foreground mb-4\">\n            Generate AI-powered legal briefs based on your case documents and timeline.\n          </p>\n          <Button onClick={() => setShowGenerator(true)}>\n            <Plus className=\"w-4 h-4 mr-2\" /> Create Your First Brief\n          </Button>\n        </div>\n      )}\n\n      {briefs.length > 0 && (\n        <div className=\"grid gap-4\">\n          {briefs.map((brief) => (\n            <div\n              key={brief.id}\n              className=\"p-4 bg-background border rounded-lg hover:border-primary/30 transition-colors cursor-pointer\"\n              onClick={() => setSelectedBrief(brief)}\n              data-testid={`brief-card-${brief.id}`}\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 mb-1\">\n                    <h3 className=\"font-medium\">{brief.title}</h3>\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      {briefTypes[brief.briefType] || brief.briefType}\n                    </Badge>\n                    <Badge variant={brief.status === \"draft\" ? \"secondary\" : \"default\"} className=\"text-xs\">\n                      {brief.status}\n                    </Badge>\n                  </div>\n                  {brief.summary && (\n                    <p className=\"text-sm text-muted-foreground line-clamp-2\">{brief.summary}</p>\n                  )}\n                  <p className=\"text-xs text-muted-foreground mt-2\">\n                    Created {new Date(brief.createdAt).toLocaleDateString()}\n                  </p>\n                </div>\n                <ChevronRight className=\"w-5 h-5 text-muted-foreground\" />\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":52301,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7606,"size_tokens":null},"server/replit_integrations/chat/index.ts":{"content":"export { registerChatRoutes } from \"./routes\";\nexport { chatStorage, type IChatStorage } from \"./storage\";\n\n","path":null,"size_bytes":108,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"server/replit_integrations/image/index.ts":{"content":"export { registerImageRoutes } from \"./routes\";\nexport { ai, generateImage } from \"./client\";\n\n","path":null,"size_bytes":95,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/layout.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { \n  LayoutDashboard, \n  Briefcase, \n  Calendar, \n  Settings, \n  LogOut, \n  Search,\n  Scale,\n  Bell,\n  Cloud,\n  CloudOff,\n  Loader2,\n  Check,\n  Menu,\n  X\n} from \"lucide-react\";\nimport { useState, useEffect, createContext, useContext } from \"react\";\nimport logo from \"@assets/generated_images/minimalist_legal_logo_navy_gold.png\";\nimport { useSaveStatus } from \"@/hooks/use-save-status\";\n\nconst MobileMenuContext = createContext<{\n  isOpen: boolean;\n  setIsOpen: (open: boolean) => void;\n}>({ isOpen: false, setIsOpen: () => {} });\n\nexport function useMobileMenu() {\n  return useContext(MobileMenuContext);\n}\n\nexport function Sidebar({ onClose }: { onClose?: () => void }) {\n  const [location] = useLocation();\n\n  const navItems = [\n    { icon: LayoutDashboard, label: \"Dashboard\", href: \"/\" },\n    { icon: Briefcase, label: \"My Cases\", href: \"/cases\" },\n    { icon: Calendar, label: \"Calendar\", href: \"/calendar\" },\n    { icon: Scale, label: \"Legal Research\", href: \"/research\" },\n    { icon: Settings, label: \"Settings\", href: \"/settings\" },\n  ];\n\n  const handleNavClick = () => {\n    if (onClose) onClose();\n  };\n\n  return (\n    <div className=\"w-64 h-screen bg-sidebar text-sidebar-foreground border-r border-sidebar-border flex flex-col shadow-2xl\">\n      <div className=\"p-4 md:p-6 flex items-center justify-between border-b border-sidebar-border/50\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-10 h-10 rounded-lg bg-sidebar-primary/10 flex items-center justify-center p-1\">\n            <img src={logo} alt=\"CaseBuddy Logo\" className=\"w-full h-full object-contain\" />\n          </div>\n          <div>\n            <h1 className=\"font-serif font-bold text-lg text-sidebar-primary tracking-wide\">CaseBuddy</h1>\n            <p className=\"text-xs text-sidebar-foreground/60 uppercase tracking-wider\">Legal AI OS</p>\n          </div>\n        </div>\n        {onClose && (\n          <button \n            onClick={onClose}\n            className=\"md:hidden p-2 rounded-lg hover:bg-sidebar-accent transition-colors\"\n            data-testid=\"button-close-sidebar\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        )}\n      </div>\n\n      <nav className=\"flex-1 p-4 space-y-2 mt-2 md:mt-4 overflow-y-auto\">\n        {navItems.map((item) => {\n          const isActive = location === item.href || (item.href !== \"/\" && location.startsWith(item.href));\n          return (\n            <Link \n              key={item.href} \n              href={item.href}\n              onClick={handleNavClick}\n              className={`\n                flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 group\n                ${isActive \n                  ? \"bg-sidebar-primary text-sidebar-primary-foreground font-medium shadow-md shadow-sidebar-primary/20\" \n                  : \"text-sidebar-foreground/80 hover:bg-sidebar-accent hover:text-white\"\n                }\n              `}\n            >\n              <item.icon className={`w-5 h-5 ${isActive ? \"text-sidebar-primary-foreground\" : \"text-sidebar-foreground/60 group-hover:text-white\"}`} />\n              <span>{item.label}</span>\n            </Link>\n          );\n        })}\n      </nav>\n\n      <div className=\"p-4 border-t border-sidebar-border/50\">\n        <button className=\"flex items-center gap-3 px-4 py-3 w-full rounded-lg text-sidebar-foreground/60 hover:bg-destructive/10 hover:text-destructive transition-colors\">\n          <LogOut className=\"w-5 h-5\" />\n          <span>Sign Out</span>\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction SaveStatusIndicator() {\n  const { status, lastSaved } = useSaveStatus();\n\n  const formatTime = (date: Date | null) => {\n    if (!date) return \"\";\n    return date.toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" });\n  };\n\n  return (\n    <div className=\"flex items-center gap-2 px-3 py-1.5 rounded-full bg-secondary/50 text-xs\" data-testid=\"save-status-indicator\">\n      {status === \"saving\" && (\n        <>\n          <Loader2 className=\"w-3 h-3 animate-spin text-blue-500\" />\n          <span className=\"text-muted-foreground\">Saving...</span>\n        </>\n      )}\n      {status === \"saved\" && (\n        <>\n          <Cloud className=\"w-3 h-3 text-green-500\" />\n          <span className=\"text-green-600 font-medium\">Saved</span>\n          {lastSaved && (\n            <span className=\"text-muted-foreground\">{formatTime(lastSaved)}</span>\n          )}\n        </>\n      )}\n      {status === \"error\" && (\n        <>\n          <CloudOff className=\"w-3 h-3 text-red-500\" />\n          <span className=\"text-red-600 font-medium\">Save failed</span>\n        </>\n      )}\n    </div>\n  );\n}\n\nexport function Layout({ children }: { children: React.ReactNode }) {\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n\n  // Close sidebar on route change for mobile\n  const [location] = useLocation();\n  useEffect(() => {\n    setSidebarOpen(false);\n  }, [location]);\n\n  // Prevent body scroll when sidebar is open on mobile\n  useEffect(() => {\n    if (sidebarOpen) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [sidebarOpen]);\n\n  return (\n    <MobileMenuContext.Provider value={{ isOpen: sidebarOpen, setIsOpen: setSidebarOpen }}>\n      <div className=\"min-h-screen bg-background font-sans flex\">\n        {/* Desktop Sidebar - always visible */}\n        <div className=\"hidden md:block fixed left-0 top-0 z-20\">\n          <Sidebar />\n        </div>\n\n        {/* Mobile Sidebar Overlay */}\n        {sidebarOpen && (\n          <div \n            className=\"md:hidden fixed inset-0 bg-black/50 z-30 animate-in fade-in duration-200\"\n            onClick={() => setSidebarOpen(false)}\n          />\n        )}\n\n        {/* Mobile Sidebar - slide in from left */}\n        <div className={`\n          md:hidden fixed left-0 top-0 z-40 transform transition-transform duration-300 ease-in-out\n          ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'}\n        `}>\n          <Sidebar onClose={() => setSidebarOpen(false)} />\n        </div>\n\n        <main className=\"flex-1 md:ml-64 min-h-screen relative w-full\">\n          <header className=\"h-14 md:h-16 border-b bg-background/80 backdrop-blur-sm sticky top-0 z-10 px-4 md:px-8 flex items-center justify-between gap-2 md:gap-4\">\n            {/* Mobile menu button */}\n            <button \n              onClick={() => setSidebarOpen(true)}\n              className=\"md:hidden p-2 -ml-2 rounded-lg hover:bg-secondary transition-colors\"\n              data-testid=\"button-open-sidebar\"\n            >\n              <Menu className=\"w-5 h-5\" />\n            </button>\n\n            {/* Mobile logo */}\n            <div className=\"md:hidden flex items-center gap-2\">\n              <div className=\"w-7 h-7 rounded-lg bg-primary/10 flex items-center justify-center p-0.5\">\n                <img src={logo} alt=\"CaseBuddy\" className=\"w-full h-full object-contain\" />\n              </div>\n              <span className=\"font-serif font-bold text-primary text-sm\">CaseBuddy</span>\n            </div>\n\n            {/* Search bar - hidden on very small screens, smaller on tablet */}\n            <div className=\"hidden sm:block flex-1 max-w-[200px] md:max-w-[384px] relative\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n              <input \n                type=\"text\" \n                placeholder=\"Search...\" \n                className=\"w-full pl-9 md:pl-10 pr-3 md:pr-4 py-2 bg-secondary/50 border-none rounded-full text-sm focus:ring-2 focus:ring-primary/20 outline-none transition-all\"\n                data-testid=\"input-global-search\"\n              />\n            </div>\n\n            <div className=\"flex items-center gap-2 md:gap-4\">\n              {/* Mobile search button */}\n              <button className=\"sm:hidden p-2 rounded-full hover:bg-secondary transition-colors\" data-testid=\"button-mobile-search\">\n                <Search className=\"w-5 h-5 text-muted-foreground\" />\n              </button>\n              <div className=\"hidden sm:block\">\n                <SaveStatusIndicator />\n              </div>\n              <button className=\"relative p-2 rounded-full hover:bg-secondary transition-colors\" data-testid=\"button-notifications\">\n                <Bell className=\"w-5 h-5 text-muted-foreground\" />\n                <span className=\"absolute top-1.5 right-1.5 w-2 h-2 bg-destructive rounded-full border-2 border-background\"></span>\n              </button>\n              <div className=\"w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center font-serif font-bold text-xs\">\n                JD\n              </div>\n            </div>\n          </header>\n          <div className=\"p-4 md:p-8\">\n            {children}\n          </div>\n        </main>\n      </div>\n    </MobileMenuContext.Provider>\n  );\n}\n","path":null,"size_bytes":9003,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  if (!itemContext) {\n    throw new Error(\"useFormField should be used within <FormItem>\")\n  }\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4175,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"import * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1237,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  // Seed database with sample data on first run\n  const { seedDatabase } = await import(\"./seed\");\n  await seedDatabase();\n\n  // Start news aggregator scheduler\n  const { startNewsRefreshScheduler } = await import(\"./services/newsAggregator\");\n  startNewsRefreshScheduler();\n\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":2837,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"server/db.ts":{"content":"import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL environment variable is required\");\n}\n\nconst pool = new pg.Pool({\n  connectionString: process.env.DATABASE_URL,\n});\n\nexport const db = drizzle(pool, { schema });\n","path":null,"size_bytes":344,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"import * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3007,"size_tokens":null},"client/src/components/video-call-panel.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from \"react\";\nimport DailyIframe, { DailyCall } from \"@daily-co/daily-js\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { \n  Video, \n  VideoOff, \n  Mic, \n  MicOff, \n  PhoneOff, \n  Monitor, \n  Users,\n  Maximize2,\n  Minimize2,\n  X,\n  Loader2,\n  Copy,\n  Link,\n  Check\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface VideoCallPanelProps {\n  caseId: number;\n  caseName: string;\n  userId: string;\n  userName: string;\n  onClose: () => void;\n}\n\nexport function VideoCallPanel({ caseId, caseName, userId, userName, onClose }: VideoCallPanelProps) {\n  const { toast } = useToast();\n  const [callState, setCallState] = useState<\"idle\" | \"joining\" | \"joined\" | \"error\">(\"idle\");\n  const [isMuted, setIsMuted] = useState(false);\n  const [isVideoOff, setIsVideoOff] = useState(false);\n  const [isScreenSharing, setIsScreenSharing] = useState(false);\n  const [isMinimized, setIsMinimized] = useState(false);\n  const [participantCount, setParticipantCount] = useState(0);\n  const [roomUrl, setRoomUrl] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [linkCopied, setLinkCopied] = useState(false);\n  \n  const callRef = useRef<DailyCall | null>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const copyInviteLink = useCallback(async () => {\n    if (roomUrl) {\n      try {\n        await navigator.clipboard.writeText(roomUrl);\n        setLinkCopied(true);\n        toast({\n          title: \"Link copied!\",\n          description: \"Share this link with others to join the video call\",\n        });\n        setTimeout(() => setLinkCopied(false), 3000);\n      } catch (err) {\n        toast({\n          title: \"Failed to copy link\",\n          description: roomUrl,\n          variant: \"destructive\",\n        });\n      }\n    }\n  }, [roomUrl, toast]);\n\n  const createOrJoinRoom = useCallback(async () => {\n    setCallState(\"joining\");\n    setError(null);\n    \n    try {\n      const response = await fetch(`/api/cases/${caseId}/video-room`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ userId, userName }),\n      });\n      \n      if (!response.ok) {\n        const data = await response.json();\n        throw new Error(data.error || \"Failed to create video room\");\n      }\n      \n      const data = await response.json();\n      setRoomUrl(data.url);\n      \n      if (!callRef.current) {\n        callRef.current = DailyIframe.createCallObject({\n          showLeaveButton: false,\n          showFullscreenButton: false,\n        });\n      }\n\n      callRef.current.on(\"joined-meeting\", () => {\n        setCallState(\"joined\");\n        updateParticipantCount();\n      });\n\n      callRef.current.on(\"left-meeting\", () => {\n        setCallState(\"idle\");\n        setParticipantCount(0);\n      });\n\n      callRef.current.on(\"participant-joined\", updateParticipantCount);\n      callRef.current.on(\"participant-left\", updateParticipantCount);\n\n      callRef.current.on(\"error\", (e) => {\n        console.error(\"Daily error:\", e);\n        setError(\"Video call error occurred\");\n        setCallState(\"error\");\n      });\n\n      await callRef.current.join({ \n        url: data.url,\n        userName: userName,\n      });\n      \n    } catch (err) {\n      console.error(\"Failed to join video call:\", err);\n      setError(err instanceof Error ? err.message : \"Failed to join video call\");\n      setCallState(\"error\");\n    }\n  }, [caseId, userId, userName]);\n\n  const updateParticipantCount = useCallback(() => {\n    if (callRef.current) {\n      const participants = callRef.current.participants();\n      setParticipantCount(Object.keys(participants).length);\n    }\n  }, []);\n\n  const leaveCall = useCallback(async () => {\n    if (callRef.current) {\n      await callRef.current.leave();\n      callRef.current.destroy();\n      callRef.current = null;\n    }\n    \n    try {\n      await fetch(`/api/cases/${caseId}/video-room`, {\n        method: \"DELETE\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ userId }),\n      });\n    } catch (err) {\n      console.error(\"Failed to notify leave:\", err);\n    }\n    \n    setCallState(\"idle\");\n    setRoomUrl(null);\n  }, [caseId, userId]);\n\n  const toggleMute = useCallback(() => {\n    if (callRef.current) {\n      const newMuted = !isMuted;\n      callRef.current.setLocalAudio(!newMuted);\n      setIsMuted(newMuted);\n    }\n  }, [isMuted]);\n\n  const toggleVideo = useCallback(() => {\n    if (callRef.current) {\n      const newVideoOff = !isVideoOff;\n      callRef.current.setLocalVideo(!newVideoOff);\n      setIsVideoOff(newVideoOff);\n    }\n  }, [isVideoOff]);\n\n  const toggleScreenShare = useCallback(async () => {\n    if (callRef.current) {\n      if (isScreenSharing) {\n        await callRef.current.stopScreenShare();\n      } else {\n        await callRef.current.startScreenShare();\n      }\n      setIsScreenSharing(!isScreenSharing);\n    }\n  }, [isScreenSharing]);\n\n  useEffect(() => {\n    return () => {\n      if (callRef.current) {\n        callRef.current.leave();\n        callRef.current.destroy();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (callRef.current && containerRef.current && callState === \"joined\") {\n      const iframe = callRef.current.iframe();\n      if (iframe) {\n        containerRef.current.innerHTML = \"\";\n        iframe.style.width = \"100%\";\n        iframe.style.height = \"100%\";\n        iframe.style.border = \"none\";\n        iframe.style.borderRadius = \"8px\";\n        containerRef.current.appendChild(iframe);\n      }\n    }\n  }, [callState]);\n\n  const handleClose = async () => {\n    await leaveCall();\n    onClose();\n  };\n\n  if (isMinimized) {\n    return (\n      <Card className=\"fixed bottom-4 right-4 z-50 p-3 shadow-lg bg-background/95 backdrop-blur border-primary/20\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\" />\n          <span className=\"text-sm font-medium\">Video Call Active</span>\n          <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\n            <Users className=\"w-3 h-3\" />\n            {participantCount}\n          </div>\n          <Button variant=\"ghost\" size=\"icon\" className=\"h-7 w-7\" onClick={() => setIsMinimized(false)}>\n            <Maximize2 className=\"w-4 h-4\" />\n          </Button>\n          <Button variant=\"ghost\" size=\"icon\" className=\"h-7 w-7 text-destructive\" onClick={handleClose}>\n            <PhoneOff className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"fixed bottom-4 right-4 z-50 w-[calc(100vw-2rem)] sm:w-[400px] h-[300px] sm:h-[350px] shadow-2xl bg-background/95 backdrop-blur border-primary/20 flex flex-col overflow-hidden\" data-testid=\"video-call-panel\">\n      <div className=\"flex items-center justify-between p-3 border-b bg-muted/30\">\n        <div className=\"flex items-center gap-2\">\n          <Video className=\"w-4 h-4 text-primary\" />\n          <span className=\"text-sm font-medium truncate max-w-[200px]\">{caseName}</span>\n          {callState === \"joined\" && (\n            <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\n              <Users className=\"w-3 h-3\" />\n              {participantCount}\n            </div>\n          )}\n        </div>\n        <div className=\"flex items-center gap-1\">\n          <Button variant=\"ghost\" size=\"icon\" className=\"h-7 w-7\" onClick={() => setIsMinimized(true)}>\n            <Minimize2 className=\"w-4 h-4\" />\n          </Button>\n          <Button variant=\"ghost\" size=\"icon\" className=\"h-7 w-7\" onClick={handleClose}>\n            <X className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </div>\n      \n      <div className=\"flex-1 bg-slate-900 relative\" ref={containerRef}>\n        {callState === \"idle\" && (\n          <div className=\"absolute inset-0 flex flex-col items-center justify-center gap-4 text-white\">\n            <Video className=\"w-12 h-12 text-primary\" />\n            <p className=\"text-sm text-slate-300\">Start a video call with your team</p>\n            <Button onClick={createOrJoinRoom} className=\"gap-2\" data-testid=\"button-join-call\">\n              <Video className=\"w-4 h-4\" />\n              Join Call\n            </Button>\n          </div>\n        )}\n        \n        {callState === \"joining\" && (\n          <div className=\"absolute inset-0 flex flex-col items-center justify-center gap-4 text-white\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n            <p className=\"text-sm text-slate-300\">Joining video call...</p>\n          </div>\n        )}\n        \n        {callState === \"error\" && (\n          <div className=\"absolute inset-0 flex flex-col items-center justify-center gap-4 text-white\">\n            <VideoOff className=\"w-12 h-12 text-destructive\" />\n            <p className=\"text-sm text-red-400\">{error || \"Failed to join call\"}</p>\n            <Button variant=\"outline\" onClick={createOrJoinRoom} className=\"gap-2\">\n              Try Again\n            </Button>\n          </div>\n        )}\n      </div>\n      \n      {callState === \"joined\" && (\n        <div className=\"flex items-center justify-center gap-2 p-3 border-t bg-muted/30\">\n          <Button \n            variant={isMuted ? \"destructive\" : \"secondary\"} \n            size=\"icon\" \n            className=\"h-9 w-9 rounded-full\"\n            onClick={toggleMute}\n            data-testid=\"button-toggle-mute\"\n          >\n            {isMuted ? <MicOff className=\"w-4 h-4\" /> : <Mic className=\"w-4 h-4\" />}\n          </Button>\n          <Button \n            variant={isVideoOff ? \"destructive\" : \"secondary\"} \n            size=\"icon\" \n            className=\"h-9 w-9 rounded-full\"\n            onClick={toggleVideo}\n            data-testid=\"button-toggle-video\"\n          >\n            {isVideoOff ? <VideoOff className=\"w-4 h-4\" /> : <Video className=\"w-4 h-4\" />}\n          </Button>\n          <Button \n            variant={isScreenSharing ? \"default\" : \"secondary\"} \n            size=\"icon\" \n            className=\"h-9 w-9 rounded-full\"\n            onClick={toggleScreenShare}\n            data-testid=\"button-screen-share\"\n          >\n            <Monitor className=\"w-4 h-4\" />\n          </Button>\n          <Button \n            variant={linkCopied ? \"default\" : \"outline\"} \n            size=\"icon\" \n            className=\"h-9 w-9 rounded-full\"\n            onClick={copyInviteLink}\n            data-testid=\"button-share-link\"\n            title=\"Copy invite link to share with others\"\n          >\n            {linkCopied ? <Check className=\"w-4 h-4\" /> : <Link className=\"w-4 h-4\" />}\n          </Button>\n          <Button \n            variant=\"destructive\" \n            size=\"icon\" \n            className=\"h-9 w-9 rounded-full\"\n            onClick={handleClose}\n            data-testid=\"button-end-call\"\n          >\n            <PhoneOff className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      )}\n    </Card>\n  );\n}\n","path":null,"size_bytes":11072,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":2001,"size_tokens":null},"client/src/lib/api.ts":{"content":"import type { Case, DiscoveryFile, TimelineEvent, DepositionPrep, SuggestedFiling, CloudFolder } from \"@shared/schema\";\n\nconst API_BASE = \"/api\";\n\n// Cases\nexport async function getCases(): Promise<(Case & { filesCount: number; lastActivity: Date })[]> {\n  const res = await fetch(`${API_BASE}/cases`);\n  if (!res.ok) throw new Error(\"Failed to fetch cases\");\n  return res.json();\n}\n\nexport async function getCase(id: string): Promise<Case & { filesCount: number }> {\n  const res = await fetch(`${API_BASE}/cases/${id}`);\n  if (!res.ok) throw new Error(\"Failed to fetch case\");\n  return res.json();\n}\n\nexport async function createCase(data: {\n  title: string;\n  caseNumber: string;\n  client: string;\n  description?: string;\n}): Promise<Case> {\n  const res = await fetch(`${API_BASE}/cases`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(data),\n  });\n  if (!res.ok) throw new Error(\"Failed to create case\");\n  return res.json();\n}\n\n// Discovery Files\nexport async function getDiscoveryFiles(caseId: string): Promise<DiscoveryFile[]> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/discovery`);\n  if (!res.ok) throw new Error(\"Failed to fetch discovery files\");\n  return res.json();\n}\n\nexport async function uploadDiscoveryFile(\n  caseId: string,\n  file: File,\n  batesStart?: string,\n  batesEnd?: string\n): Promise<DiscoveryFile> {\n  const formData = new FormData();\n  formData.append(\"file\", file);\n  if (batesStart) formData.append(\"batesStart\", batesStart);\n  if (batesEnd) formData.append(\"batesEnd\", batesEnd);\n\n  const res = await fetch(`${API_BASE}/cases/${caseId}/discovery/upload`, {\n    method: \"POST\",\n    body: formData,\n  });\n\n  if (!res.ok) throw new Error(\"Failed to upload file\");\n  return res.json();\n}\n\n// Timeline\nexport async function getTimeline(caseId: string): Promise<TimelineEvent[]> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/timeline`);\n  if (!res.ok) throw new Error(\"Failed to fetch timeline\");\n  return res.json();\n}\n\nexport async function generateTimeline(caseId: string): Promise<TimelineEvent[]> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/timeline/generate`, {\n    method: \"POST\",\n  });\n  if (!res.ok) throw new Error(\"Failed to generate timeline\");\n  return res.json();\n}\n\n// Deposition Prep\nexport async function getDepositionPrep(caseId: string): Promise<DepositionPrep[]> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/deposition`);\n  if (!res.ok) throw new Error(\"Failed to fetch deposition prep\");\n  return res.json();\n}\n\nexport async function generateDepositionQuestions(\n  caseId: string,\n  witnessName: string,\n  depositionType: \"direct\" | \"cross\"\n): Promise<DepositionPrep> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/deposition/generate`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ witnessName, depositionType }),\n  });\n  if (!res.ok) throw new Error(\"Failed to generate deposition prep\");\n  return res.json();\n}\n\n// Suggested Filings\nexport async function getSuggestedFilings(caseId: string): Promise<SuggestedFiling[]> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/filings`);\n  if (!res.ok) throw new Error(\"Failed to fetch filings\");\n  return res.json();\n}\n\nexport async function generateSuggestedFilings(caseId: string): Promise<SuggestedFiling[]> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/filings/generate`, {\n    method: \"POST\",\n  });\n  if (!res.ok) throw new Error(\"Failed to generate filing suggestions\");\n  return res.json();\n}\n\n// Google Drive Integration\nexport interface DriveFolder {\n  id: string;\n  name: string;\n}\n\nexport async function getDriveFolders(parentId?: string): Promise<DriveFolder[]> {\n  const url = parentId \n    ? `${API_BASE}/drive/folders?parentId=${encodeURIComponent(parentId)}`\n    : `${API_BASE}/drive/folders`;\n  const res = await fetch(url);\n  if (!res.ok) {\n    if (res.status === 401) throw new Error(\"Google Drive not connected\");\n    throw new Error(\"Failed to fetch Drive folders\");\n  }\n  return res.json();\n}\n\nexport async function getCloudFolders(caseId: string): Promise<CloudFolder[]> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/cloud-folders`);\n  if (!res.ok) throw new Error(\"Failed to fetch cloud folders\");\n  return res.json();\n}\n\nexport async function linkCloudFolder(\n  caseId: string,\n  folderId: string,\n  folderName: string,\n  batesPrefix: string\n): Promise<CloudFolder> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/cloud-folders`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ folderId, folderName, batesPrefix }),\n  });\n  if (!res.ok) throw new Error(\"Failed to link cloud folder\");\n  return res.json();\n}\n\nexport async function syncCloudFolder(folderId: number): Promise<{ message: string; files: DiscoveryFile[] }> {\n  const res = await fetch(`${API_BASE}/cloud-folders/${folderId}/sync`, {\n    method: \"POST\",\n  });\n  if (!res.ok) {\n    if (res.status === 401) throw new Error(\"Google Drive not connected\");\n    throw new Error(\"Failed to sync cloud folder\");\n  }\n  return res.json();\n}\n\nexport async function deleteCloudFolder(folderId: number): Promise<void> {\n  const res = await fetch(`${API_BASE}/cloud-folders/${folderId}`, {\n    method: \"DELETE\",\n  });\n  if (!res.ok) throw new Error(\"Failed to delete cloud folder\");\n}\n\n// News Articles\nexport interface NewsArticle {\n  id: number;\n  url: string;\n  title: string;\n  summary: string | null;\n  imageUrl: string | null;\n  publishedAt: string | null;\n  featured: boolean;\n  source: string;\n}\n\nexport async function getLatestNews(limit: number = 3): Promise<NewsArticle[]> {\n  const res = await fetch(`${API_BASE}/news/latest?limit=${limit}`);\n  if (!res.ok) throw new Error(\"Failed to fetch news\");\n  return res.json();\n}\n\nexport async function getFeaturedNews(limit: number = 2): Promise<NewsArticle[]> {\n  const res = await fetch(`${API_BASE}/news/featured?limit=${limit}`);\n  if (!res.ok) throw new Error(\"Failed to fetch featured news\");\n  return res.json();\n}\n\n// Legal Briefs\nexport interface LegalBrief {\n  id: number;\n  caseId: number;\n  title: string;\n  briefType: string;\n  content: string;\n  summary: string | null;\n  precedents: Array<{ caseName: string; citation: string; relevance: string }> | null;\n  keyArguments: string[] | null;\n  status: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport async function getLegalBriefs(caseId: string): Promise<LegalBrief[]> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/briefs`);\n  if (!res.ok) throw new Error(\"Failed to fetch legal briefs\");\n  return res.json();\n}\n\nexport async function getBriefTypes(): Promise<Record<string, string>> {\n  const res = await fetch(`${API_BASE}/briefs/types`);\n  if (!res.ok) throw new Error(\"Failed to fetch brief types\");\n  return res.json();\n}\n\nexport async function getLegalBrief(briefId: number): Promise<LegalBrief> {\n  const res = await fetch(`${API_BASE}/briefs/${briefId}`);\n  if (!res.ok) throw new Error(\"Failed to fetch legal brief\");\n  return res.json();\n}\n\nexport async function generateLegalBrief(\n  caseId: string,\n  briefType: string,\n  title: string,\n  additionalInstructions?: string\n): Promise<LegalBrief> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/briefs/generate`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ briefType, title, additionalInstructions }),\n  });\n  if (!res.ok) throw new Error(\"Failed to generate legal brief\");\n  return res.json();\n}\n\nexport async function updateLegalBrief(\n  briefId: number,\n  data: { content?: string; title?: string; status?: string }\n): Promise<LegalBrief> {\n  const res = await fetch(`${API_BASE}/briefs/${briefId}`, {\n    method: \"PUT\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(data),\n  });\n  if (!res.ok) throw new Error(\"Failed to update legal brief\");\n  return res.json();\n}\n\nexport async function deleteLegalBrief(briefId: number): Promise<void> {\n  const res = await fetch(`${API_BASE}/briefs/${briefId}`, {\n    method: \"DELETE\",\n  });\n  if (!res.ok) throw new Error(\"Failed to delete legal brief\");\n}\n\n// AI Chat Conversations\nexport interface Conversation {\n  id: number;\n  caseId: number | null;\n  title: string;\n  createdAt: string;\n}\n\nexport interface Message {\n  id: number;\n  conversationId: number;\n  role: string;\n  content: string;\n  createdAt: string;\n}\n\nexport async function getConversations(): Promise<Conversation[]> {\n  const res = await fetch(`${API_BASE}/conversations`);\n  if (!res.ok) throw new Error(\"Failed to fetch conversations\");\n  return res.json();\n}\n\nexport async function getConversation(id: number): Promise<Conversation & { messages: Message[] }> {\n  const res = await fetch(`${API_BASE}/conversations/${id}`);\n  if (!res.ok) throw new Error(\"Failed to fetch conversation\");\n  return res.json();\n}\n\nexport async function createConversation(title: string, caseId?: number): Promise<Conversation> {\n  const res = await fetch(`${API_BASE}/conversations`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ title, caseId }),\n  });\n  if (!res.ok) throw new Error(\"Failed to create conversation\");\n  return res.json();\n}\n\nexport async function deleteConversation(id: number): Promise<void> {\n  const res = await fetch(`${API_BASE}/conversations/${id}`, {\n    method: \"DELETE\",\n  });\n  if (!res.ok) throw new Error(\"Failed to delete conversation\");\n}\n\nexport async function sendChatMessage(\n  conversationId: number, \n  content: string,\n  onChunk: (text: string) => void\n): Promise<void> {\n  const res = await fetch(`${API_BASE}/conversations/${conversationId}/messages`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ content }),\n  });\n\n  if (!res.ok) throw new Error(\"Failed to send message\");\n\n  const reader = res.body?.getReader();\n  if (!reader) throw new Error(\"No response body\");\n\n  const decoder = new TextDecoder();\n  while (true) {\n    const { done, value } = await reader.read();\n    if (done) break;\n\n    const chunk = decoder.decode(value);\n    const lines = chunk.split('\\n');\n    for (const line of lines) {\n      if (line.startsWith('data: ')) {\n        try {\n          const data = JSON.parse(line.slice(6));\n          if (data.content) {\n            onChunk(data.content);\n          }\n        } catch {}\n      }\n    }\n  }\n}\n\n// Case Management\nexport async function updateCase(\n  id: string,\n  data: { title?: string; description?: string; status?: string; nextDeadline?: string | null }\n): Promise<Case> {\n  const res = await fetch(`${API_BASE}/cases/${id}`, {\n    method: \"PUT\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(data),\n  });\n  if (!res.ok) throw new Error(\"Failed to update case\");\n  return res.json();\n}\n\nexport async function deleteCase(id: string): Promise<void> {\n  const res = await fetch(`${API_BASE}/cases/${id}`, {\n    method: \"DELETE\",\n  });\n  if (!res.ok) throw new Error(\"Failed to delete case\");\n}\n\n// Export Case Data\nexport async function exportCaseData(caseId: string): Promise<Blob> {\n  const res = await fetch(`${API_BASE}/cases/${caseId}/export`);\n  if (!res.ok) throw new Error(\"Failed to export case data\");\n  return res.blob();\n}\n","path":null,"size_bytes":11367,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"import * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload\n            .filter((item) => item.type !== \"none\")\n            .map((item, index) => {\n              const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n              const itemConfig = getPayloadConfigFromPayload(config, item, key)\n              const indicatorColor = color || item.payload.fill || item.color\n\n              return (\n                <div\n                  key={item.dataKey}\n                  className={cn(\n                    \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                    indicator === \"dot\" && \"items-center\"\n                  )}\n                >\n                  {formatter && item?.value !== undefined && item.name ? (\n                    formatter(item.value, item.name, item, index, item.payload)\n                  ) : (\n                    <>\n                      {itemConfig?.icon ? (\n                        <itemConfig.icon />\n                      ) : (\n                        !hideIndicator && (\n                          <div\n                            className={cn(\n                              \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                              {\n                                \"h-2.5 w-2.5\": indicator === \"dot\",\n                                \"w-1\": indicator === \"line\",\n                                \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                  indicator === \"dashed\",\n                                \"my-0.5\": nestLabel && indicator === \"dashed\",\n                              }\n                            )}\n                            style={\n                              {\n                                \"--color-bg\": indicatorColor,\n                                \"--color-border\": indicatorColor,\n                              } as React.CSSProperties\n                            }\n                          />\n                        )\n                      )}\n                      <div\n                        className={cn(\n                          \"flex flex-1 justify-between leading-none\",\n                          nestLabel ? \"items-end\" : \"items-center\"\n                        )}\n                      >\n                        <div className=\"grid gap-1.5\">\n                          {nestLabel ? tooltipLabel : null}\n                          <span className=\"text-muted-foreground\">\n                            {itemConfig?.label || item.name}\n                          </span>\n                        </div>\n                        {item.value && (\n                          <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                            {item.value.toLocaleString()}\n                          </span>\n                        )}\n                      </div>\n                    </>\n                  )}\n                </div>\n              )\n            })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload\n          .filter((item) => item.type !== \"none\")\n          .map((item) => {\n            const key = `${nameKey || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n            return (\n              <div\n                key={item.value}\n                className={cn(\n                  \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n                )}\n              >\n                {itemConfig?.icon && !hideIcon ? (\n                  <itemConfig.icon />\n                ) : (\n                  <div\n                    className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                    style={{\n                      backgroundColor: item.color,\n                    }}\n                  />\n                )}\n                {itemConfig?.label}\n              </div>\n            )\n          })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10763,"size_tokens":null},"client/src/components/ui/spinner.tsx":{"content":"import { Loader2Icon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Spinner({ className, ...props }: React.ComponentProps<\"svg\">) {\n  return (\n    <Loader2Icon\n      role=\"status\"\n      aria-label=\"Loading\"\n      className={cn(\"size-4 animate-spin\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Spinner }\n","path":null,"size_bytes":331,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1267,"size_tokens":null},"client/src/hooks/use-save-status.tsx":{"content":"import { createContext, useContext, useState, useCallback, ReactNode } from \"react\";\n\ntype SaveStatus = \"saved\" | \"saving\" | \"error\";\n\ninterface SaveStatusContextType {\n  status: SaveStatus;\n  lastSaved: Date | null;\n  setSaving: () => void;\n  setSaved: () => void;\n  setError: () => void;\n}\n\nconst SaveStatusContext = createContext<SaveStatusContextType | undefined>(undefined);\n\nexport function SaveStatusProvider({ children }: { children: ReactNode }) {\n  const [status, setStatus] = useState<SaveStatus>(\"saved\");\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\n\n  const setSaving = useCallback(() => {\n    setStatus(\"saving\");\n  }, []);\n\n  const setSaved = useCallback(() => {\n    setStatus(\"saved\");\n    setLastSaved(new Date());\n  }, []);\n\n  const setError = useCallback(() => {\n    setStatus(\"error\");\n  }, []);\n\n  return (\n    <SaveStatusContext.Provider value={{ status, lastSaved, setSaving, setSaved, setError }}>\n      {children}\n    </SaveStatusContext.Provider>\n  );\n}\n\nexport function useSaveStatus() {\n  const context = useContext(SaveStatusContext);\n  if (!context) {\n    throw new Error(\"useSaveStatus must be used within SaveStatusProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":1204,"size_tokens":null},"server/services/aiAssistant.ts":{"content":"import { GoogleGenAI } from \"@google/genai\";\nimport { storage } from \"../storage\";\n\nconst ai = new GoogleGenAI({\n  apiKey: process.env.AI_INTEGRATIONS_GEMINI_API_KEY!,\n  httpOptions: {\n    apiVersion: \"\",\n    baseUrl: process.env.AI_INTEGRATIONS_GEMINI_BASE_URL!,\n  },\n});\n\n/**\n * Generate deposition questions based on case evidence\n */\nexport async function generateDepositionQuestions(\n  caseId: number,\n  witnessName: string,\n  depositionType: \"direct\" | \"cross\"\n): Promise<{\n  questions: Array<{ question: string; purpose: string; linkedBates: string[] }>;\n  strategy: string;\n}> {\n  // Get all discovery files for context\n  const files = await storage.getDiscoveryFilesByCase(caseId);\n  const timeline = await storage.getTimelineEventsByCase(caseId);\n\n  const context = `\nCase Evidence Summary:\n${files.slice(0, 10).map(f => `- ${f.batesStart}: ${f.summary || f.fileName}`).join(\"\\n\")}\n\nTimeline:\n${timeline.slice(0, 5).map(e => `- ${e.eventDate}: ${e.title}`).join(\"\\n\")}\n`;\n\n  const prompt = `You are an expert trial attorney. Generate strategic ${depositionType} examination questions for ${witnessName}.\n\n${context}\n\nProvide:\n1. 8-12 strategic questions designed to ${depositionType === \"direct\" ? \"establish facts and credibility\" : \"expose inconsistencies and weaken testimony\"}\n2. For each question, explain its strategic purpose\n3. Link to relevant Bates numbers when applicable\n4. Overall examination strategy\n\nRespond in JSON:\n{\n  \"strategy\": \"Overall approach...\",\n  \"questions\": [\n    {\n      \"question\": \"...\",\n      \"purpose\": \"...\",\n      \"linkedBates\": [\"BATES-001\"]\n    }\n  ]\n}`;\n\n  const response = await ai.models.generateContent({\n    model: \"gemini-2.5-pro\",\n    contents: [{ role: \"user\", parts: [{ text: prompt }] }],\n  });\n\n  const resultText = response.text || \"{}\";\n  const jsonMatch = resultText.match(/\\{[\\s\\S]*\\}/);\n  const result = jsonMatch ? JSON.parse(jsonMatch[0]) : { questions: [], strategy: \"\" };\n\n  return result;\n}\n\n/**\n * Generate timeline from all case documents\n */\nexport async function generateTimelineFromDocuments(caseId: number): Promise<\n  Array<{\n    eventDate: string;\n    title: string;\n    description: string;\n    eventType: string;\n    linkedBates: string[];\n  }>\n> {\n  const files = await storage.getDiscoveryFilesByCase(caseId);\n\n  const evidenceSummary = files\n    .map(f => `${f.batesStart}: ${f.summary || f.fileName} (${f.extractedDates ? JSON.stringify(f.extractedDates) : \"no dates\"})`)\n    .join(\"\\n\");\n\n  const prompt = `Based on this evidence, create a chronological timeline of key events in the case.\n\nEvidence:\n${evidenceSummary}\n\nExtract and organize ALL significant dates and events. Respond in JSON:\n{\n  \"events\": [\n    {\n      \"eventDate\": \"YYYY-MM-DD\",\n      \"title\": \"Brief title\",\n      \"description\": \"What happened\",\n      \"eventType\": \"evidence|court|meeting|communication\",\n      \"linkedBates\": [\"BATES-001\"]\n    }\n  ]\n}`;\n\n  const response = await ai.models.generateContent({\n    model: \"gemini-2.5-pro\",\n    contents: [{ role: \"user\", parts: [{ text: prompt }] }],\n  });\n\n  const resultText = response.text || \"{}\";\n  const jsonMatch = resultText.match(/\\{[\\s\\S]*\\}/);\n  const result = jsonMatch ? JSON.parse(jsonMatch[0]) : { events: [] };\n\n  return result.events || [];\n}\n\n/**\n * Suggest next legal filings based on case state\n */\nexport async function suggestNextFilings(caseId: number): Promise<\n  Array<{\n    filingType: string;\n    title: string;\n    description: string;\n    deadline: string | null;\n    priority: \"high\" | \"medium\" | \"low\";\n    reasoning: string;\n  }>\n> {\n  const caseData = await storage.getCase(caseId);\n  const files = await storage.getDiscoveryFilesByCase(caseId);\n  const timeline = await storage.getTimelineEventsByCase(caseId);\n\n  const prompt = `You are a legal strategist. Based on this case state, suggest the next 3-5 strategic filings/motions.\n\nCase: ${caseData?.title}\nStatus: ${caseData?.status}\nEvidence count: ${files.length}\nNext deadline: ${caseData?.nextDeadline}\n\nRecent timeline:\n${timeline.slice(0, 5).map(e => `- ${e.eventDate}: ${e.title}`).join(\"\\n\")}\n\nSuggest filings in JSON:\n{\n  \"filings\": [\n    {\n      \"filingType\": \"Motion to...|Discovery Request|...\",\n      \"title\": \"...\",\n      \"description\": \"What this achieves\",\n      \"deadline\": \"YYYY-MM-DD or null\",\n      \"priority\": \"high|medium|low\",\n      \"reasoning\": \"Why file this now\"\n    }\n  ]\n}`;\n\n  const response = await ai.models.generateContent({\n    model: \"gemini-2.5-pro\",\n    contents: [{ role: \"user\", parts: [{ text: prompt }] }],\n  });\n\n  const resultText = response.text || \"{}\";\n  const jsonMatch = resultText.match(/\\{[\\s\\S]*\\}/);\n  const result = jsonMatch ? JSON.parse(jsonMatch[0]) : { filings: [] };\n\n  return result.filings || [];\n}\n","path":null,"size_bytes":4745,"size_tokens":null},"client/src/components/ui/input-group.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Textarea } from \"@/components/ui/textarea\"\n\nfunction InputGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"input-group\"\n      role=\"group\"\n      className={cn(\n        \"group/input-group border-input dark:bg-input/30 shadow-xs relative flex w-full items-center rounded-md border outline-none transition-[color,box-shadow]\",\n        \"h-9 has-[>textarea]:h-auto\",\n\n        // Variants based on alignment.\n        \"has-[>[data-align=inline-start]]:[&>input]:pl-2\",\n        \"has-[>[data-align=inline-end]]:[&>input]:pr-2\",\n        \"has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3\",\n        \"has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3\",\n\n        // Focus state.\n        \"has-[[data-slot=input-group-control]:focus-visible]:ring-ring has-[[data-slot=input-group-control]:focus-visible]:ring-1\",\n\n        // Error state.\n        \"has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40\",\n\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupAddonVariants = cva(\n  \"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4\",\n  {\n    variants: {\n      align: {\n        \"inline-start\":\n          \"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]\",\n        \"inline-end\":\n          \"order-last pr-3 has-[>button]:mr-[-0.4rem] has-[>kbd]:mr-[-0.35rem]\",\n        \"block-start\":\n          \"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5\",\n        \"block-end\":\n          \"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5\",\n      },\n    },\n    defaultVariants: {\n      align: \"inline-start\",\n    },\n  }\n)\n\nfunction InputGroupAddon({\n  className,\n  align = \"inline-start\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof inputGroupAddonVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"input-group-addon\"\n      data-align={align}\n      className={cn(inputGroupAddonVariants({ align }), className)}\n      onClick={(e) => {\n        if ((e.target as HTMLElement).closest(\"button\")) {\n          return\n        }\n        e.currentTarget.parentElement?.querySelector(\"input\")?.focus()\n      }}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupButtonVariants = cva(\n  \"flex items-center gap-2 text-sm shadow-none\",\n  {\n    variants: {\n      size: {\n        xs: \"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5\",\n        sm: \"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5\",\n        \"icon-xs\":\n          \"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0\",\n        \"icon-sm\": \"size-8 p-0 has-[>svg]:p-0\",\n      },\n    },\n    defaultVariants: {\n      size: \"xs\",\n    },\n  }\n)\n\nfunction InputGroupButton({\n  className,\n  type = \"button\",\n  variant = \"ghost\",\n  size = \"xs\",\n  ...props\n}: Omit<React.ComponentProps<typeof Button>, \"size\"> &\n  VariantProps<typeof inputGroupButtonVariants>) {\n  return (\n    <Button\n      type={type}\n      data-size={size}\n      variant={variant}\n      className={cn(inputGroupButtonVariants({ size }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupText({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      className={cn(\n        \"text-muted-foreground flex items-center gap-2 text-sm [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupInput({\n  className,\n  ...props\n}: React.ComponentProps<\"input\">) {\n  return (\n    <Input\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupTextarea({\n  className,\n  ...props\n}: React.ComponentProps<\"textarea\">) {\n  return (\n    <Textarea\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupText,\n  InputGroupInput,\n  InputGroupTextarea,\n}\n","path":null,"size_bytes":4971,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n\" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n           // @replit: no hover, and add primary border\n           \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm border-destructive-border\",\n        outline:\n          // @replit Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color. Uses shadow-xs. no shadow on active\n          // No hover state\n          \" border [border-color:var(--button-outline)] shadow-xs active:shadow-none \",\n        secondary:\n          // @replit border, no hover, no shadow, secondary border.\n          \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // @replit no hover, transparent border\n        ghost: \"border border-transparent\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        // @replit changed sizes\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2356,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"shared/models/chat.ts":{"content":"import { pgTable, serial, integer, text, timestamp } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { sql } from \"drizzle-orm\";\n\nexport const conversations = pgTable(\"conversations\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\nexport const messages = pgTable(\"messages\", {\n  id: serial(\"id\").primaryKey(),\n  conversationId: integer(\"conversation_id\").notNull().references(() => conversations.id, { onDelete: \"cascade\" }),\n  role: text(\"role\").notNull(),\n  content: text(\"content\").notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\nexport const insertConversationSchema = createInsertSchema(conversations).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertMessageSchema = createInsertSchema(messages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type Conversation = typeof conversations.$inferSelect;\nexport type InsertConversation = z.infer<typeof insertConversationSchema>;\nexport type Message = typeof messages.$inferSelect;\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\n\n","path":null,"size_bytes":1229,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"replit.md":{"content":"# CaseBuddy - AI Legal Case Management Platform\n\n## Overview\n\nCaseBuddy is an AI-powered legal case management and discovery organization platform built for attorneys and legal professionals. The application enables lawyers to manage cases, upload and process legal documents (PDFs, media, images), generate AI-assisted timelines, prepare deposition questions, and generate legal briefs. It integrates with Google Drive for cloud document syncing and uses Google's Gemini AI for document analysis, summarization, and legal assistance.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: React 18 with TypeScript\n- **Routing**: Wouter (lightweight client-side router)\n- **State Management**: TanStack React Query for server state management\n- **UI Components**: shadcn/ui component library built on Radix UI primitives\n- **Styling**: Tailwind CSS v4 with custom CSS variables for theming\n- **Build Tool**: Vite with custom plugins for Replit integration\n\nThe frontend follows a component-based architecture with:\n- Pages in `client/src/pages/` (dashboard, case-view, not-found)\n- Reusable UI components in `client/src/components/ui/`\n- Custom hooks in `client/src/hooks/`\n- API client functions in `client/src/lib/api.ts`\n\n### Backend Architecture\n- **Runtime**: Node.js with Express\n- **Language**: TypeScript with ESM modules\n- **API Design**: RESTful JSON APIs under `/api/*` prefix\n- **File Uploads**: Multer middleware with 100MB file size limit\n- **Database ORM**: Drizzle ORM with PostgreSQL\n\nThe backend is organized as:\n- `server/index.ts` - Express app setup and middleware\n- `server/routes.ts` - All API route definitions\n- `server/storage.ts` - Database abstraction layer (IStorage interface)\n- `server/services/` - Business logic services (AI, document processing, etc.)\n- `server/replit_integrations/` - Replit-specific AI integration modules\n\n### Data Storage\n- **Primary Database**: PostgreSQL via Drizzle ORM\n- **Schema Location**: `shared/schema.ts` (shared between frontend/backend)\n- **Migrations**: Drizzle Kit (`drizzle-kit push`)\n\nKey database tables:\n- `users` - User accounts\n- `cases` - Legal cases with metadata\n- `discoveryFiles` - Uploaded documents with Bates numbering, summaries, extracted text\n- `timelineEvents` - Case timeline entries\n- `depositionPrep` - AI-generated deposition questions\n- `suggestedFilings` - AI-suggested next legal filings\n- `cloudFolders` - Google Drive folder sync configuration\n- `legalBriefs` - Generated legal documents\n- `conversations` / `messages` - AI chat history\n\n### AI Integration\nThe application uses Google's Gemini AI through Replit AI Integrations:\n- **Document Processing**: OCR, summarization, relevance scoring, tag extraction\n- **Deposition Prep**: Generate strategic examination questions\n- **Timeline Generation**: Extract dates and events from documents\n- **Brief Generation**: Draft legal documents based on case facts\n- **Chat Interface**: General legal AI assistant\n\nAI configuration uses environment variables:\n- `AI_INTEGRATIONS_GEMINI_API_KEY`\n- `AI_INTEGRATIONS_GEMINI_BASE_URL`\n\nSupported models: `gemini-2.5-flash`, `gemini-2.5-pro`, `gemini-2.5-flash-image`\n\n### Authentication\nCurrently no authentication is implemented. The storage interface includes user methods but they are not actively used for session management.\n\n## Recent Changes (December 2025)\n\n### Case Management Features\n- **New Case Intake Modal**: Dashboard now has a \"New Case\" button that opens a modal form with fields for title, case number, client name, and description. Uses `caseIntakeSchema` for validation.\n- **Delete Case**: Cases can be deleted from the case view header with a confirmation dialog to prevent accidental deletions.\n- **Export Case**: Export button downloads complete case data as JSON including all discovery files, timeline events, briefs, and conversations.\n\n### AI Chat Interface\n- **AI Tab in Case View**: Fully functional AI chat interface in the case view with:\n  - Conversation management (create, list, delete conversations)\n  - Message history with streaming responses from Gemini AI\n  - Case-specific context for legal assistance\n  - Suggested prompts for common legal tasks\n- **Chat Routes**: `/api/conversations` endpoints for CRUD operations on conversations and messages\n\n### Key Components\n- `client/src/components/ai-chat.tsx` - AI chat interface component\n- `client/src/pages/dashboard.tsx` - Dashboard with New Case modal\n- `client/src/pages/case-view.tsx` - Case view with export/delete functionality\n- `client/src/pages/my-cases.tsx` - Full case list with search, filter, create, delete\n- `client/src/pages/calendar.tsx` - Calendar view with deadlines and quick stats\n- `client/src/pages/research.tsx` - Legal research with database links and news\n- `client/src/pages/settings.tsx` - User settings (profile, notifications, appearance, integrations)\n- `server/replit_integrations/chat/routes.ts` - AI conversation API routes\n\n### Navigation Routes\n- `/` - Dashboard (overview with quick stats and recent cases)\n- `/cases` - My Cases (full case list management)\n- `/calendar` - Calendar (deadline tracking and events)\n- `/research` - Legal Research (database links and legal news)\n- `/settings` - Settings (user preferences and integrations)\n- `/case/:id` - Case View (detailed case management with tabs)\n\n## External Dependencies\n\n### Database\n- **PostgreSQL**: Primary data store (connection via `DATABASE_URL` environment variable)\n- **Drizzle ORM**: Type-safe database queries and schema management\n\n### AI Services\n- **Google Gemini AI**: Document analysis, legal assistance, image generation (via Replit AI Integrations proxy)\n\n### Cloud Storage\n- **Google Drive API**: Document syncing and cloud folder management (via Replit Connectors)\n\n### Video Conferencing\n- **Daily.co**: Real-time video conferencing for case collaboration\n- Configuration: `DAILY_API_KEY` environment variable\n- Features: Video/audio calls, screen sharing, chat, 2-hour room expiry\n- Rooms are created dynamically per case and cleaned up when all participants leave\n\n### Third-Party Libraries\n- **pdf-parse**: PDF text extraction\n- **rss-parser**: News feed aggregation from legal news sources\n- **googleapis**: Google Drive integration\n- **multer**: File upload handling\n\n### Development Tools\n- **Vite**: Frontend build and dev server\n- **esbuild**: Server bundling for production\n- **TypeScript**: Type checking across the entire codebase","path":null,"size_bytes":6520,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/item.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction ItemGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      role=\"list\"\n      data-slot=\"item-group\"\n      className={cn(\"group/item-group flex flex-col\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"item-separator\"\n      orientation=\"horizontal\"\n      className={cn(\"my-0\", className)}\n      {...props}\n    />\n  )\n}\n\nconst itemVariants = cva(\n  \"group/item [a]:hover:bg-accent/50 focus-visible:border-ring focus-visible:ring-ring/50 [a]:transition-colors flex flex-wrap items-center rounded-md border border-transparent text-sm outline-none transition-colors duration-100 focus-visible:ring-[3px]\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline: \"border-border\",\n        muted: \"bg-muted/50\",\n      },\n      size: {\n        default: \"gap-4 p-4 \",\n        sm: \"gap-2.5 px-4 py-3\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Item({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> &\n  VariantProps<typeof itemVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n  return (\n    <Comp\n      data-slot=\"item\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(itemVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nconst itemMediaVariants = cva(\n  \"flex shrink-0 items-center justify-center gap-2 group-has-[[data-slot=item-description]]/item:translate-y-0.5 group-has-[[data-slot=item-description]]/item:self-start [&_svg]:pointer-events-none\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted size-8 rounded-sm border [&_svg:not([class*='size-'])]:size-4\",\n        image:\n          \"size-10 overflow-hidden rounded-sm [&_img]:size-full [&_img]:object-cover\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction ItemMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof itemMediaVariants>) {\n  return (\n    <div\n      data-slot=\"item-media\"\n      data-variant={variant}\n      className={cn(itemMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction ItemContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-content\"\n      className={cn(\n        \"flex flex-1 flex-col gap-1 [&+[data-slot=item-content]]:flex-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-title\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"item-description\"\n      className={cn(\n        \"text-muted-foreground line-clamp-2 text-balance text-sm font-normal leading-normal\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemActions({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-actions\"\n      className={cn(\"flex items-center gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-header\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-footer\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Item,\n  ItemMedia,\n  ItemContent,\n  ItemActions,\n  ItemGroup,\n  ItemSeparator,\n  ItemTitle,\n  ItemDescription,\n  ItemHeader,\n  ItemFooter,\n}\n","path":null,"size_bytes":4494,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4887,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":724,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/featured-news.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { getFeaturedNews } from \"@/lib/api\";\nimport { ExternalLink } from \"lucide-react\";\n\ninterface FeaturedNewsProps {\n  variant?: \"sidebar\" | \"inline\";\n  limit?: number;\n}\n\nexport function FeaturedNews({ variant = \"sidebar\", limit = 1 }: FeaturedNewsProps) {\n  const { data: articles = [] } = useQuery({\n    queryKey: [\"news\", \"featured\"],\n    queryFn: () => getFeaturedNews(2),\n    refetchInterval: 5 * 60 * 1000,\n  });\n\n  const displayArticles = articles.slice(0, limit);\n\n  if (displayArticles.length === 0) return null;\n\n  if (variant === \"inline\") {\n    return (\n      <div className=\"mt-6 pt-6 border-t border-border/50\">\n        <div className=\"text-xs uppercase tracking-wider text-muted-foreground/70 mb-3\">Related Reading</div>\n        {displayArticles.map((article) => (\n          <a\n            key={article.id}\n            href={article.url}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"group flex items-start gap-3 p-3 rounded-lg bg-muted/20 hover:bg-muted/40 transition-colors\"\n            data-testid={`featured-news-${article.id}`}\n          >\n            <div className=\"flex-1 min-w-0\">\n              <h4 className=\"text-sm font-medium line-clamp-2 group-hover:text-primary transition-colors\">\n                {article.title}\n              </h4>\n              {article.summary && (\n                <p className=\"text-xs text-muted-foreground line-clamp-2 mt-1\">\n                  {article.summary}\n                </p>\n              )}\n            </div>\n            <ExternalLink className=\"w-3 h-3 text-muted-foreground flex-shrink-0 mt-1\" />\n          </a>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-muted/30 border border-border/50 rounded-lg p-4\">\n      <div className=\"text-xs uppercase tracking-wider text-muted-foreground/70 mb-3\">From WTP News</div>\n      <div className=\"space-y-3\">\n        {displayArticles.map((article) => (\n          <a\n            key={article.id}\n            href={article.url}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"group block\"\n            data-testid={`featured-news-sidebar-${article.id}`}\n          >\n            <h4 className=\"text-sm font-medium line-clamp-2 group-hover:text-primary transition-colors\">\n              {article.title}\n            </h4>\n            <div className=\"flex items-center gap-1 mt-1 text-xs text-muted-foreground\">\n              <span>{article.publishedAt ? new Date(article.publishedAt).toLocaleDateString() : 'We The People News'}</span>\n              <ExternalLink className=\"w-2.5 h-2.5\" />\n            </div>\n          </a>\n        ))}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2731,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport {\n  ChevronDownIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n} from \"lucide-react\"\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button, buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  captionLayout = \"label\",\n  buttonVariant = \"ghost\",\n  formatters,\n  components,\n  ...props\n}: React.ComponentProps<typeof DayPicker> & {\n  buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\n}) {\n  const defaultClassNames = getDefaultClassNames()\n\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\n        \"bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\n        String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\n        String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\n        className\n      )}\n      captionLayout={captionLayout}\n      formatters={{\n        formatMonthDropdown: (date) =>\n          date.toLocaleString(\"default\", { month: \"short\" }),\n        ...formatters,\n      }}\n      classNames={{\n        root: cn(\"w-fit\", defaultClassNames.root),\n        months: cn(\n          \"relative flex flex-col gap-4 md:flex-row\",\n          defaultClassNames.months\n        ),\n        month: cn(\"flex w-full flex-col gap-4\", defaultClassNames.month),\n        nav: cn(\n          \"absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1\",\n          defaultClassNames.nav\n        ),\n        button_previous: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_previous\n        ),\n        button_next: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_next\n        ),\n        month_caption: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]\",\n          defaultClassNames.month_caption\n        ),\n        dropdowns: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium\",\n          defaultClassNames.dropdowns\n        ),\n        dropdown_root: cn(\n          \"has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border\",\n          defaultClassNames.dropdown_root\n        ),\n        dropdown: cn(\n          \"bg-popover absolute inset-0 opacity-0\",\n          defaultClassNames.dropdown\n        ),\n        caption_label: cn(\n          \"select-none font-medium\",\n          captionLayout === \"label\"\n            ? \"text-sm\"\n            : \"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5\",\n          defaultClassNames.caption_label\n        ),\n        table: \"w-full border-collapse\",\n        weekdays: cn(\"flex\", defaultClassNames.weekdays),\n        weekday: cn(\n          \"text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal\",\n          defaultClassNames.weekday\n        ),\n        week: cn(\"mt-2 flex w-full\", defaultClassNames.week),\n        week_number_header: cn(\n          \"w-[--cell-size] select-none\",\n          defaultClassNames.week_number_header\n        ),\n        week_number: cn(\n          \"text-muted-foreground select-none text-[0.8rem]\",\n          defaultClassNames.week_number\n        ),\n        day: cn(\n          \"group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md\",\n          defaultClassNames.day\n        ),\n        range_start: cn(\n          \"bg-accent rounded-l-md\",\n          defaultClassNames.range_start\n        ),\n        range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\n        range_end: cn(\"bg-accent rounded-r-md\", defaultClassNames.range_end),\n        today: cn(\n          \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\n          defaultClassNames.today\n        ),\n        outside: cn(\n          \"text-muted-foreground aria-selected:text-muted-foreground\",\n          defaultClassNames.outside\n        ),\n        disabled: cn(\n          \"text-muted-foreground opacity-50\",\n          defaultClassNames.disabled\n        ),\n        hidden: cn(\"invisible\", defaultClassNames.hidden),\n        ...classNames,\n      }}\n      components={{\n        Root: ({ className, rootRef, ...props }) => {\n          return (\n            <div\n              data-slot=\"calendar\"\n              ref={rootRef}\n              className={cn(className)}\n              {...props}\n            />\n          )\n        },\n        Chevron: ({ className, orientation, ...props }) => {\n          if (orientation === \"left\") {\n            return (\n              <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\n            )\n          }\n\n          if (orientation === \"right\") {\n            return (\n              <ChevronRightIcon\n                className={cn(\"size-4\", className)}\n                {...props}\n              />\n            )\n          }\n\n          return (\n            <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\n          )\n        },\n        DayButton: CalendarDayButton,\n        WeekNumber: ({ children, ...props }) => {\n          return (\n            <td {...props}>\n              <div className=\"flex size-[--cell-size] items-center justify-center text-center\">\n                {children}\n              </div>\n            </td>\n          )\n        },\n        ...components,\n      }}\n      {...props}\n    />\n  )\n}\n\nfunction CalendarDayButton({\n  className,\n  day,\n  modifiers,\n  ...props\n}: React.ComponentProps<typeof DayButton>) {\n  const defaultClassNames = getDefaultClassNames()\n\n  const ref = React.useRef<HTMLButtonElement>(null)\n  React.useEffect(() => {\n    if (modifiers.focused) ref.current?.focus()\n  }, [modifiers.focused])\n\n  return (\n    <Button\n      ref={ref}\n      variant=\"ghost\"\n      size=\"icon\"\n      data-day={day.date.toLocaleDateString()}\n      data-selected-single={\n        modifiers.selected &&\n        !modifiers.range_start &&\n        !modifiers.range_end &&\n        !modifiers.range_middle\n      }\n      data-range-start={modifiers.range_start}\n      data-range-end={modifiers.range_end}\n      data-range-middle={modifiers.range_middle}\n      className={cn(\n        \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70\",\n        defaultClassNames.day,\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Calendar, CalendarDayButton }\n","path":null,"size_bytes":7569,"size_tokens":null},"server/services/videoRooms.ts":{"content":"interface VideoRoom {\n  caseId: number;\n  roomName: string;\n  roomUrl: string;\n  createdAt: Date;\n  participants: Map<string, { name: string; joinedAt: Date }>;\n}\n\nconst activeRooms: Map<number, VideoRoom> = new Map();\nconst pendingRoomCreations: Map<number, Promise<VideoRoom>> = new Map();\n\nconst DAILY_API_KEY = process.env.DAILY_API_KEY;\nconst DAILY_API_URL = \"https://api.daily.co/v1\";\n\nasync function createDailyRoom(roomName: string): Promise<{ url: string; name: string }> {\n  if (!DAILY_API_KEY) {\n    throw new Error(\"DAILY_API_KEY is not configured. Please add your Daily.co API key to secrets.\");\n  }\n\n  // Sanitize room name - Daily.co only allows lowercase alphanumeric and hyphens\n  const sanitizedName = roomName.toLowerCase().replace(/[^a-z0-9-]/g, '-').substring(0, 40);\n\n  console.log(`[VideoRoom] Creating Daily.co room: ${sanitizedName}`);\n\n  const response = await fetch(`${DAILY_API_URL}/rooms`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": `Bearer ${DAILY_API_KEY}`,\n    },\n    body: JSON.stringify({\n      name: sanitizedName,\n      privacy: \"public\",\n      properties: {\n        exp: Math.floor(Date.now() / 1000) + 3600 * 2, // 2 hour expiry\n        enable_chat: true,\n        enable_screenshare: true,\n        enable_recording: false,\n        start_video_off: false,\n        start_audio_off: false,\n      },\n    }),\n  });\n\n  if (!response.ok) {\n    const errorText = await response.text();\n    console.error(`[VideoRoom] Daily.co API error (${response.status}):`, errorText);\n    \n    // If room already exists, try to get it\n    if (response.status === 400 && errorText.includes(\"already exists\")) {\n      const existingRoom = await getDailyRoom(sanitizedName);\n      if (existingRoom) {\n        console.log(`[VideoRoom] Using existing room: ${existingRoom.url}`);\n        return existingRoom;\n      }\n    }\n    \n    // Authentication error - API key is invalid\n    if (response.status === 401 || errorText.includes(\"authentication\")) {\n      throw new Error(\"Daily.co API key is invalid or expired. Please update your DAILY_API_KEY in secrets.\");\n    }\n    \n    throw new Error(`Failed to create Daily room: ${response.status}`);\n  }\n\n  const data = await response.json();\n  console.log(`[VideoRoom] Room created successfully: ${data.url}`);\n  return { url: data.url, name: data.name };\n}\n\nasync function getDailyRoom(roomName: string): Promise<{ url: string; name: string } | null> {\n  if (!DAILY_API_KEY) {\n    return null;\n  }\n\n  const response = await fetch(`${DAILY_API_URL}/rooms/${roomName}`, {\n    method: \"GET\",\n    headers: {\n      \"Authorization\": `Bearer ${DAILY_API_KEY}`,\n    },\n  });\n\n  if (!response.ok) {\n    return null;\n  }\n\n  const data = await response.json();\n  return { url: data.url, name: data.name };\n}\n\nasync function deleteDailyRoom(roomName: string): Promise<void> {\n  if (!DAILY_API_KEY) {\n    return;\n  }\n\n  try {\n    await fetch(`${DAILY_API_URL}/rooms/${roomName}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Authorization\": `Bearer ${DAILY_API_KEY}`,\n      },\n    });\n  } catch (error) {\n    console.error(\"Failed to delete Daily room:\", error);\n  }\n}\n\nasync function createRoomInternal(caseId: number): Promise<VideoRoom> {\n  // Generate a unique room name\n  const roomName = `casebuddy-${caseId}-${Date.now()}`;\n\n  // Create room on Daily.co\n  const dailyRoom = await createDailyRoom(roomName);\n\n  const room: VideoRoom = {\n    caseId,\n    roomName: dailyRoom.name,\n    roomUrl: dailyRoom.url,\n    createdAt: new Date(),\n    participants: new Map(),\n  };\n\n  activeRooms.set(caseId, room);\n  return room;\n}\n\nexport async function getOrCreateRoom(caseId: number): Promise<VideoRoom> {\n  // Check if we already have an active room for this case\n  if (activeRooms.has(caseId)) {\n    return activeRooms.get(caseId)!;\n  }\n\n  // Check if room creation is already in progress (handle concurrent requests)\n  if (pendingRoomCreations.has(caseId)) {\n    return pendingRoomCreations.get(caseId)!;\n  }\n\n  // Start room creation and store the promise\n  const creationPromise = createRoomInternal(caseId);\n  pendingRoomCreations.set(caseId, creationPromise);\n\n  try {\n    const room = await creationPromise;\n    return room;\n  } finally {\n    // Clean up pending promise after completion\n    pendingRoomCreations.delete(caseId);\n  }\n}\n\nexport function addParticipant(caseId: number, odId: string, odName: string): void {\n  const room = activeRooms.get(caseId);\n  if (room) {\n    room.participants.set(odId, { name: odName, joinedAt: new Date() });\n  }\n}\n\nexport async function removeParticipant(caseId: number, odId: string): Promise<void> {\n  const room = activeRooms.get(caseId);\n  if (room) {\n    room.participants.delete(odId);\n    // If no participants left, clean up the room\n    if (room.participants.size === 0) {\n      await deleteDailyRoom(room.roomName);\n      activeRooms.delete(caseId);\n    }\n  }\n}\n\nexport function getRoomParticipants(caseId: number): Array<{ id: string; name: string }> {\n  const room = activeRooms.get(caseId);\n  if (!room) return [];\n\n  return Array.from(room.participants.entries()).map(([id, data]) => ({\n    id,\n    name: data.name,\n  }));\n}\n","path":null,"size_bytes":5196,"size_tokens":null},"server/storage.ts":{"content":"import { \n  type User, \n  type InsertUser, \n  type Case,\n  type InsertCase,\n  type DiscoveryFile,\n  type InsertDiscoveryFile,\n  type TimelineEvent,\n  type InsertTimelineEvent,\n  type DepositionPrep,\n  type InsertDepositionPrep,\n  type SuggestedFiling,\n  type InsertSuggestedFiling,\n  type CloudFolder,\n  type InsertCloudFolder,\n  type LegalBrief,\n  type InsertLegalBrief,\n  users,\n  cases,\n  discoveryFiles,\n  timelineEvents,\n  depositionPrep,\n  suggestedFilings,\n  cloudFolders,\n  legalBriefs,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, and } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // Users\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  \n  // Cases\n  getCase(id: number): Promise<Case | undefined>;\n  getAllCases(): Promise<Case[]>;\n  createCase(data: InsertCase): Promise<Case>;\n  updateCase(id: number, data: Partial<InsertCase>): Promise<Case | undefined>;\n  deleteCase(id: number): Promise<void>;\n  \n  // Discovery Files\n  getDiscoveryFile(id: number): Promise<DiscoveryFile | undefined>;\n  getDiscoveryFilesByCase(caseId: number): Promise<DiscoveryFile[]>;\n  createDiscoveryFile(data: InsertDiscoveryFile): Promise<DiscoveryFile>;\n  updateDiscoveryFile(id: number, data: Partial<InsertDiscoveryFile>): Promise<DiscoveryFile | undefined>;\n  deleteDiscoveryFile(id: number): Promise<void>;\n  \n  // Timeline Events\n  getTimelineEventsByCase(caseId: number): Promise<TimelineEvent[]>;\n  createTimelineEvent(data: InsertTimelineEvent): Promise<TimelineEvent>;\n  deleteTimelineEvent(id: number): Promise<void>;\n  \n  // Deposition Prep\n  getDepositionPrepByCase(caseId: number): Promise<DepositionPrep[]>;\n  createDepositionPrep(data: InsertDepositionPrep): Promise<DepositionPrep>;\n  updateDepositionPrep(id: number, data: Partial<InsertDepositionPrep>): Promise<DepositionPrep | undefined>;\n  deleteDepositionPrep(id: number): Promise<void>;\n  \n  // Suggested Filings\n  getSuggestedFilingsByCase(caseId: number): Promise<SuggestedFiling[]>;\n  createSuggestedFiling(data: InsertSuggestedFiling): Promise<SuggestedFiling>;\n  updateSuggestedFiling(id: number, data: Partial<InsertSuggestedFiling>): Promise<SuggestedFiling | undefined>;\n  deleteSuggestedFiling(id: number): Promise<void>;\n  \n  // Cloud Folders\n  getCloudFoldersByCase(caseId: number): Promise<CloudFolder[]>;\n  getCloudFolder(id: number): Promise<CloudFolder | undefined>;\n  createCloudFolder(data: InsertCloudFolder): Promise<CloudFolder>;\n  updateCloudFolder(id: number, data: Partial<InsertCloudFolder>): Promise<CloudFolder | undefined>;\n  deleteCloudFolder(id: number): Promise<void>;\n  getDiscoveryFileByCloudId(cloudFileId: string): Promise<DiscoveryFile | undefined>;\n  \n  // Legal Briefs\n  getLegalBriefsByCase(caseId: number): Promise<LegalBrief[]>;\n  getLegalBrief(id: number): Promise<LegalBrief | undefined>;\n  createLegalBrief(data: InsertLegalBrief): Promise<LegalBrief>;\n  updateLegalBrief(id: number, data: Partial<InsertLegalBrief>): Promise<LegalBrief | undefined>;\n  deleteLegalBrief(id: number): Promise<void>;\n}\n\nclass DatabaseStorage implements IStorage {\n  // Users\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.username, username));\n    return user;\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(insertUser).returning();\n    return user;\n  }\n\n  // Cases\n  async getCase(id: number): Promise<Case | undefined> {\n    const [caseRecord] = await db.select().from(cases).where(eq(cases.id, id));\n    return caseRecord;\n  }\n\n  async getAllCases(): Promise<Case[]> {\n    return db.select().from(cases).orderBy(desc(cases.updatedAt));\n  }\n\n  async createCase(data: InsertCase): Promise<Case> {\n    const [caseRecord] = await db.insert(cases).values(data).returning();\n    return caseRecord;\n  }\n\n  async updateCase(id: number, data: Partial<InsertCase>): Promise<Case | undefined> {\n    const [updated] = await db\n      .update(cases)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(cases.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteCase(id: number): Promise<void> {\n    await db.delete(cases).where(eq(cases.id, id));\n  }\n\n  // Discovery Files\n  async getDiscoveryFile(id: number): Promise<DiscoveryFile | undefined> {\n    const [file] = await db.select().from(discoveryFiles).where(eq(discoveryFiles.id, id));\n    return file;\n  }\n\n  async getDiscoveryFilesByCase(caseId: number): Promise<DiscoveryFile[]> {\n    return db.select().from(discoveryFiles).where(eq(discoveryFiles.caseId, caseId)).orderBy(discoveryFiles.batesStart);\n  }\n\n  async createDiscoveryFile(data: InsertDiscoveryFile): Promise<DiscoveryFile> {\n    const [file] = await db.insert(discoveryFiles).values(data).returning();\n    return file;\n  }\n\n  async updateDiscoveryFile(id: number, data: Partial<InsertDiscoveryFile>): Promise<DiscoveryFile | undefined> {\n    const [updated] = await db\n      .update(discoveryFiles)\n      .set(data)\n      .where(eq(discoveryFiles.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteDiscoveryFile(id: number): Promise<void> {\n    await db.delete(discoveryFiles).where(eq(discoveryFiles.id, id));\n  }\n\n  // Timeline Events\n  async getTimelineEventsByCase(caseId: number): Promise<TimelineEvent[]> {\n    return db.select().from(timelineEvents).where(eq(timelineEvents.caseId, caseId)).orderBy(timelineEvents.eventDate);\n  }\n\n  async createTimelineEvent(data: InsertTimelineEvent): Promise<TimelineEvent> {\n    const [event] = await db.insert(timelineEvents).values(data).returning();\n    return event;\n  }\n\n  async deleteTimelineEvent(id: number): Promise<void> {\n    await db.delete(timelineEvents).where(eq(timelineEvents.id, id));\n  }\n\n  // Deposition Prep\n  async getDepositionPrepByCase(caseId: number): Promise<DepositionPrep[]> {\n    return db.select().from(depositionPrep).where(eq(depositionPrep.caseId, caseId)).orderBy(desc(depositionPrep.createdAt));\n  }\n\n  async createDepositionPrep(data: InsertDepositionPrep): Promise<DepositionPrep> {\n    const [prep] = await db.insert(depositionPrep).values(data).returning();\n    return prep;\n  }\n\n  async updateDepositionPrep(id: number, data: Partial<InsertDepositionPrep>): Promise<DepositionPrep | undefined> {\n    const [updated] = await db\n      .update(depositionPrep)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(depositionPrep.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteDepositionPrep(id: number): Promise<void> {\n    await db.delete(depositionPrep).where(eq(depositionPrep.id, id));\n  }\n\n  // Suggested Filings\n  async getSuggestedFilingsByCase(caseId: number): Promise<SuggestedFiling[]> {\n    return db.select().from(suggestedFilings).where(eq(suggestedFilings.caseId, caseId)).orderBy(desc(suggestedFilings.createdAt));\n  }\n\n  async createSuggestedFiling(data: InsertSuggestedFiling): Promise<SuggestedFiling> {\n    const [filing] = await db.insert(suggestedFilings).values(data).returning();\n    return filing;\n  }\n\n  async updateSuggestedFiling(id: number, data: Partial<InsertSuggestedFiling>): Promise<SuggestedFiling | undefined> {\n    const [updated] = await db\n      .update(suggestedFilings)\n      .set(data)\n      .where(eq(suggestedFilings.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteSuggestedFiling(id: number): Promise<void> {\n    await db.delete(suggestedFilings).where(eq(suggestedFilings.id, id));\n  }\n\n  // Cloud Folders\n  async getCloudFoldersByCase(caseId: number): Promise<CloudFolder[]> {\n    return db.select().from(cloudFolders).where(eq(cloudFolders.caseId, caseId)).orderBy(desc(cloudFolders.createdAt));\n  }\n\n  async getCloudFolder(id: number): Promise<CloudFolder | undefined> {\n    const [folder] = await db.select().from(cloudFolders).where(eq(cloudFolders.id, id));\n    return folder;\n  }\n\n  async createCloudFolder(data: InsertCloudFolder): Promise<CloudFolder> {\n    const [folder] = await db.insert(cloudFolders).values(data).returning();\n    return folder;\n  }\n\n  async updateCloudFolder(id: number, data: Partial<InsertCloudFolder>): Promise<CloudFolder | undefined> {\n    const [updated] = await db\n      .update(cloudFolders)\n      .set({ ...data, lastSynced: new Date() })\n      .where(eq(cloudFolders.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteCloudFolder(id: number): Promise<void> {\n    await db.delete(cloudFolders).where(eq(cloudFolders.id, id));\n  }\n\n  async getDiscoveryFileByCloudId(cloudFileId: string): Promise<DiscoveryFile | undefined> {\n    const [file] = await db.select().from(discoveryFiles).where(eq(discoveryFiles.cloudFileId, cloudFileId));\n    return file;\n  }\n\n  // Legal Briefs\n  async getLegalBriefsByCase(caseId: number): Promise<LegalBrief[]> {\n    return db.select().from(legalBriefs).where(eq(legalBriefs.caseId, caseId)).orderBy(desc(legalBriefs.createdAt));\n  }\n\n  async getLegalBrief(id: number): Promise<LegalBrief | undefined> {\n    const [brief] = await db.select().from(legalBriefs).where(eq(legalBriefs.id, id));\n    return brief;\n  }\n\n  async createLegalBrief(data: InsertLegalBrief): Promise<LegalBrief> {\n    const [brief] = await db.insert(legalBriefs).values(data).returning();\n    return brief;\n  }\n\n  async updateLegalBrief(id: number, data: Partial<InsertLegalBrief>): Promise<LegalBrief | undefined> {\n    const [updated] = await db\n      .update(legalBriefs)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(legalBriefs.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteLegalBrief(id: number): Promise<void> {\n    await db.delete(legalBriefs).where(eq(legalBriefs.id, id));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":10013,"size_tokens":null},"server/replit_integrations/chat/storage.ts":{"content":"import { db } from \"../../db\";\nimport { conversations, messages } from \"@shared/schema\";\nimport { eq, desc } from \"drizzle-orm\";\n\nexport interface IChatStorage {\n  getConversation(id: number): Promise<typeof conversations.$inferSelect | undefined>;\n  getAllConversations(): Promise<(typeof conversations.$inferSelect)[]>;\n  createConversation(title: string): Promise<typeof conversations.$inferSelect>;\n  deleteConversation(id: number): Promise<void>;\n  getMessagesByConversation(conversationId: number): Promise<(typeof messages.$inferSelect)[]>;\n  createMessage(conversationId: number, role: string, content: string): Promise<typeof messages.$inferSelect>;\n}\n\nexport const chatStorage: IChatStorage = {\n  async getConversation(id: number) {\n    const [conversation] = await db.select().from(conversations).where(eq(conversations.id, id));\n    return conversation;\n  },\n\n  async getAllConversations() {\n    return db.select().from(conversations).orderBy(desc(conversations.createdAt));\n  },\n\n  async createConversation(title: string) {\n    const [conversation] = await db.insert(conversations).values({ title }).returning();\n    return conversation;\n  },\n\n  async deleteConversation(id: number) {\n    await db.delete(messages).where(eq(messages.conversationId, id));\n    await db.delete(conversations).where(eq(conversations.id, id));\n  },\n\n  async getMessagesByConversation(conversationId: number) {\n    return db.select().from(messages).where(eq(messages.conversationId, conversationId)).orderBy(messages.createdAt);\n  },\n\n  async createMessage(conversationId: number, role: string, content: string) {\n    const [message] = await db.insert(messages).values({ conversationId, role, content }).returning();\n    return message;\n  },\n};\n\n","path":null,"size_bytes":1737,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"pg\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1417,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":266,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7406,"size_tokens":null},"server/replit_integrations/image/routes.ts":{"content":"import type { Express, Request, Response } from \"express\";\nimport { Modality } from \"@google/genai\";\nimport { ai } from \"./client\";\n\nexport function registerImageRoutes(app: Express): void {\n  app.post(\"/api/generate-image\", async (req: Request, res: Response) => {\n    try {\n      const { prompt } = req.body;\n\n      if (!prompt) {\n        return res.status(400).json({ error: \"Prompt is required\" });\n      }\n\n      const response = await ai.models.generateContent({\n        model: \"gemini-2.5-flash-image\",\n        contents: [{ role: \"user\", parts: [{ text: prompt }] }],\n        config: {\n          responseModalities: [Modality.TEXT, Modality.IMAGE],\n        },\n      });\n\n      const candidate = response.candidates?.[0];\n      const imagePart = candidate?.content?.parts?.find((part: any) => part.inlineData);\n\n      if (!imagePart?.inlineData?.data) {\n        return res.status(500).json({ error: \"No image data in response\" });\n      }\n\n      const mimeType = imagePart.inlineData.mimeType || \"image/png\";\n      res.json({\n        b64_json: imagePart.inlineData.data,\n        mimeType,\n      });\n    } catch (error) {\n      console.error(\"Error generating image:\", error);\n      res.status(500).json({ error: \"Failed to generate image\" });\n    }\n  });\n}\n\n","path":null,"size_bytes":1264,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3835,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2143,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":649,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","path":null,"size_bytes":1342,"size_tokens":null},"client/src/components/presence-indicator.tsx":{"content":"import { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Tooltip, TooltipContent, TooltipTrigger, TooltipProvider } from \"@/components/ui/tooltip\";\nimport { Users } from \"lucide-react\";\n\ninterface CollaboratorUser {\n  id: string;\n  name: string;\n  color: string;\n}\n\ninterface PresenceIndicatorProps {\n  collaborators: CollaboratorUser[];\n  isConnected: boolean;\n}\n\nexport function PresenceIndicator({ collaborators, isConnected }: PresenceIndicatorProps) {\n  if (!isConnected) {\n    return (\n      <div className=\"flex items-center gap-1.5 text-xs text-muted-foreground\">\n        <div className=\"w-2 h-2 rounded-full bg-yellow-500 animate-pulse\" />\n        <span className=\"hidden sm:inline\">Connecting...</span>\n      </div>\n    );\n  }\n\n  if (collaborators.length === 0) {\n    return (\n      <div className=\"flex items-center gap-1.5 text-xs text-muted-foreground\">\n        <div className=\"w-2 h-2 rounded-full bg-green-500\" />\n        <span className=\"hidden sm:inline\">Only you</span>\n      </div>\n    );\n  }\n\n  return (\n    <TooltipProvider>\n      <div className=\"flex items-center gap-2\">\n        <div className=\"w-2 h-2 rounded-full bg-green-500\" />\n        <div className=\"flex -space-x-2\">\n          {collaborators.slice(0, 3).map((user) => (\n            <Tooltip key={user.id}>\n              <TooltipTrigger asChild>\n                <Avatar className=\"w-7 h-7 border-2 border-background cursor-default\" data-testid={`collaborator-${user.id}`}>\n                  <AvatarFallback \n                    className=\"text-[10px] font-semibold text-white\"\n                    style={{ backgroundColor: user.color }}\n                  >\n                    {user.name.slice(0, 2).toUpperCase()}\n                  </AvatarFallback>\n                </Avatar>\n              </TooltipTrigger>\n              <TooltipContent side=\"bottom\" className=\"text-xs\">\n                {user.name} is viewing this case\n              </TooltipContent>\n            </Tooltip>\n          ))}\n          {collaborators.length > 3 && (\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Avatar className=\"w-7 h-7 border-2 border-background cursor-default\">\n                  <AvatarFallback className=\"text-[10px] font-semibold bg-muted text-muted-foreground\">\n                    +{collaborators.length - 3}\n                  </AvatarFallback>\n                </Avatar>\n              </TooltipTrigger>\n              <TooltipContent side=\"bottom\" className=\"text-xs\">\n                {collaborators.slice(3).map(u => u.name).join(\", \")} also viewing\n              </TooltipContent>\n            </Tooltip>\n          )}\n        </div>\n        <span className=\"text-xs text-muted-foreground hidden sm:inline\">\n          <Users className=\"w-3 h-3 inline mr-1\" />\n          {collaborators.length + 1} active\n        </span>\n      </div>\n    </TooltipProvider>\n  );\n}\n","path":null,"size_bytes":2883,"size_tokens":null},"server/replit_integrations/batch/index.ts":{"content":"export {\n  batchProcess,\n  batchProcessWithSSE,\n  isRateLimitError,\n  type BatchOptions,\n} from \"./utils\";\n\n","path":null,"size_bytes":108,"size_tokens":null},"client/src/components/ui/kbd.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Kbd({ className, ...props }: React.ComponentProps<\"kbd\">) {\n  return (\n    <kbd\n      data-slot=\"kbd\"\n      className={cn(\n        \"bg-muted text-muted-foreground pointer-events-none inline-flex h-5 w-fit min-w-5 select-none items-center justify-center gap-1 rounded-sm px-1 font-sans text-xs font-medium\",\n        \"[&_svg:not([class*='size-'])]:size-3\",\n        \"[[data-slot=tooltip-content]_&]:bg-background/20 [[data-slot=tooltip-content]_&]:text-background dark:[[data-slot=tooltip-content]_&]:bg-background/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction KbdGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <kbd\n      data-slot=\"kbd-group\"\n      className={cn(\"inline-flex items-center gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Kbd, KbdGroup }\n","path":null,"size_bytes":862,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"import * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8608,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":792,"size_tokens":null},"client/src/pages/dashboard.tsx":{"content":"import { Layout } from \"@/components/layout\";\nimport { Link, useLocation } from \"wouter\";\nimport { \n  Clock, \n  FileText, \n  AlertCircle, \n  ArrowRight,\n  TrendingUp,\n  Activity,\n  Newspaper,\n  ExternalLink,\n  Plus,\n  Loader2\n} from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { useEffect, useState } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { getCases, getLatestNews, createCase } from \"@/lib/api\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\n\nexport default function Dashboard() {\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  const { data: cases, isLoading } = useQuery({\n    queryKey: [\"cases\"],\n    queryFn: getCases,\n  });\n\n  const { data: news = [] } = useQuery({\n    queryKey: [\"news\", \"latest\"],\n    queryFn: () => getLatestNews(3),\n    refetchInterval: 5 * 60 * 1000,\n  });\n\n  useEffect(() => {\n    if (cases && cases.length > 0) {\n      const totalFiles = cases.reduce((acc, c) => acc + (c.filesCount || 0), 0);\n      if (totalFiles > 0) {\n        toast({\n          title: \"System Ready\",\n          description: `CaseBuddy AI has successfully indexed ${totalFiles.toLocaleString()} documents.`,\n        });\n      }\n    }\n  }, []);\n\n  const upcomingDeadlines = cases?.filter(c => c.nextDeadline && new Date(c.nextDeadline) > new Date()).length || 0;\n  const totalDocs = cases?.reduce((acc, c) => acc + (c.filesCount || 0), 0) || 0;\n\n  return (\n    <Layout>\n      <div className=\"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500\">\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4\">\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl font-serif font-bold text-primary mb-1 sm:mb-2\">Good Morning, Counselor.</h1>\n            <p className=\"text-sm sm:text-base text-muted-foreground\">Here is your case overview for today, {new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}.</p>\n          </div>\n          <NewCaseModal onSuccess={(caseId) => navigate(`/case/${caseId}`)} />\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <Card className=\"border-l-4 border-l-primary bg-card/50 backdrop-blur-sm hover:shadow-lg transition-all\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground uppercase tracking-wider\">Active Matters</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold font-serif text-primary\">{cases?.filter(c => c.status === 'active').length || 0}</div>\n              <div className=\"flex items-center gap-2 mt-2 text-xs text-green-600\">\n                <TrendingUp className=\"w-3 h-3\" />\n                <span>{cases?.length || 0} total cases</span>\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card className=\"border-l-4 border-l-accent bg-card/50 backdrop-blur-sm hover:shadow-lg transition-all\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground uppercase tracking-wider\">Upcoming Deadlines</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold font-serif text-primary\">{upcomingDeadlines}</div>\n              <div className=\"flex items-center gap-2 mt-2 text-xs text-orange-600\">\n                <AlertCircle className=\"w-3 h-3\" />\n                <span>Cases with deadlines set</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-l-4 border-l-slate-400 bg-card/50 backdrop-blur-sm hover:shadow-lg transition-all\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground uppercase tracking-wider\">Documents Processed</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold font-serif text-primary\">{totalDocs >= 1000 ? (totalDocs / 1000).toFixed(1) + 'k' : totalDocs}</div>\n              <div className=\"flex items-center gap-2 mt-2 text-xs text-muted-foreground\">\n                <Activity className=\"w-3 h-3\" />\n                <span>Total documents in system</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {news.length > 0 && (\n          <section>\n            <div className=\"flex items-center gap-2 mb-4\">\n              <Newspaper className=\"w-5 h-5 text-muted-foreground\" />\n              <h2 className=\"text-lg font-medium text-muted-foreground\">Legal News & Updates</h2>\n            </div>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              {news.map((article) => (\n                <a\n                  key={article.id}\n                  href={article.url}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"group bg-muted/30 border border-border/50 rounded-lg p-4 hover:bg-muted/50 hover:border-primary/20 transition-all\"\n                  data-testid={`news-article-${article.id}`}\n                >\n                  <div className=\"flex items-start justify-between gap-2 mb-2\">\n                    <h3 className=\"text-sm font-medium line-clamp-2 group-hover:text-primary transition-colors\">\n                      {article.title}\n                    </h3>\n                    <ExternalLink className=\"w-3 h-3 text-muted-foreground flex-shrink-0 mt-0.5\" />\n                  </div>\n                  {article.summary && (\n                    <p className=\"text-xs text-muted-foreground line-clamp-2 mb-2\">\n                      {article.summary}\n                    </p>\n                  )}\n                  <div className=\"text-xs text-muted-foreground/70\">\n                    {article.publishedAt ? new Date(article.publishedAt).toLocaleDateString() : 'We The People News'}\n                  </div>\n                </a>\n              ))}\n            </div>\n          </section>\n        )}\n\n        <section>\n          <div className=\"flex items-center justify-between mb-4\">\n            <h2 className=\"text-lg sm:text-xl font-bold font-serif text-primary\">Recent Activity</h2>\n            <Button variant=\"ghost\" size=\"sm\" className=\"text-sm text-primary\">\n              <span className=\"hidden sm:inline\">View All Cases</span>\n              <span className=\"sm:hidden\">View All</span>\n              <ArrowRight className=\"w-4 h-4 ml-1\" />\n            </Button>\n          </div>\n          \n          <div className=\"grid grid-cols-1 gap-3 sm:gap-4\">\n            {isLoading && <div className=\"text-center py-12 text-muted-foreground\">Loading cases...</div>}\n            {!isLoading && (!cases || cases.length === 0) && (\n              <div className=\"text-center py-12 border rounded-lg bg-muted/20\">\n                <FileText className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <p className=\"text-muted-foreground mb-4\">No cases yet. Create your first case to get started.</p>\n                <NewCaseModal onSuccess={(caseId) => navigate(`/case/${caseId}`)} />\n              </div>\n            )}\n            {cases && cases.slice(0, 5).map((c) => (\n              <Link key={c.id} href={`/case/${c.id}`}>\n                <div className=\"group bg-card border hover:border-accent/50 p-4 sm:p-6 rounded-xl shadow-sm hover:shadow-md transition-all cursor-pointer relative overflow-hidden\" data-testid={`case-card-${c.id}`}>\n                  <div className=\"absolute top-0 left-0 w-1 h-full bg-primary group-hover:bg-accent transition-colors\"></div>\n                  <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-3\">\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center gap-2 sm:gap-3 mb-1 flex-wrap\">\n                        <span className=\"text-xs font-mono text-muted-foreground bg-secondary px-2 py-0.5 rounded border border-border\">{c.caseNumber}</span>\n                        <h3 className=\"text-base sm:text-lg font-bold text-foreground group-hover:text-primary transition-colors truncate\">{c.title}</h3>\n                        {c.status === 'active' && (\n                          <span className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse flex-shrink-0\"></span>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mb-2 sm:mb-3 line-clamp-2\">{c.description || \"No description\"}</p>\n                      <div className=\"flex flex-wrap items-center gap-3 sm:gap-6 text-xs text-muted-foreground\">\n                        <span className=\"flex items-center gap-1.5\">\n                          <FileText className=\"w-3 h-3\" />\n                          {c.filesCount.toLocaleString()} Docs\n                        </span>\n                        <span className=\"flex items-center gap-1.5\">\n                          <Clock className=\"w-3 h-3\" />\n                          <span className=\"hidden sm:inline\">Last active:</span> {c.lastActivity ? new Date(c.lastActivity).toLocaleDateString() : 'Never'}\n                        </span>\n                      </div>\n                    </div>\n                    \n                    <div className=\"flex sm:flex-col items-center sm:items-end justify-between sm:justify-center pt-2 sm:pt-0 border-t sm:border-t-0 sm:text-right\">\n                      <div className=\"text-xs text-muted-foreground uppercase tracking-wide mb-0 sm:mb-1\">Next Deadline</div>\n                      <div className=\"text-sm font-medium text-destructive flex items-center gap-1 justify-end\">\n                        <CalendarIcon className=\"w-3 h-3\" />\n                        {c.nextDeadline ? new Date(c.nextDeadline).toLocaleDateString() : 'None set'}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </Link>\n            ))}\n          </div>\n        </section>\n      </div>\n    </Layout>\n  );\n}\n\nfunction NewCaseModal({ onSuccess }: { onSuccess?: (caseId: number) => void }) {\n  const [open, setOpen] = useState(false);\n  const [title, setTitle] = useState(\"\");\n  const [caseNumber, setCaseNumber] = useState(\"\");\n  const [client, setClient] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const createMutation = useMutation({\n    mutationFn: () => createCase({ title, caseNumber, client, description }),\n    onSuccess: (newCase) => {\n      queryClient.invalidateQueries({ queryKey: [\"cases\"] });\n      toast({\n        title: \"Case Created\",\n        description: `${newCase.title} has been created successfully.`,\n      });\n      setOpen(false);\n      setTitle(\"\");\n      setCaseNumber(\"\");\n      setClient(\"\");\n      setDescription(\"\");\n      onSuccess?.(newCase.id);\n    },\n    onError: () => {\n      toast({\n        title: \"Failed to Create Case\",\n        description: \"Please check your input and try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!title || !caseNumber || !client) {\n      toast({\n        title: \"Missing Required Fields\",\n        description: \"Please fill in case title, case number, and client name.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    createMutation.mutate();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button size=\"default\" className=\"w-full sm:w-auto bg-primary text-primary-foreground hover:bg-primary/90\" data-testid=\"button-new-case\">\n          <Plus className=\"w-4 h-4 mr-2\" /> New Case Intake\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-[95vw] sm:max-w-[500px]\">\n        <DialogHeader>\n          <DialogTitle className=\"font-serif text-xl\">New Case Intake</DialogTitle>\n          <DialogDescription>\n            Enter the case details to create a new matter in CaseBuddy.\n          </DialogDescription>\n        </DialogHeader>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <label className=\"text-sm font-medium mb-1 block\">Case Title *</label>\n            <Input\n              placeholder=\"e.g., Smith v. Johnson\"\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              required\n              data-testid=\"input-case-title\"\n            />\n          </div>\n          <div>\n            <label className=\"text-sm font-medium mb-1 block\">Case Number *</label>\n            <Input\n              placeholder=\"e.g., 2024-CV-12345\"\n              value={caseNumber}\n              onChange={(e) => setCaseNumber(e.target.value)}\n              required\n              data-testid=\"input-case-number\"\n            />\n          </div>\n          <div>\n            <label className=\"text-sm font-medium mb-1 block\">Client Name *</label>\n            <Input\n              placeholder=\"e.g., John Smith\"\n              value={client}\n              onChange={(e) => setClient(e.target.value)}\n              required\n              data-testid=\"input-client-name\"\n            />\n          </div>\n          <div>\n            <label className=\"text-sm font-medium mb-1 block\">Description</label>\n            <textarea\n              className=\"w-full p-2 border rounded-md bg-background min-h-[80px] text-sm\"\n              placeholder=\"Brief description of the case...\"\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              data-testid=\"input-case-description\"\n            />\n          </div>\n          <div className=\"flex justify-end gap-2 pt-2\">\n            <Button type=\"button\" variant=\"outline\" onClick={() => setOpen(false)}>\n              Cancel\n            </Button>\n            <Button type=\"submit\" disabled={createMutation.isPending} data-testid=\"button-create-case\">\n              {createMutation.isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Creating...\n                </>\n              ) : (\n                \"Create Case\"\n              )}\n            </Button>\n          </div>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction CalendarIcon({ className }: { className?: string }) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><rect width=\"18\" height=\"18\" x=\"3\" y=\"4\" rx=\"2\" ry=\"2\"/><line x1=\"16\" x2=\"16\" y1=\"2\" y2=\"6\"/><line x1=\"8\" x2=\"8\" y1=\"2\" y2=\"6\"/><line x1=\"3\" x2=\"21\" y1=\"10\" y2=\"10\"/></svg>\n  );\n}\n","path":null,"size_bytes":15133,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/components/ui/field.tsx":{"content":"\"use client\"\n\nimport { useMemo } from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction FieldSet({ className, ...props }: React.ComponentProps<\"fieldset\">) {\n  return (\n    <fieldset\n      data-slot=\"field-set\"\n      className={cn(\n        \"flex flex-col gap-6\",\n        \"has-[>[data-slot=checkbox-group]]:gap-3 has-[>[data-slot=radio-group]]:gap-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLegend({\n  className,\n  variant = \"legend\",\n  ...props\n}: React.ComponentProps<\"legend\"> & { variant?: \"legend\" | \"label\" }) {\n  return (\n    <legend\n      data-slot=\"field-legend\"\n      data-variant={variant}\n      className={cn(\n        \"mb-3 font-medium\",\n        \"data-[variant=legend]:text-base\",\n        \"data-[variant=label]:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-group\"\n      className={cn(\n        \"group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst fieldVariants = cva(\n  \"group/field data-[invalid=true]:text-destructive flex w-full gap-3\",\n  {\n    variants: {\n      orientation: {\n        vertical: [\"flex-col [&>*]:w-full [&>.sr-only]:w-auto\"],\n        horizontal: [\n          \"flex-row items-center\",\n          \"[&>[data-slot=field-label]]:flex-auto\",\n          \"has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px has-[>[data-slot=field-content]]:items-start\",\n        ],\n        responsive: [\n          \"@md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto flex-col [&>*]:w-full [&>.sr-only]:w-auto\",\n          \"@md/field-group:[&>[data-slot=field-label]]:flex-auto\",\n          \"@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n      },\n    },\n    defaultVariants: {\n      orientation: \"vertical\",\n    },\n  }\n)\n\nfunction Field({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof fieldVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"field\"\n      data-orientation={orientation}\n      className={cn(fieldVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction FieldContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-content\"\n      className={cn(\n        \"group/field-content flex flex-1 flex-col gap-1.5 leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof Label>) {\n  return (\n    <Label\n      data-slot=\"field-label\"\n      className={cn(\n        \"group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50\",\n        \"has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>[data-slot=field]]:p-4\",\n        \"has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-label\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug group-data-[disabled=true]/field:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"field-description\"\n      className={cn(\n        \"text-muted-foreground text-sm font-normal leading-normal group-has-[[data-orientation=horizontal]]/field:text-balance\",\n        \"nth-last-2:-mt-1 last:mt-0 [[data-variant=legend]+&]:-mt-1.5\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldSeparator({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  children?: React.ReactNode\n}) {\n  return (\n    <div\n      data-slot=\"field-separator\"\n      data-content={!!children}\n      className={cn(\n        \"relative -my-2 h-5 text-sm group-data-[variant=outline]/field-group:-mb-2\",\n        className\n      )}\n      {...props}\n    >\n      <Separator className=\"absolute inset-0 top-1/2\" />\n      {children && (\n        <span\n          className=\"bg-background text-muted-foreground relative mx-auto block w-fit px-2\"\n          data-slot=\"field-separator-content\"\n        >\n          {children}\n        </span>\n      )}\n    </div>\n  )\n}\n\nfunction FieldError({\n  className,\n  children,\n  errors,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  errors?: Array<{ message?: string } | undefined>\n}) {\n  const content = useMemo(() => {\n    if (children) {\n      return children\n    }\n\n    if (!errors) {\n      return null\n    }\n\n    if (errors?.length === 1 && errors[0]?.message) {\n      return errors[0].message\n    }\n\n    return (\n      <ul className=\"ml-4 flex list-disc flex-col gap-1\">\n        {errors.map(\n          (error, index) =>\n            error?.message && <li key={index}>{error.message}</li>\n        )}\n      </ul>\n    )\n  }, [children, errors])\n\n  if (!content) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"alert\"\n      data-slot=\"field-error\"\n      className={cn(\"text-destructive text-sm font-normal\", className)}\n      {...props}\n    >\n      {content}\n    </div>\n  )\n}\n\nexport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLegend,\n  FieldSeparator,\n  FieldSet,\n  FieldContent,\n  FieldTitle,\n}\n","path":null,"size_bytes":6044,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4280,"size_tokens":null},"client/src/components/collaboration-chat.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card } from \"@/components/ui/card\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { \n  MessageCircle, \n  Send, \n  X, \n  Minimize2,\n  Maximize2\n} from \"lucide-react\";\n\ninterface ChatMessage {\n  id: string;\n  userId: string;\n  userName: string;\n  userColor: string;\n  content: string;\n  timestamp: Date;\n}\n\ninterface CollaborationChatProps {\n  caseId: number;\n  userId: string;\n  userName: string;\n  userColor?: string;\n  onClose: () => void;\n}\n\nexport function CollaborationChat({ caseId, userId, userName, userColor = \"#3b82f6\", onClose }: CollaborationChatProps) {\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\n  const [inputValue, setInputValue] = useState(\"\");\n  const [isMinimized, setIsMinimized] = useState(false);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const wsRef = useRef<WebSocket | null>(null);\n  const scrollRef = useRef<HTMLDivElement>(null);\n  const shouldReconnectRef = useRef(true);\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    const connect = () => {\n      if (!shouldReconnectRef.current) return;\n      \n      const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n      const wsUrl = `${protocol}//${window.location.host}/ws/collaboration`;\n      \n      const ws = new WebSocket(wsUrl);\n      wsRef.current = ws;\n\n      ws.onopen = () => {\n        ws.send(JSON.stringify({\n          type: \"join\",\n          caseId,\n          userId,\n          userName,\n        }));\n      };\n\n      ws.onmessage = (event) => {\n        try {\n          const data = JSON.parse(event.data);\n          if (data.type === \"chat\" && data.caseId === caseId) {\n            const newMessage: ChatMessage = {\n              id: `${Date.now()}-${Math.random()}`,\n              userId: data.userId,\n              userName: data.userName,\n              userColor: data.userColor || \"#3b82f6\",\n              content: data.content,\n              timestamp: new Date(),\n            };\n            setMessages(prev => [...prev, newMessage]);\n            \n            if (isMinimized && data.userId !== userId) {\n              setUnreadCount(prev => prev + 1);\n            }\n          }\n        } catch (err) {\n          console.error(\"Failed to parse chat message:\", err);\n        }\n      };\n\n      ws.onclose = () => {\n        if (shouldReconnectRef.current) {\n          reconnectTimeoutRef.current = setTimeout(connect, 3000);\n        }\n      };\n\n      ws.onerror = () => ws.close();\n    };\n\n    connect();\n\n    return () => {\n      shouldReconnectRef.current = false;\n      if (reconnectTimeoutRef.current) {\n        clearTimeout(reconnectTimeoutRef.current);\n      }\n      wsRef.current?.close();\n    };\n  }, [caseId, userId, userName, isMinimized]);\n\n  useEffect(() => {\n    if (scrollRef.current) {\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n    }\n  }, [messages]);\n\n  const sendMessage = () => {\n    if (!inputValue.trim() || !wsRef.current) return;\n\n    const messageData = {\n      type: \"chat\",\n      caseId,\n      userId,\n      userName,\n      userColor,\n      content: inputValue.trim(),\n    };\n\n    wsRef.current.send(JSON.stringify(messageData));\n    \n    setMessages(prev => [...prev, {\n      id: `${Date.now()}-${Math.random()}`,\n      userId,\n      userName,\n      userColor,\n      content: inputValue.trim(),\n      timestamp: new Date(),\n    }]);\n    \n    setInputValue(\"\");\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n\n  if (isMinimized) {\n    return (\n      <Card \n        className=\"fixed bottom-4 left-4 z-50 p-3 shadow-lg bg-background/95 backdrop-blur border-primary/20 cursor-pointer\"\n        onClick={() => { setIsMinimized(false); setUnreadCount(0); }}\n      >\n        <div className=\"flex items-center gap-3\">\n          <MessageCircle className=\"w-4 h-4 text-primary\" />\n          <span className=\"text-sm font-medium\">Chat</span>\n          {unreadCount > 0 && (\n            <span className=\"bg-primary text-primary-foreground text-xs px-2 py-0.5 rounded-full\">\n              {unreadCount}\n            </span>\n          )}\n          <Button variant=\"ghost\" size=\"icon\" className=\"h-7 w-7\" onClick={(e) => { e.stopPropagation(); onClose(); }}>\n            <X className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"fixed bottom-4 left-4 z-50 w-[calc(100vw-2rem)] sm:w-[320px] h-[350px] sm:h-[400px] shadow-2xl bg-background/95 backdrop-blur border-primary/20 flex flex-col overflow-hidden\" data-testid=\"collaboration-chat\">\n      <div className=\"flex items-center justify-between p-3 border-b bg-muted/30\">\n        <div className=\"flex items-center gap-2\">\n          <MessageCircle className=\"w-4 h-4 text-primary\" />\n          <span className=\"text-sm font-medium\">Team Chat</span>\n        </div>\n        <div className=\"flex items-center gap-1\">\n          <Button variant=\"ghost\" size=\"icon\" className=\"h-7 w-7\" onClick={() => setIsMinimized(true)}>\n            <Minimize2 className=\"w-4 h-4\" />\n          </Button>\n          <Button variant=\"ghost\" size=\"icon\" className=\"h-7 w-7\" onClick={onClose}>\n            <X className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </div>\n      \n      <ScrollArea className=\"flex-1 p-3\" ref={scrollRef}>\n        {messages.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center h-full text-muted-foreground text-center p-4\">\n            <MessageCircle className=\"w-8 h-8 mb-2 opacity-50\" />\n            <p className=\"text-sm\">No messages yet</p>\n            <p className=\"text-xs\">Start the conversation!</p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {messages.map((msg) => (\n              <div \n                key={msg.id} \n                className={`flex gap-2 ${msg.userId === userId ? \"flex-row-reverse\" : \"\"}`}\n              >\n                <Avatar className=\"w-7 h-7 shrink-0\">\n                  <AvatarFallback \n                    className=\"text-[10px] font-semibold text-white\"\n                    style={{ backgroundColor: msg.userColor }}\n                  >\n                    {msg.userName.slice(0, 2).toUpperCase()}\n                  </AvatarFallback>\n                </Avatar>\n                <div className={`max-w-[200px] ${msg.userId === userId ? \"text-right\" : \"\"}`}>\n                  <p className=\"text-xs text-muted-foreground mb-1\">\n                    {msg.userId === userId ? \"You\" : msg.userName}\n                  </p>\n                  <div \n                    className={`rounded-lg px-3 py-2 text-sm ${\n                      msg.userId === userId \n                        ? \"bg-primary text-primary-foreground\" \n                        : \"bg-muted\"\n                    }`}\n                  >\n                    {msg.content}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </ScrollArea>\n      \n      <div className=\"p-3 border-t bg-muted/30\">\n        <div className=\"flex gap-2\">\n          <Input\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n            onKeyPress={handleKeyPress}\n            placeholder=\"Type a message...\"\n            className=\"flex-1 h-9\"\n            data-testid=\"input-chat-message\"\n          />\n          <Button \n            size=\"icon\" \n            className=\"h-9 w-9 shrink-0\" \n            onClick={sendMessage}\n            disabled={!inputValue.trim()}\n            data-testid=\"button-send-message\"\n          >\n            <Send className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </div>\n    </Card>\n  );\n}\n","path":null,"size_bytes":7974,"size_tokens":null},"server/services/googleDrive.ts":{"content":"import { google } from 'googleapis';\n\nlet connectionSettings: any;\n\nasync function getAccessToken() {\n  if (connectionSettings && connectionSettings.settings.expires_at && new Date(connectionSettings.settings.expires_at).getTime() > Date.now()) {\n    return connectionSettings.settings.access_token;\n  }\n  \n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME;\n  const xReplitToken = process.env.REPL_IDENTITY \n    ? 'repl ' + process.env.REPL_IDENTITY \n    : process.env.WEB_REPL_RENEWAL \n    ? 'depl ' + process.env.WEB_REPL_RENEWAL \n    : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  connectionSettings = await fetch(\n    'https://' + hostname + '/api/v2/connection?include_secrets=true&connector_names=google-drive',\n    {\n      headers: {\n        'Accept': 'application/json',\n        'X_REPLIT_TOKEN': xReplitToken\n      }\n    }\n  ).then(res => res.json()).then(data => data.items?.[0]);\n\n  const accessToken = connectionSettings?.settings?.access_token || connectionSettings.settings?.oauth?.credentials?.access_token;\n\n  if (!connectionSettings || !accessToken) {\n    throw new Error('Google Drive not connected');\n  }\n  return accessToken;\n}\n\n// WARNING: Never cache this client.\n// Access tokens expire, so a new client must be created each time.\nexport async function getUncachableGoogleDriveClient() {\n  const accessToken = await getAccessToken();\n\n  const oauth2Client = new google.auth.OAuth2();\n  oauth2Client.setCredentials({\n    access_token: accessToken\n  });\n\n  return google.drive({ version: 'v3', auth: oauth2Client });\n}\n\nexport interface DriveFile {\n  id: string;\n  name: string;\n  mimeType: string;\n  size?: string;\n  webViewLink?: string;\n  webContentLink?: string;\n  createdTime?: string;\n  modifiedTime?: string;\n}\n\nexport interface DriveFolder {\n  id: string;\n  name: string;\n  path?: string;\n}\n\n/**\n * List folders in Google Drive\n */\nexport async function listFolders(parentId?: string): Promise<DriveFolder[]> {\n  const drive = await getUncachableGoogleDriveClient();\n  \n  const query = parentId \n    ? `'${parentId}' in parents and mimeType = 'application/vnd.google-apps.folder' and trashed = false`\n    : `mimeType = 'application/vnd.google-apps.folder' and trashed = false`;\n\n  const response = await drive.files.list({\n    q: query,\n    fields: 'files(id, name)',\n    orderBy: 'name',\n    pageSize: 100,\n  });\n\n  return (response.data.files || []).map(f => ({\n    id: f.id!,\n    name: f.name!,\n  }));\n}\n\n/**\n * List all files in a folder (including subfolders recursively)\n */\nexport async function listFilesInFolder(folderId: string): Promise<DriveFile[]> {\n  const drive = await getUncachableGoogleDriveClient();\n  \n  const files: DriveFile[] = [];\n  let pageToken: string | undefined;\n\n  // Supported file types for legal discovery\n  const supportedMimeTypes = [\n    'application/pdf',\n    'image/jpeg',\n    'image/png',\n    'image/tiff',\n    'video/mp4',\n    'video/quicktime',\n    'audio/mpeg',\n    'audio/mp3',\n    'text/plain',\n    'text/xml',\n    'application/xml',\n    'application/msword',\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    'application/vnd.ms-excel',\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n    'message/rfc822',\n  ];\n\n  do {\n    const response = await drive.files.list({\n      q: `'${folderId}' in parents and trashed = false`,\n      fields: 'nextPageToken, files(id, name, mimeType, size, webViewLink, webContentLink, createdTime, modifiedTime)',\n      orderBy: 'name',\n      pageSize: 100,\n      pageToken,\n    });\n\n    const driveFiles = response.data.files || [];\n    \n    for (const file of driveFiles) {\n      // If it's a folder, recursively get its contents\n      if (file.mimeType === 'application/vnd.google-apps.folder') {\n        const subFiles = await listFilesInFolder(file.id!);\n        files.push(...subFiles);\n      } else if (supportedMimeTypes.includes(file.mimeType!)) {\n        files.push({\n          id: file.id!,\n          name: file.name!,\n          mimeType: file.mimeType!,\n          size: file.size,\n          webViewLink: file.webViewLink,\n          webContentLink: file.webContentLink,\n          createdTime: file.createdTime,\n          modifiedTime: file.modifiedTime,\n        });\n      }\n    }\n\n    pageToken = response.data.nextPageToken || undefined;\n  } while (pageToken);\n\n  return files;\n}\n\n/**\n * Download a file's content as a buffer\n */\nexport async function downloadFile(fileId: string): Promise<Buffer> {\n  const drive = await getUncachableGoogleDriveClient();\n  \n  const response = await drive.files.get({\n    fileId,\n    alt: 'media',\n  }, { responseType: 'arraybuffer' });\n\n  return Buffer.from(response.data as ArrayBuffer);\n}\n\n/**\n * Get file metadata\n */\nexport async function getFileMetadata(fileId: string): Promise<DriveFile> {\n  const drive = await getUncachableGoogleDriveClient();\n  \n  const response = await drive.files.get({\n    fileId,\n    fields: 'id, name, mimeType, size, webViewLink, webContentLink, createdTime, modifiedTime',\n  });\n\n  return {\n    id: response.data.id!,\n    name: response.data.name!,\n    mimeType: response.data.mimeType!,\n    size: response.data.size,\n    webViewLink: response.data.webViewLink,\n    webContentLink: response.data.webContentLink,\n    createdTime: response.data.createdTime,\n    modifiedTime: response.data.modifiedTime,\n  };\n}\n","path":null,"size_bytes":5414,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"grid place-content-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1031,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1486,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, serial, integer, timestamp, jsonb, boolean } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\n// Cases\nexport const cases = pgTable(\"cases\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  caseNumber: varchar(\"case_number\", { length: 100 }).notNull().unique(),\n  client: text(\"client\").notNull(),\n  status: text(\"status\").notNull().default(\"active\"),\n  description: text(\"description\"),\n  nextDeadline: timestamp(\"next_deadline\"),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n  updatedAt: timestamp(\"updated_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\n// Discovery Files\nexport const discoveryFiles = pgTable(\"discovery_files\", {\n  id: serial(\"id\").primaryKey(),\n  caseId: integer(\"case_id\").notNull().references(() => cases.id, { onDelete: \"cascade\" }),\n  batesStart: varchar(\"bates_start\", { length: 50 }).notNull(),\n  batesEnd: varchar(\"bates_end\", { length: 50 }).notNull(),\n  fileName: text(\"file_name\").notNull(),\n  fileType: varchar(\"file_type\", { length: 50 }).notNull(),\n  filePath: text(\"file_path\"),\n  fileSize: integer(\"file_size\"),\n  uploadDate: timestamp(\"upload_date\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n  processedDate: timestamp(\"processed_date\"),\n  relevance: varchar(\"relevance\", { length: 20 }).default(\"medium\"),\n  tags: text(\"tags\").array(),\n  summary: text(\"summary\"),\n  extractedText: text(\"extracted_text\"),\n  extractedDates: jsonb(\"extracted_dates\"),\n  metadata: jsonb(\"metadata\"),\n  // Cloud storage fields\n  sourceType: varchar(\"source_type\", { length: 20 }).default(\"upload\"),\n  cloudFileId: text(\"cloud_file_id\"),\n  cloudProvider: varchar(\"cloud_provider\", { length: 20 }),\n  driveUrl: text(\"drive_url\"),\n});\n\n// Cloud Folders (for syncing)\nexport const cloudFolders = pgTable(\"cloud_folders\", {\n  id: serial(\"id\").primaryKey(),\n  caseId: integer(\"case_id\").notNull().references(() => cases.id, { onDelete: \"cascade\" }),\n  provider: varchar(\"provider\", { length: 20 }).notNull(),\n  folderId: text(\"folder_id\").notNull(),\n  folderName: text(\"folder_name\").notNull(),\n  lastSynced: timestamp(\"last_synced\"),\n  batesPrefix: varchar(\"bates_prefix\", { length: 20 }).notNull(),\n  nextBatesNumber: integer(\"next_bates_number\").default(1).notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\n// Timeline Events\nexport const timelineEvents = pgTable(\"timeline_events\", {\n  id: serial(\"id\").primaryKey(),\n  caseId: integer(\"case_id\").notNull().references(() => cases.id, { onDelete: \"cascade\" }),\n  eventDate: timestamp(\"event_date\").notNull(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  eventType: varchar(\"event_type\", { length: 50 }).notNull(),\n  linkedBates: text(\"linked_bates\").array(),\n  metadata: jsonb(\"metadata\"),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\n// Deposition Prep\nexport const depositionPrep = pgTable(\"deposition_prep\", {\n  id: serial(\"id\").primaryKey(),\n  caseId: integer(\"case_id\").notNull().references(() => cases.id, { onDelete: \"cascade\" }),\n  depositionType: varchar(\"deposition_type\", { length: 50 }).notNull(),\n  targetWitness: text(\"target_witness\"),\n  questions: jsonb(\"questions\").notNull(),\n  strategy: text(\"strategy\"),\n  linkedEvidence: text(\"linked_evidence\").array(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n  updatedAt: timestamp(\"updated_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\n// AI Chat Conversations (for AI Insights)\nexport const conversations = pgTable(\"conversations\", {\n  id: serial(\"id\").primaryKey(),\n  caseId: integer(\"case_id\").references(() => cases.id, { onDelete: \"cascade\" }),\n  title: text(\"title\").notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\nexport const messages = pgTable(\"messages\", {\n  id: serial(\"id\").primaryKey(),\n  conversationId: integer(\"conversation_id\").notNull().references(() => conversations.id, { onDelete: \"cascade\" }),\n  role: text(\"role\").notNull(),\n  content: text(\"content\").notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\n// Suggested Filings\nexport const suggestedFilings = pgTable(\"suggested_filings\", {\n  id: serial(\"id\").primaryKey(),\n  caseId: integer(\"case_id\").notNull().references(() => cases.id, { onDelete: \"cascade\" }),\n  filingType: text(\"filing_type\").notNull(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  deadline: timestamp(\"deadline\"),\n  priority: varchar(\"priority\", { length: 20 }).default(\"medium\"),\n  status: varchar(\"status\", { length: 20 }).default(\"pending\"),\n  reasoning: text(\"reasoning\"),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\n// Insert Schemas\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\nexport const insertCaseSchema = createInsertSchema(cases).omit({ id: true, createdAt: true, updatedAt: true });\n// Simplified schema for case intake modal (only requires the basics)\nexport const caseIntakeSchema = z.object({\n  title: z.string().min(1, \"Title is required\"),\n  caseNumber: z.string().min(1, \"Case number is required\"),\n  client: z.string().min(1, \"Client name is required\"),\n  description: z.string().optional(),\n});\nexport const insertDiscoveryFileSchema = createInsertSchema(discoveryFiles).omit({ id: true, uploadDate: true, processedDate: true });\nexport const insertTimelineEventSchema = createInsertSchema(timelineEvents).omit({ id: true, createdAt: true });\nexport const insertDepositionPrepSchema = createInsertSchema(depositionPrep).omit({ id: true, createdAt: true, updatedAt: true });\nexport const insertConversationSchema = createInsertSchema(conversations).omit({ id: true, createdAt: true });\nexport const insertMessageSchema = createInsertSchema(messages).omit({ id: true, createdAt: true });\nexport const insertSuggestedFilingSchema = createInsertSchema(suggestedFilings).omit({ id: true, createdAt: true });\nexport const insertCloudFolderSchema = createInsertSchema(cloudFolders).omit({ id: true, createdAt: true, lastSynced: true });\n\n// Types\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\nexport type Case = typeof cases.$inferSelect;\nexport type InsertCase = z.infer<typeof insertCaseSchema>;\nexport type CaseIntake = z.infer<typeof caseIntakeSchema>;\nexport type DiscoveryFile = typeof discoveryFiles.$inferSelect;\nexport type InsertDiscoveryFile = z.infer<typeof insertDiscoveryFileSchema>;\nexport type TimelineEvent = typeof timelineEvents.$inferSelect;\nexport type InsertTimelineEvent = z.infer<typeof insertTimelineEventSchema>;\nexport type DepositionPrep = typeof depositionPrep.$inferSelect;\nexport type InsertDepositionPrep = z.infer<typeof insertDepositionPrepSchema>;\nexport type Conversation = typeof conversations.$inferSelect;\nexport type InsertConversation = z.infer<typeof insertConversationSchema>;\nexport type Message = typeof messages.$inferSelect;\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\nexport type SuggestedFiling = typeof suggestedFilings.$inferSelect;\nexport type InsertSuggestedFiling = z.infer<typeof insertSuggestedFilingSchema>;\nexport type CloudFolder = typeof cloudFolders.$inferSelect;\nexport type InsertCloudFolder = z.infer<typeof insertCloudFolderSchema>;\n\n// Legal Briefs\nexport const legalBriefs = pgTable(\"legal_briefs\", {\n  id: serial(\"id\").primaryKey(),\n  caseId: integer(\"case_id\").notNull().references(() => cases.id, { onDelete: \"cascade\" }),\n  title: text(\"title\").notNull(),\n  briefType: varchar(\"brief_type\", { length: 50 }).notNull(),\n  content: text(\"content\").notNull(),\n  summary: text(\"summary\"),\n  precedents: jsonb(\"precedents\"),\n  keyArguments: jsonb(\"key_arguments\"),\n  status: varchar(\"status\", { length: 20 }).default(\"draft\"),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n  updatedAt: timestamp(\"updated_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\nexport const insertLegalBriefSchema = createInsertSchema(legalBriefs).omit({ id: true, createdAt: true, updatedAt: true });\nexport type LegalBrief = typeof legalBriefs.$inferSelect;\nexport type InsertLegalBrief = z.infer<typeof insertLegalBriefSchema>;\n\n// News Articles (cached from external sources)\nexport const newsArticles = pgTable(\"news_articles\", {\n  id: serial(\"id\").primaryKey(),\n  url: text(\"url\").notNull().unique(),\n  title: text(\"title\").notNull(),\n  summary: text(\"summary\"),\n  imageUrl: text(\"image_url\"),\n  publishedAt: timestamp(\"published_at\"),\n  featured: boolean(\"featured\").default(false),\n  source: varchar(\"source\", { length: 100 }).default(\"wtpnews\"),\n  fetchedAt: timestamp(\"fetched_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\nexport type NewsArticle = typeof newsArticles.$inferSelect;\nexport type InsertNewsArticle = typeof newsArticles.$inferInsert;\n","path":null,"size_bytes":9272,"size_tokens":null},"client/src/hooks/use-collaboration.ts":{"content":"import { useState, useEffect, useCallback, useRef } from \"react\";\nimport { useQueryClient } from \"@tanstack/react-query\";\n\ninterface CollaboratorUser {\n  id: string;\n  name: string;\n  color: string;\n}\n\ninterface CollaborationMessage {\n  type: \"presence\" | \"update\" | \"cursor\" | \"pong\";\n  caseId?: number;\n  userId?: string;\n  userName?: string;\n  userColor?: string;\n  users?: CollaboratorUser[];\n  data?: any;\n}\n\nfunction generateUserId(): string {\n  const stored = localStorage.getItem(\"casebuddy_user_id\");\n  if (stored) return stored;\n  \n  const newId = `user_${Math.random().toString(36).slice(2, 10)}`;\n  localStorage.setItem(\"casebuddy_user_id\", newId);\n  return newId;\n}\n\nfunction generateUserName(): string {\n  const stored = localStorage.getItem(\"casebuddy_user_name\");\n  if (stored) return stored;\n  \n  const names = [\"Alex\", \"Jordan\", \"Sam\", \"Taylor\", \"Morgan\", \"Casey\", \"Riley\", \"Quinn\"];\n  const newName = names[Math.floor(Math.random() * names.length)];\n  localStorage.setItem(\"casebuddy_user_name\", newName);\n  return newName;\n}\n\nexport function useCollaboration(caseId: number | null) {\n  const [collaborators, setCollaborators] = useState<CollaboratorUser[]>([]);\n  const [isConnected, setIsConnected] = useState(false);\n  const wsRef = useRef<WebSocket | null>(null);\n  const queryClient = useQueryClient();\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const pingIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const shouldReconnectRef = useRef(true);\n\n  const userId = useRef(generateUserId());\n  const userName = useRef(generateUserName());\n\n  const connect = useCallback(() => {\n    if (!caseId || wsRef.current?.readyState === WebSocket.OPEN) return;\n    shouldReconnectRef.current = true;\n\n    const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n    const wsUrl = `${protocol}//${window.location.host}/ws/collaboration`;\n    \n    const ws = new WebSocket(wsUrl);\n    wsRef.current = ws;\n\n    ws.onopen = () => {\n      setIsConnected(true);\n      ws.send(JSON.stringify({\n        type: \"join\",\n        caseId,\n        userId: userId.current,\n        userName: userName.current,\n      }));\n\n      pingIntervalRef.current = setInterval(() => {\n        if (ws.readyState === WebSocket.OPEN) {\n          ws.send(JSON.stringify({ type: \"ping\" }));\n        }\n      }, 30000);\n    };\n\n    ws.onmessage = (event) => {\n      try {\n        const message: CollaborationMessage = JSON.parse(event.data);\n        \n        switch (message.type) {\n          case \"presence\":\n            if (message.users) {\n              setCollaborators(message.users.filter(u => u.id !== userId.current));\n            }\n            break;\n          case \"update\":\n            if (message.data?.updateType) {\n              queryClient.invalidateQueries({ \n                queryKey: [message.data.updateType, String(caseId)] \n              });\n            }\n            break;\n        }\n      } catch (err) {\n        console.error(\"Failed to parse collaboration message:\", err);\n      }\n    };\n\n    ws.onclose = () => {\n      setIsConnected(false);\n      setCollaborators([]);\n      \n      if (pingIntervalRef.current) {\n        clearInterval(pingIntervalRef.current);\n      }\n      \n      if (shouldReconnectRef.current) {\n        reconnectTimeoutRef.current = setTimeout(() => {\n          connect();\n        }, 3000);\n      }\n    };\n\n    ws.onerror = () => {\n      ws.close();\n    };\n  }, [caseId, queryClient]);\n\n  const disconnect = useCallback(() => {\n    shouldReconnectRef.current = false;\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n    }\n    if (pingIntervalRef.current) {\n      clearInterval(pingIntervalRef.current);\n    }\n    if (wsRef.current) {\n      wsRef.current.close();\n      wsRef.current = null;\n    }\n    setIsConnected(false);\n    setCollaborators([]);\n  }, []);\n\n  const notifyUpdate = useCallback((updateType: string, data?: any) => {\n    if (wsRef.current?.readyState === WebSocket.OPEN) {\n      wsRef.current.send(JSON.stringify({\n        type: \"update\",\n        data: { updateType, ...data },\n      }));\n    }\n  }, []);\n\n  useEffect(() => {\n    if (caseId) {\n      connect();\n    }\n    \n    return () => {\n      disconnect();\n    };\n  }, [caseId, connect, disconnect]);\n\n  return {\n    collaborators,\n    isConnected,\n    userId: userId.current,\n    userName: userName.current,\n    notifyUpdate,\n  };\n}\n","path":null,"size_bytes":4416,"size_tokens":null},"server/replit_integrations/chat/routes.ts":{"content":"import type { Express, Request, Response } from \"express\";\nimport { GoogleGenAI } from \"@google/genai\";\nimport { chatStorage } from \"./storage\";\n\n/*\nSupported models: gemini-2.5-flash (fast), gemini-2.5-pro (advanced reasoning)\nUsage: Include httpOptions with baseUrl and empty apiVersion when using AI Integrations (required)\n*/\n\n// This is using Replit's AI Integrations service, which provides Gemini-compatible API access without requiring your own Gemini API key.\nconst ai = new GoogleGenAI({\n  apiKey: process.env.AI_INTEGRATIONS_GEMINI_API_KEY,\n  httpOptions: {\n    apiVersion: \"\",\n    baseUrl: process.env.AI_INTEGRATIONS_GEMINI_BASE_URL,\n  },\n});\n\nexport function registerChatRoutes(app: Express): void {\n  // Get all conversations\n  app.get(\"/api/conversations\", async (req: Request, res: Response) => {\n    try {\n      const conversations = await chatStorage.getAllConversations();\n      res.json(conversations);\n    } catch (error) {\n      console.error(\"Error fetching conversations:\", error);\n      res.status(500).json({ error: \"Failed to fetch conversations\" });\n    }\n  });\n\n  // Get single conversation with messages\n  app.get(\"/api/conversations/:id\", async (req: Request, res: Response) => {\n    try {\n      const id = parseInt(req.params.id);\n      const conversation = await chatStorage.getConversation(id);\n      if (!conversation) {\n        return res.status(404).json({ error: \"Conversation not found\" });\n      }\n      const messages = await chatStorage.getMessagesByConversation(id);\n      res.json({ ...conversation, messages });\n    } catch (error) {\n      console.error(\"Error fetching conversation:\", error);\n      res.status(500).json({ error: \"Failed to fetch conversation\" });\n    }\n  });\n\n  // Create new conversation\n  app.post(\"/api/conversations\", async (req: Request, res: Response) => {\n    try {\n      const { title } = req.body;\n      const conversation = await chatStorage.createConversation(title || \"New Chat\");\n      res.status(201).json(conversation);\n    } catch (error) {\n      console.error(\"Error creating conversation:\", error);\n      res.status(500).json({ error: \"Failed to create conversation\" });\n    }\n  });\n\n  // Delete conversation\n  app.delete(\"/api/conversations/:id\", async (req: Request, res: Response) => {\n    try {\n      const id = parseInt(req.params.id);\n      await chatStorage.deleteConversation(id);\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting conversation:\", error);\n      res.status(500).json({ error: \"Failed to delete conversation\" });\n    }\n  });\n\n  // Send message and get AI response (streaming)\n  app.post(\"/api/conversations/:id/messages\", async (req: Request, res: Response) => {\n    try {\n      const conversationId = parseInt(req.params.id);\n      const { content } = req.body;\n\n      // Save user message\n      await chatStorage.createMessage(conversationId, \"user\", content);\n\n      // Get conversation history for context\n      const messages = await chatStorage.getMessagesByConversation(conversationId);\n      const chatMessages = messages.map((m) => ({\n        role: m.role as \"user\" | \"model\",\n        parts: [{ text: m.content }],\n      }));\n\n      // Set up SSE\n      res.setHeader(\"Content-Type\", \"text/event-stream\");\n      res.setHeader(\"Cache-Control\", \"no-cache\");\n      res.setHeader(\"Connection\", \"keep-alive\");\n\n      // Stream response from Gemini\n      const stream = await ai.models.generateContentStream({\n        model: \"gemini-2.5-flash\",\n        contents: chatMessages,\n      });\n\n      let fullResponse = \"\";\n\n      for await (const chunk of stream) {\n        const content = chunk.text || \"\";\n        if (content) {\n          fullResponse += content;\n          res.write(`data: ${JSON.stringify({ content })}\\n\\n`);\n        }\n      }\n\n      // Save assistant message\n      await chatStorage.createMessage(conversationId, \"assistant\", fullResponse);\n\n      res.write(`data: ${JSON.stringify({ done: true })}\\n\\n`);\n      res.end();\n    } catch (error) {\n      console.error(\"Error sending message:\", error);\n      // Check if headers already sent (SSE streaming started)\n      if (res.headersSent) {\n        res.write(`data: ${JSON.stringify({ error: \"Failed to send message\" })}\\n\\n`);\n        res.end();\n      } else {\n        res.status(500).json({ error: \"Failed to send message\" });\n      }\n    }\n  });\n}\n\n","path":null,"size_bytes":4363,"size_tokens":null},"server/services/documentProcessor.ts":{"content":"import { GoogleGenAI } from \"@google/genai\";\nimport * as pdfParseModule from \"pdf-parse\";\nimport fs from \"fs/promises\";\nimport path from \"path\";\n\nconst pdfParse = (pdfParseModule as any).default || pdfParseModule;\n\n// Using Replit AI Integrations for Gemini\nconst ai = new GoogleGenAI({\n  apiKey: process.env.AI_INTEGRATIONS_GEMINI_API_KEY!,\n  httpOptions: {\n    apiVersion: \"\",\n    baseUrl: process.env.AI_INTEGRATIONS_GEMINI_BASE_URL!,\n  },\n});\n\nexport interface ProcessedDocument {\n  extractedText: string;\n  summary: string;\n  relevance: \"high\" | \"medium\" | \"low\";\n  tags: string[];\n  extractedDates: Array<{ date: string; context: string }>;\n  metadata: Record<string, any>;\n}\n\n/**\n * Process a PDF document using Gemini OCR and analysis\n */\nexport async function processPDF(filePath: string, fileName: string): Promise<ProcessedDocument> {\n  try {\n    // First try pdf-parse for text extraction\n    const dataBuffer = await fs.readFile(filePath);\n    const pdfData = await pdfParse(dataBuffer);\n    const extractedText = pdfData.text;\n\n    // Use Gemini to analyze the document\n    const analysisPrompt = `You are a legal document analyzer. Analyze this legal document and provide:\n1. A concise summary (2-3 sentences)\n2. Relevance level (high/medium/low) based on how critical this document appears for a legal case\n3. Key tags/categories (e.g., \"financial\", \"communication\", \"evidence\", \"witness-statement\", etc.)\n4. Extract any dates mentioned with their context\n\nDocument text:\n${extractedText.substring(0, 10000)}\n\nRespond in JSON format:\n{\n  \"summary\": \"...\",\n  \"relevance\": \"high|medium|low\",\n  \"tags\": [\"tag1\", \"tag2\"],\n  \"dates\": [{\"date\": \"YYYY-MM-DD\", \"context\": \"what happened\"}]\n}`;\n\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      contents: [{ role: \"user\", parts: [{ text: analysisPrompt }] }],\n    });\n\n    const resultText = response.text || \"{}\";\n    const jsonMatch = resultText.match(/\\{[\\s\\S]*\\}/);\n    const analysis = jsonMatch ? JSON.parse(jsonMatch[0]) : {};\n\n    return {\n      extractedText: extractedText.substring(0, 50000), // Limit storage\n      summary: analysis.summary || \"Document processed\",\n      relevance: analysis.relevance || \"medium\",\n      tags: analysis.tags || [],\n      extractedDates: analysis.dates || [],\n      metadata: {\n        pageCount: pdfData.numpages,\n        fileName,\n      },\n    };\n  } catch (error) {\n    console.error(\"PDF processing error:\", error);\n    throw new Error(\"Failed to process PDF\");\n  }\n}\n\n/**\n * Process audio/video using Gemini's multimodal capabilities\n */\nexport async function processMediaFile(\n  filePath: string,\n  fileName: string,\n  mimeType: string\n): Promise<ProcessedDocument> {\n  try {\n    const fileData = await fs.readFile(filePath);\n    const base64Data = fileData.toString(\"base64\");\n\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      contents: [\n        {\n          role: \"user\",\n          parts: [\n            {\n              inlineData: {\n                data: base64Data,\n                mimeType,\n              },\n            },\n            {\n              text: `Transcribe and analyze this ${mimeType.includes(\"audio\") ? \"audio\" : \"video\"} file. Provide:\n1. Full transcription\n2. Summary of key points\n3. Any dates or times mentioned\n4. Relevance to a legal case (high/medium/low)\n5. Tags describing the content\n\nRespond in JSON:\n{\n  \"transcription\": \"...\",\n  \"summary\": \"...\",\n  \"relevance\": \"high|medium|low\",\n  \"tags\": [\"tag1\", \"tag2\"],\n  \"dates\": [{\"date\": \"YYYY-MM-DD\", \"context\": \"...\"}]\n}`,\n            },\n          ],\n        },\n      ],\n    });\n\n    const resultText = response.text || \"{}\";\n    const jsonMatch = resultText.match(/\\{[\\s\\S]*\\}/);\n    const analysis = jsonMatch ? JSON.parse(jsonMatch[0]) : {};\n\n    return {\n      extractedText: analysis.transcription || \"\",\n      summary: analysis.summary || \"Media file processed\",\n      relevance: analysis.relevance || \"medium\",\n      tags: analysis.tags || [\"media\", mimeType.includes(\"audio\") ? \"audio\" : \"video\"],\n      extractedDates: analysis.dates || [],\n      metadata: {\n        mimeType,\n        fileName,\n      },\n    };\n  } catch (error) {\n    console.error(\"Media processing error:\", error);\n    throw new Error(\"Failed to process media file\");\n  }\n}\n\n/**\n * Process image files using Gemini vision\n */\nexport async function processImage(filePath: string, fileName: string): Promise<ProcessedDocument> {\n  try {\n    const fileData = await fs.readFile(filePath);\n    const base64Data = fileData.toString(\"base64\");\n\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      contents: [\n        {\n          role: \"user\",\n          parts: [\n            {\n              inlineData: {\n                data: base64Data,\n                mimeType: \"image/jpeg\",\n              },\n            },\n            {\n              text: `Analyze this image for a legal case. Extract any text (OCR), describe what's shown, and provide:\n1. Extracted text (if any)\n2. Description of the image\n3. Relevance to legal proceedings\n4. Any dates visible\n5. Tags\n\nJSON format:\n{\n  \"extractedText\": \"...\",\n  \"summary\": \"...\",\n  \"relevance\": \"high|medium|low\",\n  \"tags\": [\"tag1\"],\n  \"dates\": [{\"date\": \"YYYY-MM-DD\", \"context\": \"...\"}]\n}`,\n            },\n          ],\n        },\n      ],\n    });\n\n    const resultText = response.text || \"{}\";\n    const jsonMatch = resultText.match(/\\{[\\s\\S]*\\}/);\n    const analysis = jsonMatch ? JSON.parse(jsonMatch[0]) : {};\n\n    return {\n      extractedText: analysis.extractedText || \"\",\n      summary: analysis.summary || \"Image processed\",\n      relevance: analysis.relevance || \"medium\",\n      tags: analysis.tags || [\"image\"],\n      extractedDates: analysis.dates || [],\n      metadata: {\n        fileName,\n      },\n    };\n  } catch (error) {\n    console.error(\"Image processing error:\", error);\n    throw new Error(\"Failed to process image\");\n  }\n}\n","path":null,"size_bytes":5972,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5124,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { SaveStatusProvider } from \"@/hooks/use-save-status\";\nimport NotFound from \"@/pages/not-found\";\nimport Dashboard from \"@/pages/dashboard\";\nimport CaseView from \"@/pages/case-view\";\nimport MyCases from \"@/pages/my-cases\";\nimport CalendarPage from \"@/pages/calendar\";\nimport ResearchPage from \"@/pages/research\";\nimport SettingsPage from \"@/pages/settings\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Dashboard} />\n      <Route path=\"/cases\" component={MyCases} />\n      <Route path=\"/calendar\" component={CalendarPage} />\n      <Route path=\"/research\" component={ResearchPage} />\n      <Route path=\"/settings\" component={SettingsPage} />\n      <Route path=\"/case/:id\" component={CaseView} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <SaveStatusProvider>\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </SaveStatusProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":1334,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1598,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { caseIntakeSchema, insertDiscoveryFileSchema, insertDepositionPrepSchema, insertSuggestedFilingSchema, insertCloudFolderSchema } from \"@shared/schema\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs/promises\";\nimport { processPDF, processMediaFile, processImage } from \"./services/documentProcessor\";\nimport { generateDepositionQuestions, generateTimelineFromDocuments, suggestNextFilings } from \"./services/aiAssistant\";\nimport { registerChatRoutes } from \"./replit_integrations/chat\";\nimport { listFolders, listFilesInFolder, getFileMetadata, downloadFile, type DriveFile } from \"./services/googleDrive\";\nimport { collaborationService } from \"./services/collaboration\";\nimport { getOrCreateRoom, addParticipant, removeParticipant, getRoomParticipants } from \"./services/videoRooms\";\nimport type { Request, Response } from \"express\";\n\n// File upload configuration\nconst upload = multer({\n  dest: \"uploads/\",\n  limits: { fileSize: 100 * 1024 * 1024 }, // 100MB limit\n});\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  // Initialize WebSocket collaboration service\n  collaborationService.initialize(httpServer);\n\n  // Register Gemini chat routes\n  registerChatRoutes(app);\n\n  // ==================\n  // COLLABORATION\n  // ==================\n  app.get(\"/api/cases/:id/presence\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.id);\n      const users = collaborationService.getCasePresence(caseId);\n      res.json({ users });\n    } catch (error) {\n      console.error(\"Error fetching presence:\", error);\n      res.status(500).json({ error: \"Failed to fetch presence\" });\n    }\n  });\n\n  // ==================\n  // VIDEO CONFERENCING\n  // ==================\n  app.post(\"/api/cases/:caseId/video-room\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const { userId, userName } = req.body;\n\n      if (!userId || !userName) {\n        return res.status(400).json({ error: \"userId and userName are required\" });\n      }\n\n      // Check if DAILY_API_KEY is configured\n      if (!process.env.DAILY_API_KEY) {\n        return res.status(500).json({ error: \"Video conferencing is not configured. DAILY_API_KEY is missing.\" });\n      }\n\n      const room = await getOrCreateRoom(caseId);\n      addParticipant(caseId, userId, userName);\n\n      res.json({ \n        url: room.roomUrl,\n        roomName: room.roomName,\n        participants: getRoomParticipants(caseId),\n      });\n    } catch (error) {\n      console.error(\"Error creating video room:\", error);\n      res.status(500).json({ error: \"Failed to create video room\" });\n    }\n  });\n\n  app.get(\"/api/cases/:caseId/video-room\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const participants = getRoomParticipants(caseId);\n      res.json({ participants, active: participants.length > 0 });\n    } catch (error) {\n      console.error(\"Error fetching video room:\", error);\n      res.status(500).json({ error: \"Failed to fetch video room\" });\n    }\n  });\n\n  app.delete(\"/api/cases/:caseId/video-room\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const { userId } = req.body;\n\n      if (!userId) {\n        return res.status(400).json({ error: \"userId is required\" });\n      }\n\n      await removeParticipant(caseId, userId);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error leaving video room:\", error);\n      res.status(500).json({ error: \"Failed to leave video room\" });\n    }\n  });\n\n  // ==================\n  // CASES\n  // ==================\n  app.get(\"/api/cases\", async (req: Request, res: Response) => {\n    try {\n      const cases = await storage.getAllCases();\n      \n      // Get file counts for each case\n      const casesWithCounts = await Promise.all(\n        cases.map(async (c) => {\n          const files = await storage.getDiscoveryFilesByCase(c.id);\n          return {\n            ...c,\n            filesCount: files.length,\n            lastActivity: c.updatedAt,\n          };\n        })\n      );\n\n      res.json(casesWithCounts);\n    } catch (error) {\n      console.error(\"Error fetching cases:\", error);\n      res.status(500).json({ error: \"Failed to fetch cases\" });\n    }\n  });\n\n  app.get(\"/api/cases/:id\", async (req: Request, res: Response) => {\n    try {\n      const id = parseInt(req.params.id);\n      const caseData = await storage.getCase(id);\n\n      if (!caseData) {\n        return res.status(404).json({ error: \"Case not found\" });\n      }\n\n      const files = await storage.getDiscoveryFilesByCase(id);\n      res.json({\n        ...caseData,\n        filesCount: files.length,\n      });\n    } catch (error) {\n      console.error(\"Error fetching case:\", error);\n      res.status(500).json({ error: \"Failed to fetch case\" });\n    }\n  });\n\n  app.post(\"/api/cases\", async (req: Request, res: Response) => {\n    try {\n      const validatedData = caseIntakeSchema.parse(req.body);\n      // Add default status for new cases\n      const newCase = await storage.createCase({\n        ...validatedData,\n        status: \"active\",\n      });\n      res.status(201).json(newCase);\n    } catch (error) {\n      console.error(\"Error creating case:\", error);\n      res.status(400).json({ error: \"Failed to create case\" });\n    }\n  });\n\n  app.patch(\"/api/cases/:id\", async (req: Request, res: Response) => {\n    try {\n      const id = parseInt(req.params.id);\n      const updated = await storage.updateCase(id, req.body);\n\n      if (!updated) {\n        return res.status(404).json({ error: \"Case not found\" });\n      }\n\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error updating case:\", error);\n      res.status(400).json({ error: \"Failed to update case\" });\n    }\n  });\n\n  app.put(\"/api/cases/:id\", async (req: Request, res: Response) => {\n    try {\n      const id = parseInt(req.params.id);\n      const updated = await storage.updateCase(id, req.body);\n\n      if (!updated) {\n        return res.status(404).json({ error: \"Case not found\" });\n      }\n\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error updating case:\", error);\n      res.status(400).json({ error: \"Failed to update case\" });\n    }\n  });\n\n  app.delete(\"/api/cases/:id\", async (req: Request, res: Response) => {\n    try {\n      const id = parseInt(req.params.id);\n      const existing = await storage.getCase(id);\n\n      if (!existing) {\n        return res.status(404).json({ error: \"Case not found\" });\n      }\n\n      await storage.deleteCase(id);\n      res.json({ success: true, message: \"Case deleted successfully\" });\n    } catch (error) {\n      console.error(\"Error deleting case:\", error);\n      res.status(500).json({ error: \"Failed to delete case\" });\n    }\n  });\n\n  app.get(\"/api/cases/:id/export\", async (req: Request, res: Response) => {\n    try {\n      const id = parseInt(req.params.id);\n      const caseData = await storage.getCase(id);\n\n      if (!caseData) {\n        return res.status(404).json({ error: \"Case not found\" });\n      }\n\n      const files = await storage.getDiscoveryFilesByCase(id);\n      const timeline = await storage.getTimelineEventsByCase(id);\n      const briefs = await storage.getLegalBriefsByCase(id);\n      const depositions = await storage.getDepositionPrepByCase(id);\n\n      const exportData = {\n        case: caseData,\n        discoveryFiles: files,\n        timeline,\n        legalBriefs: briefs,\n        depositionPrep: depositions,\n        exportedAt: new Date().toISOString(),\n      };\n\n      res.setHeader(\"Content-Type\", \"application/json\");\n      res.setHeader(\"Content-Disposition\", `attachment; filename=\"${caseData.caseNumber}-export.json\"`);\n      res.json(exportData);\n    } catch (error) {\n      console.error(\"Error exporting case:\", error);\n      res.status(500).json({ error: \"Failed to export case\" });\n    }\n  });\n\n  // ==================\n  // DISCOVERY FILES\n  // ==================\n  app.get(\"/api/cases/:caseId/discovery\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const files = await storage.getDiscoveryFilesByCase(caseId);\n      res.json(files);\n    } catch (error) {\n      console.error(\"Error fetching discovery files:\", error);\n      res.status(500).json({ error: \"Failed to fetch discovery files\" });\n    }\n  });\n\n  app.post(\"/api/cases/:caseId/discovery/upload\", upload.single(\"file\"), async (req: Request, res: Response) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ error: \"No file uploaded\" });\n      }\n\n      const caseId = parseInt(req.params.caseId);\n      const file = req.file;\n      const { batesStart, batesEnd } = req.body;\n\n      // Process file based on type\n      let processed;\n      const mimeType = file.mimetype;\n\n      if (mimeType === \"application/pdf\") {\n        processed = await processPDF(file.path, file.originalname);\n      } else if (mimeType.startsWith(\"audio/\") || mimeType.startsWith(\"video/\")) {\n        processed = await processMediaFile(file.path, file.originalname, mimeType);\n      } else if (mimeType.startsWith(\"image/\")) {\n        processed = await processImage(file.path, file.originalname);\n      } else {\n        // Generic text processing\n        processed = {\n          extractedText: \"\",\n          summary: \"File uploaded\",\n          relevance: \"medium\" as const,\n          tags: [\"uploaded\"],\n          extractedDates: [],\n          metadata: { mimeType },\n        };\n      }\n\n      // Save to database\n      const discoveryFile = await storage.createDiscoveryFile({\n        caseId,\n        batesStart: batesStart || `AUTO-${Date.now()}`,\n        batesEnd: batesEnd || `AUTO-${Date.now()}`,\n        fileName: file.originalname,\n        fileType: mimeType,\n        filePath: file.path,\n        fileSize: file.size,\n        relevance: processed.relevance,\n        tags: processed.tags,\n        summary: processed.summary,\n        extractedText: processed.extractedText,\n        extractedDates: processed.extractedDates,\n        metadata: processed.metadata,\n        sourceType: \"upload\",\n      });\n\n      // Notify collaborators about new file\n      collaborationService.notifyCaseUpdate(caseId, \"discovery\", { fileId: discoveryFile.id });\n\n      res.status(201).json(discoveryFile);\n    } catch (error) {\n      console.error(\"Error uploading file:\", error);\n      res.status(500).json({ error: \"Failed to process file\" });\n    }\n  });\n\n  // ==================\n  // TIMELINE\n  // ==================\n  app.get(\"/api/cases/:caseId/timeline\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const events = await storage.getTimelineEventsByCase(caseId);\n      res.json(events);\n    } catch (error) {\n      console.error(\"Error fetching timeline:\", error);\n      res.status(500).json({ error: \"Failed to fetch timeline\" });\n    }\n  });\n\n  app.post(\"/api/cases/:caseId/timeline/generate\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n\n      // Generate timeline using AI\n      const events = await generateTimelineFromDocuments(caseId);\n\n      // Save events to database\n      const savedEvents = await Promise.all(\n        events.map((event) =>\n          storage.createTimelineEvent({\n            caseId,\n            eventDate: new Date(event.eventDate),\n            title: event.title,\n            description: event.description,\n            eventType: event.eventType,\n            linkedBates: event.linkedBates,\n            metadata: {},\n          })\n        )\n      );\n\n      // Notify collaborators about timeline update\n      collaborationService.notifyCaseUpdate(caseId, \"timeline\", { count: savedEvents.length });\n\n      res.json(savedEvents);\n    } catch (error) {\n      console.error(\"Error generating timeline:\", error);\n      res.status(500).json({ error: \"Failed to generate timeline\" });\n    }\n  });\n\n  // ==================\n  // DEPOSITION PREP\n  // ==================\n  app.get(\"/api/cases/:caseId/deposition\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const preps = await storage.getDepositionPrepByCase(caseId);\n      res.json(preps);\n    } catch (error) {\n      console.error(\"Error fetching deposition prep:\", error);\n      res.status(500).json({ error: \"Failed to fetch deposition prep\" });\n    }\n  });\n\n  app.post(\"/api/cases/:caseId/deposition/generate\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const { witnessName, depositionType } = req.body;\n\n      if (!witnessName || !depositionType) {\n        return res.status(400).json({ error: \"witnessName and depositionType required\" });\n      }\n\n      // Generate questions using AI\n      const result = await generateDepositionQuestions(caseId, witnessName, depositionType);\n\n      // Save to database\n      const prep = await storage.createDepositionPrep({\n        caseId,\n        depositionType,\n        targetWitness: witnessName,\n        questions: result.questions,\n        strategy: result.strategy,\n        linkedEvidence: result.questions.flatMap((q) => q.linkedBates || []),\n      });\n\n      // Notify collaborators about deposition prep\n      collaborationService.notifyCaseUpdate(caseId, \"deposition\", { prepId: prep.id });\n\n      res.json(prep);\n    } catch (error) {\n      console.error(\"Error generating deposition prep:\", error);\n      res.status(500).json({ error: \"Failed to generate deposition prep\" });\n    }\n  });\n\n  // ==================\n  // SUGGESTED FILINGS\n  // ==================\n  app.get(\"/api/cases/:caseId/filings\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const filings = await storage.getSuggestedFilingsByCase(caseId);\n      res.json(filings);\n    } catch (error) {\n      console.error(\"Error fetching filings:\", error);\n      res.status(500).json({ error: \"Failed to fetch filings\" });\n    }\n  });\n\n  app.post(\"/api/cases/:caseId/filings/generate\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n\n      // Generate filing suggestions using AI\n      const suggestions = await suggestNextFilings(caseId);\n\n      // Save to database\n      const savedFilings = await Promise.all(\n        suggestions.map((filing) =>\n          storage.createSuggestedFiling({\n            caseId,\n            filingType: filing.filingType,\n            title: filing.title,\n            description: filing.description,\n            deadline: filing.deadline ? new Date(filing.deadline) : null,\n            priority: filing.priority,\n            reasoning: filing.reasoning,\n            status: \"pending\",\n          })\n        )\n      );\n\n      res.json(savedFilings);\n    } catch (error) {\n      console.error(\"Error generating filings:\", error);\n      res.status(500).json({ error: \"Failed to generate filing suggestions\" });\n    }\n  });\n\n  // ==================\n  // GOOGLE DRIVE INTEGRATION\n  // ==================\n\n  // List Google Drive folders\n  app.get(\"/api/drive/folders\", async (req: Request, res: Response) => {\n    try {\n      const parentId = req.query.parentId as string | undefined;\n      const folders = await listFolders(parentId);\n      res.json(folders);\n    } catch (error: any) {\n      console.error(\"Error listing Drive folders:\", error);\n      if (error.message?.includes(\"not connected\")) {\n        return res.status(401).json({ error: \"Google Drive not connected\" });\n      }\n      res.status(500).json({ error: \"Failed to list folders\" });\n    }\n  });\n\n  // Get cloud folders linked to a case\n  app.get(\"/api/cases/:caseId/cloud-folders\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const folders = await storage.getCloudFoldersByCase(caseId);\n      res.json(folders);\n    } catch (error) {\n      console.error(\"Error fetching cloud folders:\", error);\n      res.status(500).json({ error: \"Failed to fetch cloud folders\" });\n    }\n  });\n\n  // Link a Google Drive folder to a case\n  app.post(\"/api/cases/:caseId/cloud-folders\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const { folderId, folderName, batesPrefix } = req.body;\n\n      if (!folderId || !folderName || !batesPrefix) {\n        return res.status(400).json({ error: \"folderId, folderName, and batesPrefix are required\" });\n      }\n\n      const cloudFolder = await storage.createCloudFolder({\n        caseId,\n        provider: \"google_drive\",\n        folderId,\n        folderName,\n        batesPrefix,\n        nextBatesNumber: 1,\n      });\n\n      res.status(201).json(cloudFolder);\n    } catch (error) {\n      console.error(\"Error linking cloud folder:\", error);\n      res.status(500).json({ error: \"Failed to link cloud folder\" });\n    }\n  });\n\n  // Sync a cloud folder - imports all files with Bates numbers\n  app.post(\"/api/cloud-folders/:folderId/sync\", async (req: Request, res: Response) => {\n    try {\n      const folderId = parseInt(req.params.folderId);\n      const cloudFolder = await storage.getCloudFolder(folderId);\n\n      if (!cloudFolder) {\n        return res.status(404).json({ error: \"Cloud folder not found\" });\n      }\n\n      // List all files in the Google Drive folder\n      const driveFiles = await listFilesInFolder(cloudFolder.folderId);\n\n      const importedFiles: any[] = [];\n      let batesCounter = cloudFolder.nextBatesNumber;\n\n      for (const driveFile of driveFiles) {\n        // Check if file already imported\n        const existingFile = await storage.getDiscoveryFileByCloudId(driveFile.id);\n        if (existingFile) {\n          importedFiles.push(existingFile);\n          continue;\n        }\n\n        // Generate Bates number\n        const batesNumber = `${cloudFolder.batesPrefix}-${String(batesCounter).padStart(5, \"0\")}`;\n        batesCounter++;\n\n        // Determine file type category\n        let fileCategory = \"document\";\n        if (driveFile.mimeType.startsWith(\"image/\")) fileCategory = \"image\";\n        if (driveFile.mimeType.startsWith(\"video/\")) fileCategory = \"video\";\n        if (driveFile.mimeType.startsWith(\"audio/\")) fileCategory = \"audio\";\n        if (driveFile.mimeType === \"application/pdf\") fileCategory = \"pdf\";\n\n        // Create discovery file entry (reference only - no local file storage)\n        const discoveryFile = await storage.createDiscoveryFile({\n          caseId: cloudFolder.caseId,\n          batesStart: batesNumber,\n          batesEnd: batesNumber,\n          fileName: driveFile.name,\n          fileType: driveFile.mimeType,\n          filePath: null,\n          fileSize: driveFile.size ? parseInt(driveFile.size) : null,\n          relevance: \"medium\",\n          tags: [\"cloud-import\", fileCategory],\n          summary: `Imported from Google Drive: ${driveFile.name}`,\n          extractedText: null,\n          extractedDates: null,\n          metadata: {\n            cloudFileId: driveFile.id,\n            cloudProvider: \"google_drive\",\n            originalName: driveFile.name,\n            createdTime: driveFile.createdTime,\n            modifiedTime: driveFile.modifiedTime,\n          },\n          sourceType: \"cloud\",\n          cloudFileId: driveFile.id,\n          cloudProvider: \"google_drive\",\n          driveUrl: driveFile.webViewLink || `https://drive.google.com/file/d/${driveFile.id}/view`,\n        });\n\n        importedFiles.push(discoveryFile);\n      }\n\n      // Update the cloud folder's next Bates number\n      await storage.updateCloudFolder(folderId, {\n        nextBatesNumber: batesCounter,\n      });\n\n      res.json({\n        message: `Synced ${importedFiles.length} files`,\n        files: importedFiles,\n        nextBatesNumber: batesCounter,\n      });\n    } catch (error: any) {\n      console.error(\"Error syncing cloud folder:\", error);\n      if (error.message?.includes(\"not connected\")) {\n        return res.status(401).json({ error: \"Google Drive not connected\" });\n      }\n      res.status(500).json({ error: \"Failed to sync cloud folder\" });\n    }\n  });\n\n  // Delete a cloud folder link\n  app.delete(\"/api/cloud-folders/:folderId\", async (req: Request, res: Response) => {\n    try {\n      const folderId = parseInt(req.params.folderId);\n      await storage.deleteCloudFolder(folderId);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting cloud folder:\", error);\n      res.status(500).json({ error: \"Failed to delete cloud folder\" });\n    }\n  });\n\n  // ==================\n  // NEWS ARTICLES\n  // ==================\n  const { getLatestNews, getFeaturedNews, fetchAndCacheNews } = await import(\"./services/newsAggregator\");\n\n  app.get(\"/api/news/latest\", async (req: Request, res: Response) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 3;\n      const articles = await getLatestNews(limit);\n      res.json(articles);\n    } catch (error) {\n      console.error(\"Error fetching latest news:\", error);\n      res.status(500).json({ error: \"Failed to fetch news\" });\n    }\n  });\n\n  app.get(\"/api/news/featured\", async (req: Request, res: Response) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 2;\n      const articles = await getFeaturedNews(limit);\n      res.json(articles);\n    } catch (error) {\n      console.error(\"Error fetching featured news:\", error);\n      res.status(500).json({ error: \"Failed to fetch featured news\" });\n    }\n  });\n\n  app.post(\"/api/news/refresh\", async (req: Request, res: Response) => {\n    try {\n      await fetchAndCacheNews();\n      res.json({ success: true, message: \"News refreshed\" });\n    } catch (error) {\n      console.error(\"Error refreshing news:\", error);\n      res.status(500).json({ error: \"Failed to refresh news\" });\n    }\n  });\n\n  // ==================\n  // LEGAL BRIEFS\n  // ==================\n  const { generateLegalBrief, getBriefTypes } = await import(\"./services/briefGenerator\");\n\n  app.get(\"/api/cases/:caseId/briefs\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const briefs = await storage.getLegalBriefsByCase(caseId);\n      res.json(briefs);\n    } catch (error) {\n      console.error(\"Error fetching legal briefs:\", error);\n      res.status(500).json({ error: \"Failed to fetch legal briefs\" });\n    }\n  });\n\n  app.get(\"/api/briefs/types\", async (req: Request, res: Response) => {\n    try {\n      const types = getBriefTypes();\n      res.json(types);\n    } catch (error) {\n      console.error(\"Error fetching brief types:\", error);\n      res.status(500).json({ error: \"Failed to fetch brief types\" });\n    }\n  });\n\n  app.get(\"/api/briefs/:briefId\", async (req: Request, res: Response) => {\n    try {\n      const briefId = parseInt(req.params.briefId);\n      const brief = await storage.getLegalBrief(briefId);\n      if (!brief) {\n        return res.status(404).json({ error: \"Brief not found\" });\n      }\n      res.json(brief);\n    } catch (error) {\n      console.error(\"Error fetching legal brief:\", error);\n      res.status(500).json({ error: \"Failed to fetch legal brief\" });\n    }\n  });\n\n  app.post(\"/api/cases/:caseId/briefs/generate\", async (req: Request, res: Response) => {\n    try {\n      const caseId = parseInt(req.params.caseId);\n      const { briefType, title, additionalInstructions } = req.body;\n      \n      if (!briefType || !title) {\n        return res.status(400).json({ error: \"Brief type and title are required\" });\n      }\n\n      const brief = await generateLegalBrief({\n        caseId,\n        briefType,\n        title,\n        additionalInstructions,\n      });\n\n      // Notify collaborators about new brief\n      collaborationService.notifyCaseUpdate(caseId, \"briefs\", { briefId: brief.id });\n\n      res.json(brief);\n    } catch (error) {\n      console.error(\"Error generating legal brief:\", error);\n      res.status(500).json({ error: \"Failed to generate legal brief\" });\n    }\n  });\n\n  app.put(\"/api/briefs/:briefId\", async (req: Request, res: Response) => {\n    try {\n      const briefId = parseInt(req.params.briefId);\n      const { content, title, status } = req.body;\n      \n      const updated = await storage.updateLegalBrief(briefId, {\n        content,\n        title,\n        status,\n      });\n\n      if (!updated) {\n        return res.status(404).json({ error: \"Brief not found\" });\n      }\n\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error updating legal brief:\", error);\n      res.status(500).json({ error: \"Failed to update legal brief\" });\n    }\n  });\n\n  app.delete(\"/api/briefs/:briefId\", async (req: Request, res: Response) => {\n    try {\n      const briefId = parseInt(req.params.briefId);\n      await storage.deleteLegalBrief(briefId);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting legal brief:\", error);\n      res.status(500).json({ error: \"Failed to delete legal brief\" });\n    }\n  });\n\n  return httpServer;\n}\n","path":null,"size_bytes":25221,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1148,"size_tokens":null},"server/services/newsAggregator.ts":{"content":"import Parser from \"rss-parser\";\nimport { db } from \"../db\";\nimport { newsArticles } from \"@shared/schema\";\nimport { desc, eq } from \"drizzle-orm\";\n\nconst parser = new Parser({\n  customFields: {\n    item: [\n      [\"media:content\", \"media\"],\n      [\"content:encoded\", \"contentEncoded\"],\n    ],\n  },\n});\n\nconst RSS_FEED_URL = \"https://www.wtpnews.org/feed/\";\nconst REFRESH_INTERVAL_MS = 30 * 60 * 1000;\n\ninterface FeedItem {\n  title?: string;\n  link?: string;\n  contentSnippet?: string;\n  content?: string;\n  pubDate?: string;\n  enclosure?: { url?: string };\n  media?: { $?: { url?: string } };\n}\n\nfunction extractImageUrl(item: FeedItem): string | null {\n  if (item.enclosure?.url) return item.enclosure.url;\n  if (item.media?.$?.url) return item.media.$.url;\n  const imgMatch = (item.content || \"\").match(/<img[^>]+src=\"([^\"]+)\"/);\n  if (imgMatch) return imgMatch[1];\n  return null;\n}\n\nfunction extractSummary(item: FeedItem): string {\n  let summary = item.contentSnippet || item.content || \"\";\n  summary = summary.replace(/<[^>]+>/g, \"\").trim();\n  if (summary.length > 250) {\n    summary = summary.substring(0, 247) + \"...\";\n  }\n  return summary;\n}\n\nexport async function fetchAndCacheNews(): Promise<void> {\n  try {\n    console.log(\"[NewsAggregator] Fetching RSS feed from wtpnews.org...\");\n    const feed = await parser.parseURL(RSS_FEED_URL);\n    \n    if (!feed.items || feed.items.length === 0) {\n      console.log(\"[NewsAggregator] No items found in feed\");\n      return;\n    }\n\n    console.log(`[NewsAggregator] Found ${feed.items.length} articles`);\n\n    for (let i = 0; i < feed.items.length; i++) {\n      const item = feed.items[i] as FeedItem;\n      if (!item.link || !item.title) continue;\n\n      const isFeatured = i < 2;\n\n      try {\n        await db\n          .insert(newsArticles)\n          .values({\n            url: item.link,\n            title: item.title,\n            summary: extractSummary(item),\n            imageUrl: extractImageUrl(item),\n            publishedAt: item.pubDate ? new Date(item.pubDate) : null,\n            featured: isFeatured,\n            source: \"wtpnews\",\n            fetchedAt: new Date(),\n          })\n          .onConflictDoUpdate({\n            target: newsArticles.url,\n            set: {\n              title: item.title,\n              summary: extractSummary(item),\n              imageUrl: extractImageUrl(item),\n              featured: isFeatured,\n              fetchedAt: new Date(),\n            },\n          });\n      } catch (err) {\n        console.error(`[NewsAggregator] Error saving article: ${item.title}`, err);\n      }\n    }\n\n    console.log(\"[NewsAggregator] News cache updated successfully\");\n  } catch (error) {\n    console.error(\"[NewsAggregator] Error fetching RSS feed:\", error);\n  }\n}\n\nexport async function getLatestNews(limit: number = 3) {\n  return db\n    .select()\n    .from(newsArticles)\n    .orderBy(desc(newsArticles.publishedAt))\n    .limit(limit);\n}\n\nexport async function getFeaturedNews(limit: number = 2) {\n  return db\n    .select()\n    .from(newsArticles)\n    .where(eq(newsArticles.featured, true))\n    .orderBy(desc(newsArticles.publishedAt))\n    .limit(limit);\n}\n\nexport function startNewsRefreshScheduler(): void {\n  fetchAndCacheNews();\n  setInterval(() => {\n    fetchAndCacheNews();\n  }, REFRESH_INTERVAL_MS);\n  console.log(`[NewsAggregator] Scheduler started (refresh every ${REFRESH_INTERVAL_MS / 60000} minutes)`);\n}\n","path":null,"size_bytes":3405,"size_tokens":null},"client/src/components/ui/empty.tsx":{"content":"import { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Empty({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty\"\n      className={cn(\n        \"flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-header\"\n      className={cn(\n        \"flex max-w-sm flex-col items-center gap-2 text-center\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst emptyMediaVariants = cva(\n  \"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction EmptyMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof emptyMediaVariants>) {\n  return (\n    <div\n      data-slot=\"empty-icon\"\n      data-variant={variant}\n      className={cn(emptyMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-title\"\n      className={cn(\"text-lg font-medium tracking-tight\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <div\n      data-slot=\"empty-description\"\n      className={cn(\n        \"text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-content\"\n      className={cn(\n        \"flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Empty,\n  EmptyHeader,\n  EmptyTitle,\n  EmptyDescription,\n  EmptyContent,\n  EmptyMedia,\n}\n","path":null,"size_bytes":2396,"size_tokens":null},"client/src/components/ui/button-group.tsx":{"content":"import { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nconst buttonGroupVariants = cva(\n  \"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1\",\n  {\n    variants: {\n      orientation: {\n        horizontal:\n          \"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none\",\n        vertical:\n          \"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none\",\n      },\n    },\n    defaultVariants: {\n      orientation: \"horizontal\",\n    },\n  }\n)\n\nfunction ButtonGroup({\n  className,\n  orientation,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof buttonGroupVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"button-group\"\n      data-orientation={orientation}\n      className={cn(buttonGroupVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupText({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  asChild?: boolean\n}) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      className={cn(\n        \"bg-muted shadow-xs flex items-center gap-2 rounded-md border px-4 text-sm font-medium [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupSeparator({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"button-group-separator\"\n      orientation={orientation}\n      className={cn(\n        \"bg-input relative !m-0 self-stretch data-[orientation=vertical]:h-auto\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  ButtonGroup,\n  ButtonGroupSeparator,\n  ButtonGroupText,\n  buttonGroupVariants,\n}\n","path":null,"size_bytes":2209,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1037,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5745,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport tailwindcss from \"@tailwindcss/vite\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { metaImagesPlugin } from \"./vite-plugin-meta-images\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    tailwindcss(),\n    metaImagesPlugin(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  css: {\n    postcss: {\n      plugins: [],\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: \"0.0.0.0\",\n    allowedHosts: true,\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1330,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // @replit\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \",\n  {\n    variants: {\n      variant: {\n        default:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary:\n          // @replit no hover because we use hover-elevate\n          \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n          // @replit shadow-xs\" - use badge outline variable\n        outline: \"text-foreground border [border-color:var(--badge-outline)]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1522,"size_tokens":null},"server/seed.ts":{"content":"export async function seedDatabase() {\n  console.log(\"Database ready - no demo data loaded\");\n}\n","path":null,"size_bytes":96,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1410,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2859,"size_tokens":null},"vite-plugin-meta-images.ts":{"content":"import type { Plugin } from 'vite';\nimport fs from 'fs';\nimport path from 'path';\n\n/**\n * Vite plugin that updates og:image and twitter:image meta tags\n * to point to the app's opengraph image with the correct Replit domain.\n */\nexport function metaImagesPlugin(): Plugin {\n  return {\n    name: 'vite-plugin-meta-images',\n    transformIndexHtml(html) {\n      const baseUrl = getDeploymentUrl();\n      if (!baseUrl) {\n        log('[meta-images] no Replit deployment domain found, skipping meta tag updates');\n        return html;\n      }\n\n      // Check if opengraph image exists in public directory\n      const publicDir = path.resolve(process.cwd(), 'client', 'public');\n      const opengraphPngPath = path.join(publicDir, 'opengraph.png');\n      const opengraphJpgPath = path.join(publicDir, 'opengraph.jpg');\n      const opengraphJpegPath = path.join(publicDir, 'opengraph.jpeg');\n\n      let imageExt: string | null = null;\n      if (fs.existsSync(opengraphPngPath)) {\n        imageExt = 'png';\n      } else if (fs.existsSync(opengraphJpgPath)) {\n        imageExt = 'jpg';\n      } else if (fs.existsSync(opengraphJpegPath)) {\n        imageExt = 'jpeg';\n      }\n\n      if (!imageExt) {\n        log('[meta-images] OpenGraph image not found, skipping meta tag updates');\n        return html;\n      }\n\n      const imageUrl = `${baseUrl}/opengraph.${imageExt}`;\n\n      log('[meta-images] updating meta image tags to:', imageUrl);\n\n      html = html.replace(\n        /<meta\\s+property=\"og:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta property=\"og:image\" content=\"${imageUrl}\" />`\n      );\n\n      html = html.replace(\n        /<meta\\s+name=\"twitter:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta name=\"twitter:image\" content=\"${imageUrl}\" />`\n      );\n\n      return html;\n    },\n  };\n}\n\nfunction getDeploymentUrl(): string | null {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    log('[meta-images] using internal app domain:', url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    log('[meta-images] using dev domain:', url);\n    return url;\n  }\n\n  return null;\n}\n\nfunction log(...args: any[]): void {\n  if (process.env.NODE_ENV === 'production') {\n    console.log(...args);\n  }\n}\n","path":null,"size_bytes":2333,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1828,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/pages/settings.tsx":{"content":"import { Layout } from \"@/components/layout\";\nimport { \n  User, \n  Bell, \n  Palette,\n  Database,\n  Cloud,\n  Key,\n  Save,\n  Check,\n  Shield\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useState, useEffect } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface UserSettings {\n  profile: {\n    firstName: string;\n    lastName: string;\n    email: string;\n    firm: string;\n    barNumber: string;\n  };\n  notifications: {\n    deadlineReminders: boolean;\n    documentUpdates: boolean;\n    aiComplete: boolean;\n    collabUpdates: boolean;\n    reminderTiming: string;\n  };\n  appearance: {\n    theme: string;\n    compactMode: boolean;\n    animations: boolean;\n  };\n}\n\nconst defaultSettings: UserSettings = {\n  profile: {\n    firstName: \"\",\n    lastName: \"\",\n    email: \"\",\n    firm: \"\",\n    barNumber: \"\",\n  },\n  notifications: {\n    deadlineReminders: true,\n    documentUpdates: true,\n    aiComplete: true,\n    collabUpdates: false,\n    reminderTiming: \"3days\",\n  },\n  appearance: {\n    theme: \"system\",\n    compactMode: false,\n    animations: true,\n  },\n};\n\nconst SETTINGS_KEY = \"casebuddy_settings\";\n\nfunction loadSettings(): UserSettings {\n  try {\n    const stored = localStorage.getItem(SETTINGS_KEY);\n    if (stored) {\n      return { ...defaultSettings, ...JSON.parse(stored) };\n    }\n  } catch (e) {\n    console.error(\"Failed to load settings:\", e);\n  }\n  return defaultSettings;\n}\n\nfunction saveSettings(settings: UserSettings): void {\n  try {\n    localStorage.setItem(SETTINGS_KEY, JSON.stringify(settings));\n  } catch (e) {\n    console.error(\"Failed to save settings:\", e);\n  }\n}\n\nexport default function SettingsPage() {\n  const { toast } = useToast();\n  const [saved, setSaved] = useState(false);\n  const [settings, setSettings] = useState<UserSettings>(defaultSettings);\n\n  useEffect(() => {\n    setSettings(loadSettings());\n  }, []);\n\n  const updateProfile = (field: keyof UserSettings[\"profile\"], value: string) => {\n    setSettings((prev) => ({\n      ...prev,\n      profile: { ...prev.profile, [field]: value },\n    }));\n  };\n\n  const updateNotifications = (field: keyof UserSettings[\"notifications\"], value: boolean | string) => {\n    setSettings((prev) => ({\n      ...prev,\n      notifications: { ...prev.notifications, [field]: value },\n    }));\n  };\n\n  const updateAppearance = (field: keyof UserSettings[\"appearance\"], value: boolean | string) => {\n    setSettings((prev) => ({\n      ...prev,\n      appearance: { ...prev.appearance, [field]: value },\n    }));\n  };\n\n  const handleSave = () => {\n    saveSettings(settings);\n    setSaved(true);\n    toast({ title: \"Settings saved successfully\" });\n    setTimeout(() => setSaved(false), 2000);\n  };\n\n  return (\n    <Layout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-2xl md:text-3xl font-serif font-bold text-primary\" data-testid=\"text-page-title\">Settings</h1>\n          <p className=\"text-muted-foreground mt-1\">Manage your account and application preferences</p>\n        </div>\n\n        <Tabs defaultValue=\"profile\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full md:w-auto md:inline-grid grid-cols-2 md:grid-cols-4 gap-1\">\n            <TabsTrigger value=\"profile\" className=\"gap-2\">\n              <User className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Profile</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"notifications\" className=\"gap-2\">\n              <Bell className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Notifications</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"appearance\" className=\"gap-2\">\n              <Palette className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Appearance</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"integrations\" className=\"gap-2\">\n              <Cloud className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Integrations</span>\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"profile\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Profile Information</CardTitle>\n                <CardDescription>Update your personal information and contact details</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"firstName\">First Name</Label>\n                    <Input\n                      id=\"firstName\"\n                      placeholder=\"John\"\n                      value={settings.profile.firstName}\n                      onChange={(e) => updateProfile(\"firstName\", e.target.value)}\n                      data-testid=\"input-first-name\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"lastName\">Last Name</Label>\n                    <Input\n                      id=\"lastName\"\n                      placeholder=\"Doe\"\n                      value={settings.profile.lastName}\n                      onChange={(e) => updateProfile(\"lastName\", e.target.value)}\n                      data-testid=\"input-last-name\"\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\">Email</Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    placeholder=\"john.doe@lawfirm.com\"\n                    value={settings.profile.email}\n                    onChange={(e) => updateProfile(\"email\", e.target.value)}\n                    data-testid=\"input-email\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"firm\">Law Firm / Organization</Label>\n                  <Input\n                    id=\"firm\"\n                    placeholder=\"Smith & Associates LLP\"\n                    value={settings.profile.firm}\n                    onChange={(e) => updateProfile(\"firm\", e.target.value)}\n                    data-testid=\"input-firm\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"barNumber\">Bar Number</Label>\n                  <Input\n                    id=\"barNumber\"\n                    placeholder=\"123456\"\n                    value={settings.profile.barNumber}\n                    onChange={(e) => updateProfile(\"barNumber\", e.target.value)}\n                    data-testid=\"input-bar-number\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Shield className=\"w-5 h-5\" />\n                  Security\n                </CardTitle>\n                <CardDescription>Password changes require user authentication (coming soon)</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <p className=\"text-sm text-muted-foreground\">\n                  User authentication is not yet implemented. Password and security settings will be available once authentication is added.\n                </p>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"notifications\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Email Notifications</CardTitle>\n                <CardDescription>Choose what notifications you want to receive</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label>Deadline Reminders</Label>\n                    <p className=\"text-sm text-muted-foreground\">Get notified before important deadlines</p>\n                  </div>\n                  <Switch\n                    checked={settings.notifications.deadlineReminders}\n                    onCheckedChange={(checked) => updateNotifications(\"deadlineReminders\", checked)}\n                    data-testid=\"switch-deadline-reminders\"\n                  />\n                </div>\n                <Separator />\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label>Document Updates</Label>\n                    <p className=\"text-sm text-muted-foreground\">Notifications when documents are processed</p>\n                  </div>\n                  <Switch\n                    checked={settings.notifications.documentUpdates}\n                    onCheckedChange={(checked) => updateNotifications(\"documentUpdates\", checked)}\n                    data-testid=\"switch-document-updates\"\n                  />\n                </div>\n                <Separator />\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label>AI Analysis Complete</Label>\n                    <p className=\"text-sm text-muted-foreground\">Get notified when AI analysis is done</p>\n                  </div>\n                  <Switch\n                    checked={settings.notifications.aiComplete}\n                    onCheckedChange={(checked) => updateNotifications(\"aiComplete\", checked)}\n                    data-testid=\"switch-ai-complete\"\n                  />\n                </div>\n                <Separator />\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label>Collaboration Updates</Label>\n                    <p className=\"text-sm text-muted-foreground\">When team members make changes to cases</p>\n                  </div>\n                  <Switch\n                    checked={settings.notifications.collabUpdates}\n                    onCheckedChange={(checked) => updateNotifications(\"collabUpdates\", checked)}\n                    data-testid=\"switch-collab-updates\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Reminder Timing</CardTitle>\n                <CardDescription>When to send deadline reminders</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <Label>Send reminders</Label>\n                  <Select\n                    value={settings.notifications.reminderTiming}\n                    onValueChange={(value) => updateNotifications(\"reminderTiming\", value)}\n                  >\n                    <SelectTrigger data-testid=\"select-reminder-timing\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"1day\">1 day before</SelectItem>\n                      <SelectItem value=\"3days\">3 days before</SelectItem>\n                      <SelectItem value=\"1week\">1 week before</SelectItem>\n                      <SelectItem value=\"2weeks\">2 weeks before</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"appearance\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Theme</CardTitle>\n                <CardDescription>Customize the appearance of the application</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Color Theme</Label>\n                  <Select\n                    value={settings.appearance.theme}\n                    onValueChange={(value) => updateAppearance(\"theme\", value)}\n                  >\n                    <SelectTrigger data-testid=\"select-theme\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"light\">Light</SelectItem>\n                      <SelectItem value=\"dark\">Dark</SelectItem>\n                      <SelectItem value=\"system\">System</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <Separator />\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label>Compact Mode</Label>\n                    <p className=\"text-sm text-muted-foreground\">Reduce spacing for more content on screen</p>\n                  </div>\n                  <Switch\n                    checked={settings.appearance.compactMode}\n                    onCheckedChange={(checked) => updateAppearance(\"compactMode\", checked)}\n                    data-testid=\"switch-compact-mode\"\n                  />\n                </div>\n                <Separator />\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label>Show Animations</Label>\n                    <p className=\"text-sm text-muted-foreground\">Enable interface animations and transitions</p>\n                  </div>\n                  <Switch\n                    checked={settings.appearance.animations}\n                    onCheckedChange={(checked) => updateAppearance(\"animations\", checked)}\n                    data-testid=\"switch-animations\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"integrations\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Cloud className=\"w-5 h-5\" />\n                  Google Drive\n                </CardTitle>\n                <CardDescription>Connect your Google Drive for document syncing</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center\">\n                      <Cloud className=\"w-5 h-5 text-blue-600\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium\">Google Drive</p>\n                      <p className=\"text-sm text-muted-foreground\">Sync documents from your Drive folders</p>\n                    </div>\n                  </div>\n                  <Button variant=\"outline\" data-testid=\"button-connect-drive\">Connect</Button>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Key className=\"w-5 h-5\" />\n                  Configured Services\n                </CardTitle>\n                <CardDescription>Status of integrated services</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-green-50 border border-green-200\">\n                  <div>\n                    <p className=\"font-medium text-green-800\">Daily.co Video</p>\n                    <p className=\"text-sm text-green-600\">Video conferencing is configured</p>\n                  </div>\n                  <Check className=\"w-5 h-5 text-green-600\" />\n                </div>\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-green-50 border border-green-200\">\n                  <div>\n                    <p className=\"font-medium text-green-800\">Google Gemini AI</p>\n                    <p className=\"text-sm text-green-600\">AI features are configured</p>\n                  </div>\n                  <Check className=\"w-5 h-5 text-green-600\" />\n                </div>\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-green-50 border border-green-200\">\n                  <div>\n                    <p className=\"font-medium text-green-800\">PostgreSQL Database</p>\n                    <p className=\"text-sm text-green-600\">Database is connected</p>\n                  </div>\n                  <Check className=\"w-5 h-5 text-green-600\" />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Database className=\"w-5 h-5\" />\n                  Data Management\n                </CardTitle>\n                <CardDescription>Export or manage your data</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium\">Export All Data</p>\n                    <p className=\"text-sm text-muted-foreground\">Download all your cases and documents</p>\n                  </div>\n                  <Button variant=\"outline\" data-testid=\"button-export-all\">Export</Button>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n\n        <div className=\"flex justify-end pt-4\">\n          <Button onClick={handleSave} className=\"gap-2\" data-testid=\"button-save-settings\">\n            {saved ? (\n              <>\n                <Check className=\"w-4 h-4\" />\n                Saved\n              </>\n            ) : (\n              <>\n                <Save className=\"w-4 h-4\" />\n                Save Changes\n              </>\n            )}\n          </Button>\n        </div>\n      </div>\n    </Layout>\n  );\n}\n","path":null,"size_bytes":18631,"size_tokens":null},"client/src/pages/my-cases.tsx":{"content":"import { Layout } from \"@/components/layout\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { getCases, createCase, deleteCase } from \"@/lib/api\";\nimport { Link } from \"wouter\";\nimport { \n  Briefcase, \n  Plus, \n  Search, \n  Filter,\n  Calendar,\n  FileText,\n  Trash2,\n  Loader2,\n  MoreVertical\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useState } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { caseIntakeSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\n\nexport default function MyCases() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [isNewCaseOpen, setIsNewCaseOpen] = useState(false);\n  const [formData, setFormData] = useState({\n    title: \"\",\n    caseNumber: \"\",\n    client: \"\",\n    description: \"\",\n  });\n\n  const { data: cases = [], isLoading } = useQuery({\n    queryKey: [\"cases\"],\n    queryFn: getCases,\n  });\n\n  const createMutation = useMutation({\n    mutationFn: createCase,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"cases\"] });\n      setIsNewCaseOpen(false);\n      setFormData({ title: \"\", caseNumber: \"\", client: \"\", description: \"\" });\n      toast({ title: \"Case created successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Failed to create case\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: deleteCase,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"cases\"] });\n      toast({ title: \"Case deleted successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Failed to delete case\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    try {\n      const validatedData = caseIntakeSchema.parse(formData);\n      createMutation.mutate(validatedData);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        toast({ title: error.errors[0].message, variant: \"destructive\" });\n      }\n    }\n  };\n\n  const filteredCases = cases.filter((c) => {\n    const matchesSearch = \n      c.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      c.caseNumber.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      c.client.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesStatus = statusFilter === \"all\" || c.status === statusFilter;\n    return matchesSearch && matchesStatus;\n  });\n\n  const formatDate = (date: string | Date | null) => {\n    if (!date) return \"\";\n    return new Date(date).toLocaleDateString(\"en-US\", {\n      month: \"short\",\n      day: \"numeric\",\n      year: \"numeric\",\n    });\n  };\n\n  return (\n    <Layout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n          <div>\n            <h1 className=\"text-2xl md:text-3xl font-serif font-bold text-primary\" data-testid=\"text-page-title\">My Cases</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage all your legal cases in one place</p>\n          </div>\n          <Dialog open={isNewCaseOpen} onOpenChange={setIsNewCaseOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"gap-2\" data-testid=\"button-new-case\">\n                <Plus className=\"w-4 h-4\" />\n                New Case\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>Create New Case</DialogTitle>\n                <DialogDescription>\n                  Enter the basic information for your new case. You can add more details later.\n                </DialogDescription>\n              </DialogHeader>\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"title\">Case Title *</Label>\n                  <Input\n                    id=\"title\"\n                    placeholder=\"e.g., Smith v. Jones\"\n                    value={formData.title}\n                    onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                    data-testid=\"input-case-title\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"caseNumber\">Case Number *</Label>\n                  <Input\n                    id=\"caseNumber\"\n                    placeholder=\"e.g., CV-2024-12345\"\n                    value={formData.caseNumber}\n                    onChange={(e) => setFormData({ ...formData, caseNumber: e.target.value })}\n                    data-testid=\"input-case-number\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"client\">Client Name *</Label>\n                  <Input\n                    id=\"client\"\n                    placeholder=\"e.g., John Smith\"\n                    value={formData.client}\n                    onChange={(e) => setFormData({ ...formData, client: e.target.value })}\n                    data-testid=\"input-client\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"description\">Description</Label>\n                  <Textarea\n                    id=\"description\"\n                    placeholder=\"Brief description of the case...\"\n                    value={formData.description}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    data-testid=\"input-description\"\n                  />\n                </div>\n                <DialogFooter>\n                  <Button type=\"button\" variant=\"outline\" onClick={() => setIsNewCaseOpen(false)}>\n                    Cancel\n                  </Button>\n                  <Button type=\"submit\" disabled={createMutation.isPending} data-testid=\"button-create-case\">\n                    {createMutation.isPending ? (\n                      <>\n                        <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                        Creating...\n                      </>\n                    ) : (\n                      \"Create Case\"\n                    )}\n                  </Button>\n                </DialogFooter>\n              </form>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        <div className=\"flex flex-col sm:flex-row gap-4\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search cases by title, number, or client...\"\n              className=\"pl-10\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              data-testid=\"input-search-cases\"\n            />\n          </div>\n          <Select value={statusFilter} onValueChange={setStatusFilter}>\n            <SelectTrigger className=\"w-full sm:w-40\" data-testid=\"select-status-filter\">\n              <Filter className=\"w-4 h-4 mr-2\" />\n              <SelectValue placeholder=\"Filter\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Cases</SelectItem>\n              <SelectItem value=\"active\">Active</SelectItem>\n              <SelectItem value=\"closed\">Closed</SelectItem>\n              <SelectItem value=\"pending\">Pending</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n          </div>\n        ) : filteredCases.length === 0 ? (\n          <Card className=\"border-dashed\">\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <Briefcase className=\"w-12 h-12 text-muted-foreground/50 mb-4\" />\n              <h3 className=\"text-lg font-medium text-muted-foreground mb-2\">\n                {searchQuery || statusFilter !== \"all\" ? \"No cases found\" : \"No cases yet\"}\n              </h3>\n              <p className=\"text-sm text-muted-foreground text-center max-w-md mb-4\">\n                {searchQuery || statusFilter !== \"all\"\n                  ? \"Try adjusting your search or filter criteria\"\n                  : \"Create your first case to start managing your legal matters\"}\n              </p>\n              {!searchQuery && statusFilter === \"all\" && (\n                <Button onClick={() => setIsNewCaseOpen(true)} data-testid=\"button-create-first-case\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Create Your First Case\n                </Button>\n              )}\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid gap-4\">\n            {filteredCases.map((caseItem) => (\n              <Card key={caseItem.id} className=\"hover:shadow-md transition-shadow\" data-testid={`card-case-${caseItem.id}`}>\n                <CardContent className=\"p-4 md:p-6\">\n                  <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        <Badge variant=\"outline\" className=\"font-mono text-xs\">{caseItem.caseNumber}</Badge>\n                        <Badge className={caseItem.status === \"active\" ? \"bg-green-600\" : \"bg-slate-500\"}>\n                          {caseItem.status}\n                        </Badge>\n                      </div>\n                      <Link href={`/case/${caseItem.id}`}>\n                        <h3 className=\"text-lg font-semibold text-primary hover:underline cursor-pointer truncate\" data-testid={`link-case-${caseItem.id}`}>\n                          {caseItem.title}\n                        </h3>\n                      </Link>\n                      <p className=\"text-sm text-muted-foreground mt-1\">Client: {caseItem.client}</p>\n                      {caseItem.description && (\n                        <p className=\"text-sm text-muted-foreground mt-2 line-clamp-2\">{caseItem.description}</p>\n                      )}\n                    </div>\n                    <div className=\"flex items-center gap-6\">\n                      <div className=\"hidden md:flex flex-col items-end text-sm\">\n                        <div className=\"flex items-center gap-2 text-muted-foreground\">\n                          <FileText className=\"w-4 h-4\" />\n                          <span>{caseItem.filesCount || 0} files</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-muted-foreground mt-1\">\n                          <Calendar className=\"w-4 h-4\" />\n                          <span>{formatDate(caseItem.lastActivity)}</span>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Link href={`/case/${caseItem.id}`}>\n                          <Button variant=\"outline\" size=\"sm\" data-testid={`button-open-case-${caseItem.id}`}>\n                            Open Case\n                          </Button>\n                        </Link>\n                        <DropdownMenu>\n                          <DropdownMenuTrigger asChild>\n                            <Button variant=\"ghost\" size=\"icon\" data-testid={`button-case-menu-${caseItem.id}`}>\n                              <MoreVertical className=\"w-4 h-4\" />\n                            </Button>\n                          </DropdownMenuTrigger>\n                          <DropdownMenuContent align=\"end\">\n                            <AlertDialog>\n                              <AlertDialogTrigger asChild>\n                                <DropdownMenuItem \n                                  className=\"text-destructive\"\n                                  onSelect={(e) => e.preventDefault()}\n                                >\n                                  <Trash2 className=\"w-4 h-4 mr-2\" />\n                                  Delete Case\n                                </DropdownMenuItem>\n                              </AlertDialogTrigger>\n                              <AlertDialogContent>\n                                <AlertDialogHeader>\n                                  <AlertDialogTitle>Delete Case</AlertDialogTitle>\n                                  <AlertDialogDescription>\n                                    Are you sure you want to delete \"{caseItem.title}\"? This action cannot be undone.\n                                  </AlertDialogDescription>\n                                </AlertDialogHeader>\n                                <AlertDialogFooter>\n                                  <AlertDialogCancel>Cancel</AlertDialogCancel>\n                                  <AlertDialogAction\n                                    onClick={() => deleteMutation.mutate(caseItem.id.toString())}\n                                    className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                                  >\n                                    Delete\n                                  </AlertDialogAction>\n                                </AlertDialogFooter>\n                              </AlertDialogContent>\n                            </AlertDialog>\n                          </DropdownMenuContent>\n                        </DropdownMenu>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n\n        <div className=\"text-sm text-muted-foreground text-center pt-4\">\n          Showing {filteredCases.length} of {cases.length} cases\n        </div>\n      </div>\n    </Layout>\n  );\n}\n","path":null,"size_bytes":14881,"size_tokens":null},"client/src/components/ai-chat.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { \n  BrainCircuit, \n  Send, \n  Loader2, \n  Plus, \n  Trash2,\n  MessageCircle\n} from \"lucide-react\";\nimport { \n  getConversations, \n  getConversation, \n  createConversation, \n  deleteConversation, \n  sendChatMessage,\n  type Conversation,\n  type Message\n} from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface AIChatProps {\n  caseId: number;\n  caseName: string;\n}\n\nexport function AIChat({ caseId, caseName }: AIChatProps) {\n  const [selectedConversationId, setSelectedConversationId] = useState<number | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [inputValue, setInputValue] = useState(\"\");\n  const [isStreaming, setIsStreaming] = useState(false);\n  const [streamingContent, setStreamingContent] = useState(\"\");\n  const scrollRef = useRef<HTMLDivElement>(null);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: conversations = [], isLoading: loadingConversations } = useQuery({\n    queryKey: [\"conversations\"],\n    queryFn: getConversations,\n  });\n\n  const { data: conversationData, isLoading: loadingMessages } = useQuery({\n    queryKey: [\"conversation\", selectedConversationId],\n    queryFn: () => getConversation(selectedConversationId!),\n    enabled: !!selectedConversationId,\n  });\n\n  useEffect(() => {\n    if (conversationData) {\n      setMessages(conversationData.messages || []);\n    }\n  }, [conversationData]);\n\n  useEffect(() => {\n    if (scrollRef.current) {\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n    }\n  }, [messages, streamingContent]);\n\n  const createMutation = useMutation({\n    mutationFn: () => createConversation(`Chat about ${caseName}`, caseId),\n    onSuccess: (newConversation) => {\n      queryClient.invalidateQueries({ queryKey: [\"conversations\"] });\n      setSelectedConversationId(newConversation.id);\n      setMessages([]);\n    },\n    onError: () => {\n      toast({\n        title: \"Failed to create conversation\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: deleteConversation,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"conversations\"] });\n      if (selectedConversationId) {\n        setSelectedConversationId(null);\n        setMessages([]);\n      }\n    },\n  });\n\n  const handleSend = async () => {\n    if (!inputValue.trim() || isStreaming) return;\n\n    let conversationId = selectedConversationId;\n    \n    if (!conversationId) {\n      const newConv = await createConversation(`Chat about ${caseName}`, caseId);\n      conversationId = newConv.id;\n      setSelectedConversationId(newConv.id);\n      queryClient.invalidateQueries({ queryKey: [\"conversations\"] });\n    }\n\n    const userMessage: Message = {\n      id: Date.now(),\n      conversationId: conversationId,\n      role: \"user\",\n      content: inputValue,\n      createdAt: new Date().toISOString(),\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue(\"\");\n    setIsStreaming(true);\n    setStreamingContent(\"\");\n\n    try {\n      await sendChatMessage(conversationId, userMessage.content, (chunk) => {\n        setStreamingContent(prev => prev + chunk);\n      });\n\n      const assistantMessage: Message = {\n        id: Date.now() + 1,\n        conversationId: conversationId,\n        role: \"assistant\",\n        content: streamingContent,\n        createdAt: new Date().toISOString(),\n      };\n\n      queryClient.invalidateQueries({ queryKey: [\"conversation\", conversationId] });\n    } catch (error) {\n      toast({\n        title: \"Failed to send message\",\n        description: \"Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsStreaming(false);\n      setStreamingContent(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"conversation\", conversationId] });\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  };\n\n  return (\n    <div className=\"h-full flex gap-4\" data-testid=\"ai-chat-container\">\n      <div className=\"w-48 md:w-64 border-r pr-4 flex flex-col\">\n        <Button\n          onClick={() => createMutation.mutate()}\n          disabled={createMutation.isPending}\n          size=\"sm\"\n          className=\"mb-4 gap-2\"\n          data-testid=\"button-new-chat\"\n        >\n          <Plus className=\"w-4 h-4\" />\n          New Chat\n        </Button>\n\n        <ScrollArea className=\"flex-1\">\n          <div className=\"space-y-1\">\n            {loadingConversations && (\n              <div className=\"text-sm text-muted-foreground text-center py-4\">\n                Loading...\n              </div>\n            )}\n            {conversations.map((conv) => (\n              <div\n                key={conv.id}\n                className={`group flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer transition-colors ${\n                  selectedConversationId === conv.id\n                    ? \"bg-accent text-accent-foreground\"\n                    : \"hover:bg-muted\"\n                }`}\n                onClick={() => setSelectedConversationId(conv.id)}\n                data-testid={`conversation-${conv.id}`}\n              >\n                <MessageCircle className=\"w-4 h-4 flex-shrink-0\" />\n                <span className=\"text-sm truncate flex-1\">{conv.title}</span>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-6 w-6 opacity-0 group-hover:opacity-100\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    deleteMutation.mutate(conv.id);\n                  }}\n                  data-testid={`delete-conversation-${conv.id}`}\n                >\n                  <Trash2 className=\"w-3 h-3\" />\n                </Button>\n              </div>\n            ))}\n            {!loadingConversations && conversations.length === 0 && (\n              <div className=\"text-sm text-muted-foreground text-center py-4\">\n                No conversations yet\n              </div>\n            )}\n          </div>\n        </ScrollArea>\n      </div>\n\n      <div className=\"flex-1 flex flex-col\">\n        {!selectedConversationId && messages.length === 0 ? (\n          <div className=\"flex-1 flex flex-col items-center justify-center text-center p-8\">\n            <div className=\"w-16 h-16 rounded-full bg-accent/10 flex items-center justify-center mb-4\">\n              <BrainCircuit className=\"w-8 h-8 text-accent\" />\n            </div>\n            <h3 className=\"text-lg font-semibold mb-2\">AI Legal Assistant</h3>\n            <p className=\"text-sm text-muted-foreground max-w-md mb-6\">\n              Ask questions about your case, get legal insights, research precedents, \n              or get help drafting documents. The AI has context about all files in this case.\n            </p>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2 w-full max-w-lg\">\n              {[\n                \"Summarize the key facts of this case\",\n                \"What are the strongest arguments for the defense?\",\n                \"Find inconsistencies in the witness testimony\",\n                \"Draft a motion to dismiss outline\",\n              ].map((prompt) => (\n                <button\n                  key={prompt}\n                  className=\"text-left text-sm p-3 rounded-lg border bg-muted/30 hover:bg-muted/50 transition-colors\"\n                  onClick={() => {\n                    setInputValue(prompt);\n                  }}\n                  data-testid={`prompt-suggestion-${prompt.slice(0, 20)}`}\n                >\n                  {prompt}\n                </button>\n              ))}\n            </div>\n          </div>\n        ) : (\n          <ScrollArea className=\"flex-1 p-4\" ref={scrollRef}>\n            <div className=\"space-y-4 max-w-3xl mx-auto\">\n              {loadingMessages && (\n                <div className=\"text-center text-muted-foreground py-8\">\n                  <Loader2 className=\"w-6 h-6 animate-spin mx-auto mb-2\" />\n                  Loading messages...\n                </div>\n              )}\n              {messages.map((msg) => (\n                <div\n                  key={msg.id}\n                  className={`flex ${msg.role === \"user\" ? \"justify-end\" : \"justify-start\"}`}\n                  data-testid={`message-${msg.id}`}\n                >\n                  <div\n                    className={`max-w-[80%] rounded-lg px-4 py-3 ${\n                      msg.role === \"user\"\n                        ? \"bg-primary text-primary-foreground\"\n                        : \"bg-muted\"\n                    }`}\n                  >\n                    <p className=\"text-sm whitespace-pre-wrap\">{msg.content}</p>\n                  </div>\n                </div>\n              ))}\n              {isStreaming && streamingContent && (\n                <div className=\"flex justify-start\">\n                  <div className=\"max-w-[80%] rounded-lg px-4 py-3 bg-muted\">\n                    <p className=\"text-sm whitespace-pre-wrap\">{streamingContent}</p>\n                    <span className=\"inline-block w-2 h-4 bg-primary/50 animate-pulse ml-1\" />\n                  </div>\n                </div>\n              )}\n              {isStreaming && !streamingContent && (\n                <div className=\"flex justify-start\">\n                  <div className=\"bg-muted rounded-lg px-4 py-3\">\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  </div>\n                </div>\n              )}\n            </div>\n          </ScrollArea>\n        )}\n\n        <div className=\"border-t p-4\">\n          <div className=\"flex gap-2 max-w-3xl mx-auto\">\n            <Input\n              placeholder=\"Ask about your case...\"\n              value={inputValue}\n              onChange={(e) => setInputValue(e.target.value)}\n              onKeyDown={handleKeyDown}\n              disabled={isStreaming}\n              className=\"flex-1\"\n              data-testid=\"input-chat-message\"\n            />\n            <Button\n              onClick={handleSend}\n              disabled={!inputValue.trim() || isStreaming}\n              data-testid=\"button-send-message\"\n            >\n              {isStreaming ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Send className=\"w-4 h-4\" />\n              )}\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":10743,"size_tokens":null},"client/src/pages/calendar.tsx":{"content":"import { Layout } from \"@/components/layout\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { getCases } from \"@/lib/api\";\nimport { Link } from \"wouter\";\nimport { \n  Calendar as CalendarIcon, \n  Clock, \n  AlertCircle,\n  ChevronLeft,\n  ChevronRight,\n  FileText,\n  Gavel\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useState } from \"react\";\n\nexport default function CalendarPage() {\n  const [currentDate, setCurrentDate] = useState(new Date());\n\n  const { data: cases = [] } = useQuery({\n    queryKey: [\"cases\"],\n    queryFn: getCases,\n  });\n\n  const casesWithDeadlines = cases.filter((c) => c.nextDeadline);\n\n  const getDaysInMonth = (date: Date) => {\n    return new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\n  };\n\n  const getFirstDayOfMonth = (date: Date) => {\n    return new Date(date.getFullYear(), date.getMonth(), 1).getDay();\n  };\n\n  const formatMonthYear = (date: Date) => {\n    return date.toLocaleDateString(\"en-US\", { month: \"long\", year: \"numeric\" });\n  };\n\n  const previousMonth = () => {\n    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1));\n  };\n\n  const nextMonth = () => {\n    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1));\n  };\n\n  const daysInMonth = getDaysInMonth(currentDate);\n  const firstDayOfMonth = getFirstDayOfMonth(currentDate);\n  const today = new Date();\n  const days = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n\n  const upcomingDeadlines = casesWithDeadlines\n    .filter((c) => new Date(c.nextDeadline!) > new Date())\n    .sort((a, b) => new Date(a.nextDeadline!).getTime() - new Date(b.nextDeadline!).getTime())\n    .slice(0, 5);\n\n  const formatDate = (date: string | Date) => {\n    return new Date(date).toLocaleDateString(\"en-US\", {\n      weekday: \"short\",\n      month: \"short\",\n      day: \"numeric\",\n    });\n  };\n\n  const getDaysUntil = (date: string | Date) => {\n    const now = new Date();\n    now.setHours(0, 0, 0, 0);\n    const target = new Date(date);\n    target.setHours(0, 0, 0, 0);\n    const diff = Math.ceil((target.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n    if (diff === 0) return \"Today\";\n    if (diff === 1) return \"Tomorrow\";\n    return `${diff} days`;\n  };\n\n  return (\n    <Layout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-2xl md:text-3xl font-serif font-bold text-primary\" data-testid=\"text-page-title\">Calendar</h1>\n          <p className=\"text-muted-foreground mt-1\">Track deadlines and important dates for your cases</p>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2\">\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\n                <CardTitle className=\"text-lg font-medium\">{formatMonthYear(currentDate)}</CardTitle>\n                <div className=\"flex items-center gap-2\">\n                  <Button variant=\"outline\" size=\"icon\" onClick={previousMonth} data-testid=\"button-prev-month\">\n                    <ChevronLeft className=\"w-4 h-4\" />\n                  </Button>\n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\" \n                    onClick={() => setCurrentDate(new Date())}\n                    data-testid=\"button-today\"\n                  >\n                    Today\n                  </Button>\n                  <Button variant=\"outline\" size=\"icon\" onClick={nextMonth} data-testid=\"button-next-month\">\n                    <ChevronRight className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-7 gap-1\">\n                  {days.map((day) => (\n                    <div key={day} className=\"text-center text-sm font-medium text-muted-foreground py-2\">\n                      {day}\n                    </div>\n                  ))}\n                  {Array.from({ length: firstDayOfMonth }).map((_, i) => (\n                    <div key={`empty-${i}`} className=\"aspect-square\" />\n                  ))}\n                  {Array.from({ length: daysInMonth }).map((_, i) => {\n                    const day = i + 1;\n                    const isToday = \n                      day === today.getDate() && \n                      currentDate.getMonth() === today.getMonth() && \n                      currentDate.getFullYear() === today.getFullYear();\n                    \n                    const dateStr = new Date(currentDate.getFullYear(), currentDate.getMonth(), day).toDateString();\n                    const hasDeadline = casesWithDeadlines.some((c) => \n                      new Date(c.nextDeadline!).toDateString() === dateStr\n                    );\n\n                    return (\n                      <div\n                        key={day}\n                        className={`\n                          aspect-square flex flex-col items-center justify-center rounded-lg text-sm\n                          ${isToday ? \"bg-primary text-primary-foreground font-bold\" : \"hover:bg-muted\"}\n                          ${hasDeadline && !isToday ? \"bg-accent/20\" : \"\"}\n                        `}\n                        data-testid={`calendar-day-${day}`}\n                      >\n                        <span>{day}</span>\n                        {hasDeadline && (\n                          <div className={`w-1.5 h-1.5 rounded-full mt-0.5 ${isToday ? \"bg-primary-foreground\" : \"bg-accent\"}`} />\n                        )}\n                      </div>\n                    );\n                  })}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          <div className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg flex items-center gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-orange-500\" />\n                  Upcoming Deadlines\n                </CardTitle>\n                <CardDescription>Next 5 deadlines across all cases</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                {upcomingDeadlines.length === 0 ? (\n                  <div className=\"text-center py-4 text-muted-foreground\">\n                    <CalendarIcon className=\"w-8 h-8 mx-auto mb-2 opacity-50\" />\n                    <p>No upcoming deadlines</p>\n                  </div>\n                ) : (\n                  upcomingDeadlines.map((caseItem) => (\n                    <Link key={caseItem.id} href={`/case/${caseItem.id}`}>\n                      <div className=\"flex items-start gap-3 p-3 rounded-lg hover:bg-muted transition-colors cursor-pointer\" data-testid={`deadline-case-${caseItem.id}`}>\n                        <div className=\"flex-shrink-0 w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center\">\n                          <Clock className=\"w-5 h-5 text-primary\" />\n                        </div>\n                        <div className=\"flex-1 min-w-0\">\n                          <p className=\"font-medium text-sm truncate\">{caseItem.title}</p>\n                          <p className=\"text-xs text-muted-foreground\">{formatDate(caseItem.nextDeadline!)}</p>\n                        </div>\n                        <Badge variant={getDaysUntil(caseItem.nextDeadline!) === \"Today\" ? \"destructive\" : \"secondary\"} className=\"flex-shrink-0\">\n                          {getDaysUntil(caseItem.nextDeadline!)}\n                        </Badge>\n                      </div>\n                    </Link>\n                  ))\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg flex items-center gap-2\">\n                  <Gavel className=\"w-5 h-5 text-primary\" />\n                  Quick Stats\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Active Cases</span>\n                  <span className=\"font-semibold\">{cases.filter((c) => c.status === \"active\").length}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Cases with Deadlines</span>\n                  <span className=\"font-semibold\">{casesWithDeadlines.length}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-muted-foreground\">Total Documents</span>\n                  <span className=\"font-semibold\">{cases.reduce((sum, c) => sum + (c.filesCount || 0), 0)}</span>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </Layout>\n  );\n}\n","path":null,"size_bytes":9102,"size_tokens":null},"client/src/pages/research.tsx":{"content":"import { Layout } from \"@/components/layout\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { \n  Scale, \n  Search, \n  BookOpen, \n  FileText,\n  ExternalLink,\n  Clock,\n  Newspaper,\n  TrendingUp,\n  Loader2\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useState } from \"react\";\nimport { FeaturedNews } from \"@/components/featured-news\";\n\nasync function fetchLegalNews() {\n  const response = await fetch(\"/api/news/latest\");\n  if (!response.ok) throw new Error(\"Failed to fetch news\");\n  return response.json();\n}\n\nexport default function ResearchPage() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: news = [], isLoading: newsLoading } = useQuery({\n    queryKey: [\"legal-news\"],\n    queryFn: fetchLegalNews,\n  });\n\n  const legalDatabases = [\n    {\n      name: \"Westlaw\",\n      description: \"Comprehensive legal research database\",\n      icon: BookOpen,\n      url: \"https://www.westlaw.com\",\n    },\n    {\n      name: \"LexisNexis\",\n      description: \"Legal, news, and business information\",\n      icon: FileText,\n      url: \"https://www.lexisnexis.com\",\n    },\n    {\n      name: \"Google Scholar\",\n      description: \"Free case law and legal articles\",\n      icon: Search,\n      url: \"https://scholar.google.com\",\n    },\n    {\n      name: \"PACER\",\n      description: \"Federal court records\",\n      icon: Scale,\n      url: \"https://pacer.uscourts.gov\",\n    },\n    {\n      name: \"Cornell LII\",\n      description: \"Free legal information institute\",\n      icon: BookOpen,\n      url: \"https://www.law.cornell.edu\",\n    },\n    {\n      name: \"Justia\",\n      description: \"Free case law and legal information\",\n      icon: FileText,\n      url: \"https://www.justia.com\",\n    },\n  ];\n\n  const recentSearches = [\n    \"Summary judgment standards\",\n    \"Breach of contract elements\",\n    \"Discovery motion practice\",\n    \"Expert witness qualifications\",\n    \"Attorney-client privilege\",\n  ];\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (searchQuery.trim()) {\n      window.open(`https://scholar.google.com/scholar?q=${encodeURIComponent(searchQuery)}`, \"_blank\");\n    }\n  };\n\n  return (\n    <Layout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-2xl md:text-3xl font-serif font-bold text-primary\" data-testid=\"text-page-title\">Legal Research</h1>\n          <p className=\"text-muted-foreground mt-1\">Access legal databases, case law, and stay updated with legal news</p>\n        </div>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <form onSubmit={handleSearch} className=\"flex gap-4\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search case law, statutes, or legal topics...\"\n                  className=\"pl-11 h-12 text-lg\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-legal-search\"\n                />\n              </div>\n              <Button type=\"submit\" size=\"lg\" className=\"px-8\" data-testid=\"button-search\">\n                Search\n              </Button>\n            </form>\n            <div className=\"flex flex-wrap gap-2 mt-4\">\n              <span className=\"text-sm text-muted-foreground\">Recent:</span>\n              {recentSearches.map((term) => (\n                <Badge \n                  key={term} \n                  variant=\"secondary\" \n                  className=\"cursor-pointer hover:bg-secondary/80\"\n                  onClick={() => setSearchQuery(term)}\n                >\n                  {term}\n                </Badge>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Tabs defaultValue=\"databases\" className=\"space-y-4\">\n          <TabsList>\n            <TabsTrigger value=\"databases\" className=\"gap-2\">\n              <BookOpen className=\"w-4 h-4\" />\n              Databases\n            </TabsTrigger>\n            <TabsTrigger value=\"news\" className=\"gap-2\">\n              <Newspaper className=\"w-4 h-4\" />\n              Legal News\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"databases\" className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {legalDatabases.map((db) => (\n                <Card key={db.name} className=\"hover:shadow-md transition-shadow cursor-pointer\" data-testid={`card-database-${db.name.toLowerCase().replace(/\\s/g, \"-\")}`}>\n                  <a href={db.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                    <CardContent className=\"pt-6\">\n                      <div className=\"flex items-start gap-4\">\n                        <div className=\"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0\">\n                          <db.icon className=\"w-6 h-6 text-primary\" />\n                        </div>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-2\">\n                            <h3 className=\"font-semibold\">{db.name}</h3>\n                            <ExternalLink className=\"w-4 h-4 text-muted-foreground\" />\n                          </div>\n                          <p className=\"text-sm text-muted-foreground mt-1\">{db.description}</p>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </a>\n                </Card>\n              ))}\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"news\" className=\"space-y-4\">\n            {newsLoading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n              </div>\n            ) : news.length === 0 ? (\n              <Card className=\"border-dashed\">\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <Newspaper className=\"w-12 h-12 text-muted-foreground/50 mb-4\" />\n                  <p className=\"text-muted-foreground\">No news articles available</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid gap-4\">\n                {news.map((article: any) => (\n                  <Card key={article.id} className=\"hover:shadow-md transition-shadow\" data-testid={`card-news-${article.id}`}>\n                    <a href={article.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                      <CardContent className=\"pt-6\">\n                        <div className=\"flex items-start gap-4\">\n                          <div className=\"flex-1 min-w-0\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <Badge variant=\"outline\">{article.source}</Badge>\n                              {article.featured && <Badge className=\"bg-accent\">Featured</Badge>}\n                            </div>\n                            <h3 className=\"font-semibold hover:text-primary transition-colors\">{article.title}</h3>\n                            {article.summary && (\n                              <p className=\"text-sm text-muted-foreground mt-2 line-clamp-2\">{article.summary}</p>\n                            )}\n                            <div className=\"flex items-center gap-4 mt-3 text-xs text-muted-foreground\">\n                              <div className=\"flex items-center gap-1\">\n                                <Clock className=\"w-3 h-3\" />\n                                {new Date(article.publishedAt).toLocaleDateString()}\n                              </div>\n                              <ExternalLink className=\"w-3 h-3\" />\n                            </div>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </a>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n    </Layout>\n  );\n}\n","path":null,"size_bytes":8427,"size_tokens":null}},"version":2}